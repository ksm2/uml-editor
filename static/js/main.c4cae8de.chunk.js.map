{"version":3,"sources":["utils.ts","constants.ts","model/Anchor.ts","serializer/FileSerializer.ts","renderer/anchors.ts","model/AbstractElement.ts","model/Shape.ts","model/LinePattern.ts","model/Classifier.ts","model/Diagram.ts","model/Tip.ts","model/Relationship.ts","model/Separator.ts","model/Stereotype.ts","model/Text.ts","model/Title.ts","serializer/Serializer.ts","uml/Aggregation.ts","uml/Anchor.ts","uml/Association.ts","uml/Class.ts","uml/Component.ts","uml/Composition.ts","uml/DataType.ts","uml/Dependency.ts","uml/DirectedAssociation.ts","uml/Enumeration.ts","uml/Generalization.ts","uml/Implementation.ts","uml/Interface.ts","uml/Note.ts","uml/Package.ts","uml/Primitive.ts","serializer/index.ts","serializer/UMLSerializer.ts","encoding/base64.ts","encoding/utf8.ts","encoding/index.ts","hooks/useDocumentTitle.ts","hooks/useId.ts","hooks/useShortcut.ts","css/Color.ts","css/CSSToken.ts","parsing/Parser.ts","parsing/Tokenizer.ts","css/CSSTokenizer.ts","css/Property.ts","css/PropertyMap.ts","css/Style.ts","css/Rule.ts","css/Selector.ts","css/index.ts","css/CSSParser.ts","modules/locale.ts","modules/view.ts","modules/index.ts","modules/file.ts","components/blocks/ContainerFluid.tsx","components/blocks/DropdownDivider.tsx","components/blocks/Shortcut.tsx","components/blocks/DropdownItem.tsx","components/blocks/DropdownMenu.tsx","components/blocks/DropdownToggle.tsx","components/blocks/Editor.tsx","components/blocks/ExternalLink.tsx","components/blocks/Flag.tsx","components/blocks/Icon.tsx","components/blocks/logo.png","components/blocks/MenuBar.tsx","components/blocks/NavItem.tsx","components/blocks/Menu.tsx","components/widgets/DeleteElement.tsx","components/widgets/DuplicateElement.tsx","components/widgets/FileNew.tsx","components/widgets/FileOpen.tsx","components/widgets/FileRename.tsx","components/widgets/FileSave.tsx","components/widgets/LocaleItem.tsx","components/widgets/MoveDown.tsx","components/widgets/MoveLeft.tsx","components/widgets/MoveRight.tsx","components/widgets/MoveUp.tsx","renderer/ShapeRenderer.ts","renderer/CanvasClassifierRenderer.ts","renderer/bresenhamAlgorithm.ts","renderer/CanvasRelationshipRenderer.ts","renderer/Handle.ts","renderer/HTML5Canvas.ts","renderer/RenderContext.ts","renderer/CanvasRenderer.ts","renderer/SVGCanvas.ts","renderer/SVGRenderer.ts","components/widgets/PNGExport.tsx","components/widgets/SVGExport.tsx","components/widgets/ToggleGrid.tsx","components/widgets/ZoomIn.tsx","components/widgets/ZoomOut.tsx","components/widgets/ZoomReset.tsx","components/widgets/AppMenu.tsx","components/widgets/Canvas.tsx","components/widgets/CSSEditor.tsx","components/widgets/LocaleSwitch.tsx","components/schemas/xmlSchema.ts","components/widgets/XMLEditor.tsx","components/App.tsx","reportWebVitals.ts","index.tsx"],"names":["Locale","getMouseCoordinates","renderer","event","clientX","clientY","boundingClientRect","currentTarget","getBoundingClientRect","x","y","transformPoint","sanitizeFilename","element","replace","downloadFile","filename","dataURL","downloadLink","document","createElement","download","href","click","storageAvailable","storage","window","localStorage","setItem","removeItem","e","DOMException","code","name","length","Anchor","PADDING","MARGIN","HANDLE_RADIUS","INITIAL_XML","INITIAL_CSS","LOCALES","GERMAN","ENGLISH","FileSerializer","file","header","title","model","xml","style","css","this","joinSections","content","splitSections","headerString","parseHeader","sections","map","str","trim","join","expectedNumber","split","Error","result","key","value","isSide","side","anchor","qsin","CENTER","NNW","SSW","N","S","NNE","SSE","qcos","ENE","WNW","E","W","ESE","WSW","Symbol","iterator","Shape","AbstractElement","children","Set","hovered","selected","child","add","delete","reverse","LinePattern","Classifier","width","height","shape","RECTANGLE","getLeft","getTop","left","top","renderClassifier","constructor","Object","getPrototypeOf","Diagram","renderDiagram","predicate","findElement","getChildren","undefined","getRight","getBottom","reduceClassifiers","acc","classifier","Infinity","bottom","right","reducer","seed","Tip","Relationship","from","fromAnchor","to","toAnchor","fromTip","NONE","toTip","linePattern","SOLID","renderRelationship","Separator","renderSeparator","Stereotype","renderStereotype","Text","text","renderText","Title","renderTitle","Serializer","parser","serializer","elementMap","Map","DOMParser","XMLSerializer","clear","parseFromString","diagram","parseElement","documentElement","Model","hasElement","root","getElement","serializeToString","xmlElement","setElement","has","get","parsed","parseElementSwitch","set","setDiagram","setClassifier","setText","tagName","parseDiagram","parseClassifier","parseRelationship","parseTitle","parseText","parseChildren","updateChildren","parseAnchorAttribute","parseIntAttribute","parseEnumAttribute","setAnchorAttribute","setIntAttribute","getX","getY","getWidth","getHeight","relationship","parseClassifierAttribute","parseTipAttribute","parseLinePatternAttribute","textContent","target","addChild","err","console","error","visitedChildren","childElement","getOrCreateElement","remove","cleanupWhiteSpace","attribute","hasAttribute","id","getAttribute","elementById","ownerDocument","getElementById","setEnumAttribute","fallback","enumClass","item","Reflect","toUpperCase","enumValue","removeAttribute","toLowerCase","setAttribute","parseInt","Number","isNaN","String","values","parent","newElement","getTagName","generateId","appendChild","prefix","i","level","getLevel","originalChildren","childNodes","removeChild","first","originalChild","extraNewLine","addText","getIndent","repeat","offset","parentElement","data","createTextNode","Aggregation","DIAMOND","DOTS","Association","Class","Component","COMPONENT","Composition","FILLED_DIAMOND","DataType","Dependency","ARROW","TIGHT_DASHES","DirectedAssociation","Enumeration","Generalization","TRIANGLE","Implementation","Interface","Note","NOTE","Package","FOLDER","Primitive","UML","fileSerializer","byteToASCII","byte","asciiToByte","ascii","threeToFourBytes","input1","input2","input3","encodeString","output","fromCharCode","enc","TextEncoder","dec","TextDecoder","encode","string","saveToString","utf8","input","push","slice","Base64","Pako","decode","hash","deflated","encoded","input4","endsWith2Eq","endsWith1Eq","Array","fill","_","charCodeAt","Uint8Array","UTF8","loadFromString","useDocumentTitle","useEffect","useId","useRef","Math","random","toString","substring","current","useShortcut","shortcut","handler","ref","keypressHandler","elements","ctrlKey","shiftKey","altKey","matchesShortcut","preventDefault","addEventListener","removeEventListener","Color","red","green","blue","sanitizeComponent","intToHex","other","percentage","otherFactor","clamp","thisFactor","hexString","min","max","clamped","round","padStart","BLUE","fromHexString","INDIGO","PURPLE","PINK","RED","ORANGE","YELLOW","GREEN","TEAL","CYAN","WHITE","GRAY","GRAY_DARK","PRIMARY","SECONDARY","SUCCESS","INFO","WARNING","DANGER","LIGHT","DARK","CSSToken","Parser","tokenizer","tokens","index","tokenize","parse","kind","token","parsers","parseOptional","oldIndex","call","Tokenizer","subject","next","newIndex","search","match","startsWith","CSSTokenizer","matches","COLOR","NUMBER","LBRACE","RBRACE","COLON","SEMI","DOT","HASH","IDENTIFIER","ERROR","Property","PropertyMap","properties","property","entries","Style","rules","context","head","tail","hasTail","rule","selector","tag","addAll","getProperties","Rule","Selector","classes","parseRuleSet","parseSet","parseRule","parseSelector","consume","parsePropertySet","parseClassSet","parseOptionalId","parseProperty","parseIdentifier","parseOneOf","parseColor","parseNumber","parseIdentifierValue","parseClass","parseId","color","number","parseFloat","identifier","normalizeLocale","locale","includes","loadLocale","storedLocale","getItem","navigator","language","storeView","state","JSON","stringify","grid","positionX","positionY","zoom","useStore","useStoreon","store","createStoreon","on","dispatch","deleteChild","deserialize","updateElement","serialize","storeLocale","ZOOM_LEVELS","loadView","prevState","indexOf","Store","React","StoreContext","Provider","ContainerFluid","className","DropdownDivider","Shortcut","intl","useIntl","parts","formatMessage","defaultMessage","part","DropdownItem","onClick","active","classNames","DropdownMenu","placement","labelledBy","aria-labelledby","DropdownToggle","dropdown","dispose","Dropdown","aria-expanded","data-bs-toggle","completeAfter","cm","pred","setTimeout","completionActive","showHint","completeSingle","CodeMirror","Pass","completeIfAfterLt","cur","getCursor","getRange","Pos","line","ch","completeIfInTag","tok","getTokenAt","type","test","charAt","innerMode","getMode","Editor","schema","onChange","onChangeRef","editor","mode","hintOptions","schemaInfo","codeMirror","fromTextArea","lineNumbers","theme","matchTags","autocorrect","tabSize","extraKeys","toTextArea","handleKeyDown","stopPropagation","handleChange","newValue","getValue","setValue","getWrapperElement","off","defaultValue","ExternalLink","rel","Flag","country","Icon","size","toHexString","xlinkHref","iconUrl","MenuBar","gridArea","alt","src","logo","NavItem","Menu","DeleteElement","onDeleteElement","isSelected","DuplicateElement","onAddElement","elementsToDuplicate","setSelected","clone","childClone","FileNew","onFileChange","untitled","message","prompt","FileOpen","pattern","Promise","resolve","uploadInput","files","once","accept","multiple","then","FileRename","onTitleChange","newTitle","FileSave","btoa","url","URL","LocaleItem","MoveDown","onMove","MoveLeft","MoveRight","MoveUp","ShapeRenderer","canvas","rectangle","drawRectangleShape","ELLIPSE","drawEllipseShape","drawFolderShape","drawNoteShape","BOX","drawBoxShape","FILE","drawFileShape","drawComponentShape","rect","ellipse","NOTE_SIZE","moveTo","lineTo","closePath","BOX_DEPTH","FILE_SIZE","COMPONENT_WIDTH","COMPONENT_HEIGHT","COMPONENT_Y","CanvasClassifierRenderer","shapeRenderer","save","applyStyle","drawShape","stroke","clip","translate","render","restore","pop","domPoint","getTransform","isPointInPath","getStyleProperties","lineWidth","getFloat","strokeColor","getColor","isHovered","mix","fillColor","beginPath","renderShape","getRectangle","bresenhamAlgorithm","lx1","lx2","ly1","ly2","ox","oy","cl1","cl2","x1","getAnchorX","y1","getAnchorY","x2","y2","dx","abs","dy","sx","sy","p1Hit","p2Hit","isPointInClassifier","e2","CanvasRelationshipRenderer","angle","atan2","applyRelationshipStyle","drawFromTip","drawToTip","setLineDash","SMALL_DASHES","LARGE_DASHES","drawTip","PI","tip","rotate","drawTipPath","drawArrow","drawTriangle","FILLED_TRIANGLE","drawDiamond","CIRCLE","drawCircle","FILLED_CIRCLE","Handle","HTML5Canvas","ctx","dash","radiusX","radiusY","metrics","measureText","anchorY","fontBoundingBoxAscent","anchorX","fillText","font","attrs","fillStyle","strokeStyle","getFontAttribute","fontStyle","updateFontAttribute","fontWeight","fontSize","fontFamily","RenderContext","canvasWidth","canvasHeight","unshift","shift","CanvasRenderer","options","classifierRenderer","relationshipRenderer","translateX","translateY","getContext","html5Canvas","clearRect","renderGrid","zoomedGrid","minX","floorBy","maxX","ceilBy","minY","maxY","by","floor","ceil","scale","renderHandles","drawText","separator","stereotype","contextName","getName","align","weight","getString","family","getHandles","renderHandleAtPoint","getClassifierHandles","handle","isPointInHandle","NW","getCenterX","NE","getCenterY","SW","SE","SVGCanvas","container","stack","paths","saved","matrix","DOMMatrix","path","getContainer","currentMatrix","splice","svg","createSVG","append","radiansToDegrees","appendPaths","textEl","encodeUTF8","createElementNS","SVGRenderer","baseVal","PNGExport","toDataURL","SVGExport","viewBox","ToggleGrid","icon","ZoomIn","onZoom","ZoomOut","ZoomReset","AppMenu","handleFileChange","handleLocaleChange","createRenderer","view","Canvas","div","mouseDownCoords","mouseDownRectangle","mouseDownObject","setCursor","cursor","handleLeftMouseButtonMove","coord","vec1","vec2","find","el","deltaX","deltaY","setLeft","setTop","setWidth","setHeight","handleHandleUpdate","onResize","trunc","backgroundColor","onMouseMove","buttons","setHovered","findHandleForPoint","onMouseDown","selectedElement","renderMouseDown","onMouseUp","CSSEditor","position","messagesForLocale","DE_MESSAGES","EN_MESSAGES","LocaleSwitch","messages","defaultLocale","anchorSchema","keys","filter","it","shapeSchema","tipSchema","classifierSchema","relationshipSchema","classifiers","relationships","class","XMLEditor","xmlSchema","App","untitledMsg","titleMsg","location","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"6wHAyBYA,E,wDAKL,SAASC,EACdC,EACAC,GACc,IACNC,EAAqBD,EAArBC,QAASC,EAAYF,EAAZE,QACXC,EAAqBH,EAAMI,cAAcC,wBAEzCC,EAAIL,EAAUE,EAAmBG,EACjCC,EAAIL,EAAUC,EAAmBI,EAEvC,OAAOR,EAASS,eAAeF,EAAGC,GAgB7B,SAASE,EAAiBC,GAC/B,OAAOA,EAAQC,QAAQ,gBAAiB,KAGnC,SAASC,EAAaC,EAAkBC,GAC7C,IAAMC,EAAeC,SAASC,cAAc,KAC5CF,EAAaG,SAAWL,EACxBE,EAAaI,KAAOL,EACpBC,EAAaK,QAwBR,SAASC,IACd,IAAMC,EAAUC,OAAOC,aACvB,IACE,IAAMlB,EAAI,mBAGV,OAFAgB,EAAQG,QAAQnB,EAAGA,GACnBgB,EAAQI,WAAWpB,IACZ,EACP,MAAOqB,GACP,OACEA,aAAaC,eAED,KAAXD,EAAEE,MAEU,OAAXF,EAAEE,MAGS,uBAAXF,EAAEG,MAES,+BAAXH,EAAEG,OAEgB,KAAb,OAAPR,QAAO,IAAPA,OAAA,EAAAA,EAASS,U,SAnFHlC,K,YAAAA,E,cAAAA,M,KCvBL,ICFFmC,IDGQC,EAAU,GACVC,EAAS,GACTC,EAAgB,IAChBC,EAAW,4WAiBXC,EAAW,kHAaXC,EAAU,CAACzC,EAAO0C,OAAQ1C,EAAO2C,S,6BEQ/BC,E,qGAzCAC,GACX,IAAMC,EAAM,iBAAaD,EAAKE,OACxBC,EAAQH,EAAKI,IACbC,EAAQL,EAAKM,IACnB,OAAOC,KAAKC,aAAaP,EAAQE,EAAOE,K,qCAG3BI,GAAoC,IAAD,IACXF,KAAKG,cAAcD,EAAS,GADjB,mBACzCE,EADyC,KAC3BR,EAD2B,KACpBE,EADoB,KAGhD,MAAO,CACLH,MAAK,UAFQK,KAAKK,YAAYD,GAEhBT,aAAT,QAAkB,WACvBE,IAAKD,EACLG,IAAKD,K,qCAI4C,IAAD,uBAA5BQ,EAA4B,yBAA5BA,EAA4B,gBAClD,OAAOA,EAASC,KAAI,SAACC,GAAD,OAASA,EAAIC,UAAQC,KAAK,WAAa,O,oCAGvCR,EAAiBS,GACrC,IAAML,EAAWJ,EAAQU,MAAM,WAC/B,GAAIN,EAASxB,SAAW6B,EACtB,MAAM,IAAIE,MAAJ,mBAAsBF,EAAtB,cAGR,OAAOL,I,kCAGWF,GAClB,IADgE,EAC1DU,EAAiC,GADyB,cAE7CV,EAAaQ,MAAM,gBAF0B,IAEhE,2BAAsD,CAAC,IAAD,UAC1BA,MAAM,OAAQ,GADY,mBAC7CG,EAD6C,KACxCC,EADwC,KAEpDF,EAAOC,GAAOC,GAJgD,8BAOhE,OAAOF,M,4CDxCN/B,Q,KAAAA,E,SAAAA,I,aAAAA,I,WAAAA,I,aAAAA,I,SAAAA,I,aAAAA,I,WAAAA,I,aAAAA,I,SAAAA,I,aAAAA,I,YAAAA,I,cAAAA,I,UAAAA,I,cAAAA,I,YAAAA,I,cAAAA,I,oBAoBUA,QEVf,SAASkC,EAAOC,EAAcC,GAC5B,OAAQA,EAASD,GAHD,GADD,EAOV,SAASE,EAAKD,GACnB,GAAIA,IAAWpC,EAAOsC,OACpB,MAAO,GAGT,GAAIJ,EAhBQ,EAgBME,GAChB,OAAO,EAGT,GAAIF,EAlBQ,GAkBME,GAChB,OAAO,EAGT,OAAQA,GACN,KAAKpC,EAAOuC,IACZ,KAAKvC,EAAOwC,IACV,OAAO,EAAI,EACb,KAAKxC,EAAOyC,EACZ,KAAKzC,EAAO0C,EACV,MAAO,GACT,KAAK1C,EAAO2C,IACZ,KAAK3C,EAAO4C,IACV,OAAO,EAAI,EAGf,MAAM,IAAId,MAGL,SAASe,EAAKT,GACnB,GAAIA,IAAWpC,EAAOsC,OACpB,MAAO,GAGT,GAAIJ,EA7CO,EA6CME,GACf,OAAO,EAGT,GAAIF,EA/CO,GA+CME,GACf,OAAO,EAGT,OAAQA,GACN,KAAKpC,EAAO8C,IACZ,KAAK9C,EAAO+C,IACV,OAAO,EAAI,EACb,KAAK/C,EAAOgD,EACZ,KAAKhD,EAAOiD,EACV,MAAO,GACT,KAAKjD,EAAOkD,IACZ,KAAKlD,EAAOmD,IACV,OAAO,EAAI,EAGf,MAAM,IAAIrB,M,yBCxCRsB,OAAOC,S,IC3BNC,EDmDUC,E,iDA/CIC,SAAW,IAAIC,I,KACxBC,SAAU,E,KACVC,UAAW,E,0DASjB,OAAO,YAAI1C,KAAKuC,Y,+BAGTI,GAEP,OADA3C,KAAKuC,SAASK,IAAID,GACX3C,O,kCAGG2C,GACV,OAAO3C,KAAKuC,SAASM,OAAOF,K,6HAIR,YAAI3C,KAAKuC,UAAUO,W,wDACrC,OADSH,E,QACT,gBAAOA,EAAP,Q,6IAEF,O,UAAM3C,K,kGAIN,OAAOA,KAAKyC,U,iCAGHA,GACTzC,KAAKyC,QAAUA,I,mCAIf,OAAOzC,KAAK0C,W,kCAGFA,GACV1C,KAAK0C,SAAWA,M,eC/CfL,O,yBAAAA,I,qBAAAA,I,eAAAA,I,mBAAAA,I,aAAAA,I,eAAAA,I,0BAAAA,M,KAUUA,ICVVU,EDUUV,IEqGAW,E,kDAhGb,WAAY7B,EAAgB9D,EAAWC,EAAW2F,EAAeC,GAAiB,IAAD,8BAC/E,gBARO/B,YAOwE,IANjF9D,OAMiF,IALjFC,OAKiF,IAJzE2F,WAIyE,IAHzEC,YAGyE,IAFjFC,MAAed,EAAMe,UAInB,EAAKjC,OAASA,EACd,EAAK9D,EAAIA,EACT,EAAKC,EAAIA,EACT,EAAK2F,MAAQA,EACb,EAAKC,OAASA,EANiE,E,yDAU/E,MAAO,e,qCAIP,MAAO,CACL7F,EAAG2C,KAAKqD,UACR/F,EAAG0C,KAAKsD,SACRL,MAAOjD,KAAKiD,MACZC,OAAQlD,KAAKkD,U,iCAKf,OAAOlD,KAAKiD,Q,+BAGLA,GACPjD,KAAKiD,MAAQA,I,6BAIb,OAAOjD,KAAK3C,I,6BAIZ,OAAO2C,KAAK1C,I,iCAGH6D,GACT,OAAOnB,KAAKqD,UAAYjC,EAAKD,GAAUnB,KAAKiD,Q,iCAGnC9B,GACT,OAAOnB,KAAKsD,SAAW1B,EAAKT,GAAUnB,KAAKkD,S,kCAI3C,OAAOlD,KAAKkD,S,gCAGJA,GACRlD,KAAKkD,OAASA,I,gCAId,OAAOlD,KAAK3C,EAAI2C,KAAKiD,MAAQ7B,EAAKpB,KAAKmB,U,8BAGjCoC,GACNvD,KAAK3C,EAAIkG,EAAOvD,KAAKiD,MAAQ7B,EAAKpB,KAAKmB,U,mCAIvC,OAAOnB,KAAKqD,UAAYrD,KAAKiD,MAAQ,I,iCAIrC,OAAOjD,KAAKqD,UAAYrD,KAAKiD,Q,+BAI7B,OAAOjD,KAAK1C,EAAI0C,KAAKkD,OAAStB,EAAK5B,KAAKmB,U,6BAGnCqC,GACLxD,KAAK1C,EAAIkG,EAAMxD,KAAKkD,OAAStB,EAAK5B,KAAKmB,U,mCAIvC,OAAOnB,KAAKsD,SAAWtD,KAAKkD,OAAS,I,kCAIrC,OAAOlD,KAAKsD,SAAWtD,KAAKkD,S,6BAGvBpG,GACLA,EAAS2G,iBAAiBzD,Q,8BAK1B,OAAO,IAAI0D,EADaC,OAAOC,eAAe5D,MAAtC0D,aACe1D,KAAKmB,OAAQnB,KAAK3C,EAAI,GAAI2C,KAAK1C,EAAI,GAAI0C,KAAKiD,MAAOjD,KAAKkD,Y,GApG1DZ,GCuFVuB,E,qKAvFN/G,GACLA,EAASgH,cAAc9D,Q,mCAIvB,MAAO,Y,8BAIP,OAAO,IAAI6D,I,2BAGRE,GACH,OAAO/D,KAAKgE,YAAYhE,KAAM+D,K,kCAGZtG,EAAkBsG,GAEpC,GADeA,EAAUtG,GAEvB,OAAOA,EAH+E,oBAMpEA,EAAQwG,eAN4D,IAMxF,2BAA2C,CAAC,IAAjCtB,EAAgC,QACnC7B,EAASd,KAAKgE,YAAYrB,EAAOoB,GACvC,QAAeG,IAAXpD,EACF,OAAOA,GAT6E,iC,iCAiBxF,OAAOd,KAAKmE,WAAanE,KAAKqD,Y,kCAI9B,OAAOrD,KAAKoE,YAAcpE,KAAKsD,W,+BAI/B,OAAOtD,KAAKqE,mBAAkB,SAACC,EAAKC,GAClC,IAAMf,EAAMe,EAAWjB,SACvB,OAAOgB,EAAMd,EAAMA,EAAMc,IACxBE,O,kCAIH,OAAOxE,KAAKqE,mBAAkB,SAACC,EAAKC,GAClC,IAAME,EAASF,EAAWH,YAC1B,OAAOE,EAAMG,EAASA,EAASH,KAC7BE,O,gCAIJ,OAAOxE,KAAKqE,mBAAkB,SAACC,EAAKC,GAClC,IAAMhB,EAAOgB,EAAWlB,UACxB,OAAOiB,EAAMf,EAAOA,EAAOe,IAC1BE,O,iCAIH,OAAOxE,KAAKqE,mBAAkB,SAACC,EAAKC,GAClC,IAAMG,EAAQH,EAAWJ,WACzB,OAAOG,EAAMI,EAAQA,EAAQJ,KAC3BE,O,wCAIJG,EACAC,GAEA,IADQ,EACJN,EAAMM,EADF,cAEiB5E,KAAKiE,eAFtB,IAER,2BAA6C,CAAC,IAAnCM,EAAkC,QACvCA,aAAsBvB,IACxBsB,EAAMK,EAAQL,EAAKC,KAJf,8BAQR,OAAID,IAAQM,EACH,EAGFN,M,GApFWhC,I,SFNjBS,O,iBAAAA,I,eAAAA,I,+BAAAA,I,+BAAAA,I,gCAAAA,M,KAQUA,IGRV8B,EHQU9B,K,SGRV8B,O,eAAAA,I,iBAAAA,I,uBAAAA,I,qCAAAA,I,qBAAAA,I,mCAAAA,I,mBAAAA,I,kCAAAA,M,KAWUA,QC2BAC,E,kDAtBb,WAAYC,EAAkBC,EAAoBC,EAAgBC,GAAmB,IAAD,8BAClF,gBATFH,UAQoF,IAPpFC,gBAOoF,IANpFG,QAAeN,EAAIO,KAMiE,EALpFH,QAKoF,IAJpFC,cAIoF,IAHpFG,MAAaR,EAAIO,KAGmE,EAFpFE,YAA2BvC,EAAYwC,MAIrC,EAAKR,KAAOA,EACZ,EAAKC,WAAaA,EAClB,EAAKC,GAAKA,EACV,EAAKC,SAAWA,EALkE,E,mDAQ7EpI,GACLA,EAAS0I,mBAAmBxF,Q,mCAI5B,MAAO,iB,8BAKP,OAAO,IAAI0D,EADaC,OAAOC,eAAe5D,MAAtC0D,aACe1D,KAAK+E,KAAM/E,KAAKgF,WAAYhF,KAAKiF,GAAIjF,KAAKkF,c,GA3B1C5C,GCUZmD,E,qKAbN3I,GACLA,EAAS4I,gBAAgB1F,Q,mCAIzB,MAAO,c,8BAIP,OAAO,IAAIyF,M,GAVSnD,GCcTqD,E,qKAbN7I,GACLA,EAAS8I,iBAAiB5F,Q,mCAI1B,MAAO,e,8BAIP,OAAO,IAAI2F,M,GAVUrD,GCsBVuD,E,kDAnBb,WAAYC,GAAe,IAAD,8BACxB,gBAHOA,UAEiB,EAExB,EAAKA,KAAOA,EAFY,E,mDAKnBhJ,GACLA,EAASiJ,WAAW/F,Q,mCAIpB,MAAO,S,8BAKP,OAAO,IAAI0D,EADaC,OAAOC,eAAe5D,MAAtC0D,aACe1D,KAAK8F,U,GAlBbxD,GCUJ0D,E,qKATNlJ,GACLA,EAASmJ,YAAYjG,Q,mCAIrB,MAAO,Y,GANS6F,GCwWLK,E,WAhWb,aAAe,yBAJEC,YAIH,OAHGC,gBAGH,OAFGC,WAAa,IAAIC,IAGhCtG,KAAKmG,OAAS,IAAII,UAClBvG,KAAKoG,WAAa,IAAII,c,wDAGZ3G,GACVG,KAAKqG,WAAWI,QAChB,IAAM1I,EAAWiC,KAAKmG,OAAOO,gBAAgB7G,EAAK,YAC5C8G,EAAU3G,KAAK4G,aAAa7I,EAAS8I,iBAC3C,OAAMF,aAAmBG,EAIlBH,EAHE,IAAIG,I,gCAMLH,GACR,GAAI3G,KAAK+G,WAAWJ,GAAU,CAC5B,IAAMK,EAAOhH,KAAKiH,WAAWN,GAC7B,OAAO3G,KAAKoG,WAAWc,kBAAkBF,GAG3C,MAAO,K,oCAGKvJ,GACZ,GAAIuC,KAAK+G,WAAWtJ,GAAU,CAC5B,IAAM0J,EAAanH,KAAKiH,WAAWxJ,GACnCuC,KAAKoH,WAAWD,EAAY1J,M,mCAIXA,GACnB,GAAIuC,KAAKqG,WAAWgB,IAAI5J,GACtB,OAAOuC,KAAKqG,WAAWiB,IAAI7J,GAG7B,IAAM8J,EAASvH,KAAKwH,mBAAmB/J,GAEvC,OADAuC,KAAKqG,WAAWoB,IAAIhK,EAAS8J,GACtBA,I,iCAGUJ,EAAqB1J,GAClCA,aAAmBqJ,EACrB9G,KAAK0H,WAAWP,EAAY1J,GACnBA,aAAmBqJ,EAC5B9G,KAAK2H,cAAcR,EAAY1J,GACtBA,aAAmBqJ,GAC5B9G,KAAK4H,QAAQT,EAAY1J,K,yCAIAA,GAC3B,OAAQA,EAAQoK,SACd,IAAK,UACH,OAAO7H,KAAK8H,aAAarK,GAC3B,IAAK,aACH,OAAOuC,KAAK+H,gBAAgBjB,EAAkBrJ,GAChD,IAAK,eACH,OAAOuC,KAAKgI,kBAAkBlB,EAAoBrJ,GACpD,IAAK,QACH,OAAOuC,KAAKiI,WAAWxK,GACzB,IAAK,OACH,OAAOuC,KAAKkI,UAAUzK,GACxB,IAAK,YACH,OAAO,IAAIqJ,EACb,IAAK,aACH,OAAO,IAAIA,EAGf,MAAM,IAAIjG,MAAJ,uBAA0BpD,EAAQoK,Y,mCAGrBpK,GACnB,IAAMkJ,EAAU,IAAIG,EAEpB,OADA9G,KAAKmI,cAAc1K,EAASkJ,GACrBA,I,iCAGUlJ,EAAkBkJ,GACnC3G,KAAKoI,eAAe3K,EAASkJ,K,sCAI7BjD,EACAjG,GAEA,IAKM8G,EAAa,IAAIb,EALR1D,KAAKqI,qBAAqB5K,EAAS,UACxCuC,KAAKsI,kBAAkB7K,EAAS,IAAK,GACrCuC,KAAKsI,kBAAkB7K,EAAS,IAAK,GACjCuC,KAAKsI,kBAAkB7K,EAAS,QAAS,KACxCuC,KAAKsI,kBAAkB7K,EAAS,SAAU,MAIzD,OAFA8G,EAAWpB,MAAQnD,KAAKuI,mBAAmBzB,EAAarJ,EAAS,QAAS8G,EAAWpB,OACrFnD,KAAKmI,cAAc1K,EAAS8G,GACrBA,I,oCAGe9G,EAAkB8G,GACxCvE,KAAKwI,mBAAmB/K,EAAS,SAAU8G,EAAWpD,QACtDnB,KAAKyI,gBAAgBhL,EAAS,IAAK,EAAG8G,EAAWmE,QACjD1I,KAAKyI,gBAAgBhL,EAAS,IAAK,EAAG8G,EAAWoE,QACjD3I,KAAKyI,gBAAgBhL,EAAS,QAAS,IAAK8G,EAAWqE,YACvD5I,KAAKyI,gBAAgBhL,EAAS,SAAU,IAAK8G,EAAWsE,aACxD7I,KAAKoI,eAAe3K,EAAS8G,K,wCAI7Bb,EACAjG,GAEA,IAIMqL,EAAe,IAAIpF,EAJZ1D,KAAK+I,yBAAyBtL,EAAS,QACjCuC,KAAKqI,qBAAqB5K,EAAS,cAC3CuC,KAAK+I,yBAAyBtL,EAAS,MACjCuC,KAAKqI,qBAAqB5K,EAAS,aASpD,OAPAqL,EAAa3D,QAAUnF,KAAKgJ,kBAAkBvL,EAAS,UAAWqL,EAAa3D,SAC/E2D,EAAazD,MAAQrF,KAAKgJ,kBAAkBvL,EAAS,QAASqL,EAAazD,OAC3EyD,EAAaxD,YAActF,KAAKiJ,0BAC9BxL,EACA,cACAqL,EAAaxD,aAERwD,I,iCAGUrL,GAAgC,IAAD,EAC1CqI,EAAI,UAAGrI,EAAQyL,mBAAX,QAA0B,GACpC,OAAO,IAAIpC,EAAYhB,K,gCAGPrI,GAA+B,IAAD,EACxCqI,EAAI,UAAGrI,EAAQyL,mBAAX,QAA0B,GACpC,OAAO,IAAIpC,EAAWhB,K,8BAGRrI,EAAkBqI,GAChCrI,EAAQyL,YAAcpD,EAAKA,O,oCAGPrI,EAAkB0L,GAAwB,IAAD,gBACzC1L,EAAQ8E,UADiC,IAC7D,2BAAsC,CAAC,IAA5BI,EAA2B,QACpC,IACEwG,EAAOC,SAASpJ,KAAK4G,aAAajE,IAClC,MAAO0G,GACPC,QAAQC,MAAMF,KAL2C,iC,qCAUxC5L,EAAkB0L,GACvC,IAD8D,EACxDK,EAAkB,IAAIhH,IADkC,cAE1C2G,EAAOlF,eAFmC,IAE9D,2BAA0C,CAAC,IAAhCtB,EAA+B,QAClC8G,EAAezJ,KAAK0J,mBAAmBjM,EAASkF,GACtD3C,KAAKoH,WAAWqC,EAAc9G,GAC9B6G,EAAgB5G,IAAI6G,IALwC,kDAQ1ChM,EAAQ8E,UARkC,IAQ9D,2BAAsC,CAAC,IAA5BI,EAA2B,QAC/B6G,EAAgBnC,IAAI1E,KACvBA,EAAMgH,SACN3J,KAAKqG,WAAWxD,OAAOF,KAXmC,8BAe9D3C,KAAK4J,kBAAkBnM,K,yCAGEA,EAAkBkF,GAC3C,OAAI3C,KAAK+G,WAAWpE,GACX3C,KAAKiH,WAAWtE,GAEhB3C,KAAKhC,cAAcP,EAASkF,K,+CAINlF,EAAkBoM,GACjD,GAAIpM,EAAQqM,aAAaD,GAAY,CACnC,IAAME,EAAKtM,EAAQuM,aAAaH,GAC1BI,EAAcxM,EAAQyM,cAAcC,eAAeJ,GACzD,GAAoB,OAAhBE,EAAsB,CACxB,IAAM1F,EAAavE,KAAK4G,aAAaqD,GACrC,GAAI1F,aAAsBuC,EACxB,OAAOvC,GAKb,MAAM,IAAI1D,MAAJ,+BACoBpD,EAAQoK,QAD5B,YACuCgC,EADvC,aACqDpM,EAAQuM,aAC/DH,GAFE,W,2CAOqBpM,EAAkBoM,GAC7C,OAAO7J,KAAKuI,mBAAmBzB,EAAcrJ,EAASoM,EAAW/C,EAAazF,U,yCAGrD5D,EAAkBoM,EAAmB1I,GAC9DnB,KAAKoK,iBAAiBtD,EAAcrJ,EAASoM,EAAW1I,EAAQ2F,EAAazF,U,wCAGrD5D,EAAkBoM,EAAmBQ,GAC7D,OAAOrK,KAAKuI,mBAAmBzB,EAAWrJ,EAASoM,EAAWQ,K,gDAI9D5M,EACAoM,EACAQ,GAEA,OAAOrK,KAAKuI,mBAAmBzB,EAAmBrJ,EAASoM,EAAWQ,K,yCAItEC,EACA7M,EACAoM,EACAQ,GAEA,GAAI5M,EAAQqM,aAAaD,GAAY,CACnC,IAAM7I,EAAQvD,EAAQuM,aAAaH,GAC7BU,EAAOC,QAAQlD,IAAIgD,EAAWtJ,EAAMyJ,eAC1C,QAAavG,IAATqG,EACF,OAAOA,EAIX,OAAOF,I,uCAIPC,EACA7M,EACAoM,EACAa,EACAL,GAEA,GAAIK,IAAcL,EAChB5M,EAAQkN,gBAAgBd,OACnB,CACL,IAAM7I,EAAQsJ,EAAUI,GAAWE,cACnCnN,EAAQoN,aAAahB,EAAW7I,M,wCAIVvD,EAAkBoM,EAAmBQ,GAC7D,GAAI5M,EAAQqM,aAAaD,GAAY,CACnC,IAAM7I,EAAQ8J,SAASrN,EAAQuM,aAAaH,GAAa,IACzD,IAAKkB,OAAOC,MAAMhK,GAChB,OAAOA,EAIX,OAAOqJ,I,sCAIP5M,EACAoM,EACAQ,EACArJ,GAEIA,IAAUqJ,EACZ5M,EAAQoN,aAAahB,EAAWoB,OAAOjK,IAEvCvD,EAAQkN,gBAAgBd,K,iCAITpM,GAAkC,IAAD,gBAC9BuC,KAAKqG,WAAW6E,UADc,IAClD,2BAA8C,CAC5C,GAD4C,UAC9BzN,EACZ,OAAO,GAHuC,8BAMlD,OAAO,I,iCAGUA,GAA8C,IAAD,gBAC/BuC,KAAKqG,YAD0B,IAC9D,2BAAgD,CAAC,IAAD,yBAApCc,EAAoC,KAC9C,GAD8C,OACnC1J,EACT,OAAO0J,GAHmD,iC,oCAS1CgE,EAAiB1N,GACrC,IAAM2N,EAAaD,EAAOjB,cAAclM,cAAcP,EAAQ4N,cACxDtB,EAAK/J,KAAKsL,WAAWH,EAAOjB,cAAezM,GAMjD,OALA2N,EAAWP,aAAa,KAAMd,GAC9B/J,KAAKqG,WAAWoB,IAAI2D,EAAY3N,GAEhC0N,EAAOI,YAAYH,GAEZA,I,iCAGUrN,EAAoBN,GACrC,IAAI+N,EAAS/N,EAAQ4N,aAAaT,cACnB,cAAXY,EACFA,EAAS,IACW,UAAXA,IACTA,EAAS,KAIX,IADA,IAAIC,EAAI,EACuC,OAAxC1N,EAASoM,eAAeqB,EAASC,IACtCA,GAAK,EAEP,OAAOD,EAASC,I,wCAGQhO,GAGxB,IAFA,IAAMiO,EAAQ1L,KAAK2L,SAAS,EAAGlO,GACzBmO,EAAgB,YAAOnO,EAAQ8E,UAC9B9E,EAAQoO,WAAW/M,OAAS,GACjCrB,EAAQqO,YAAYrO,EAAQoO,WAAWtB,KAAK,IAG9C,IAPgD,EAO5CwB,GAAQ,EAPoC,cAQpBH,GARoB,IAQhD,2BAA8C,CAAC,IAApCI,EAAmC,QACxCC,EAAe,GACL,IAAVP,GAAgBK,IAClBE,EAAe,MAEjBjM,KAAKkM,QAAQzO,EAASwO,EAAejM,KAAKmM,UAAUT,EAAQ,IAC5DjO,EAAQ8N,YAAYS,GACpBD,GAAQ,GAfsC,8BAiBhD/L,KAAKkM,QAAQzO,EAASuC,KAAKmM,UAAUT,M,gCAGrBA,GAChB,MAAO,KAAO,KAAKU,OAAOV,K,+BAGXW,EAAgBlB,GAC/B,OAA6B,OAAzBA,EAAOmB,cACFD,EAEArM,KAAK2L,SAASU,EAAS,EAAGlB,EAAOmB,iB,8BAI5BnB,EAAiBoB,GAC/BpB,EAAOI,YAAYJ,EAAOjB,cAAcsC,eAAeD,Q,KC7V5CE,G,4MAPbpH,MAAaR,EAAI6H,Q,2DAGf,MAAO,kB,GAJe5H,GCQX/F,G,4MAPbuG,YAA2BvC,EAAY4J,K,2DAGrC,MAAO,a,GAJU7H,GCMN8H,G,2KAJX,MAAO,kB,GAFe9H,GCMX+H,G,2KAJX,MAAO,Y,GAFS7J,GCQL8J,G,4MAPb3J,MAAed,EAAM0K,U,2DAGnB,MAAO,gB,GAJa/J,GCQTgK,G,4MAPb3H,MAAaR,EAAIoI,e,2DAGf,MAAO,kB,GAJenI,GCMXoI,G,2KAJX,MAAO,e,GAFYlK,GCSRmK,G,4MARb9H,MAAaR,EAAIuI,M,EACjB9H,YAA2BvC,EAAYsK,a,2DAGrC,MAAO,iB,GALcvI,GCQVwI,G,4MAPbjI,MAAaR,EAAIuI,M,2DAGf,MAAO,0B,GAJuBtI,GCMnByI,G,2KAJX,MAAO,kB,GAFevK,GCQXwK,G,4MAPbnI,MAAaR,EAAI4I,S,2DAGf,MAAO,qB,GAJkB3I,GCSd4I,G,4MARbrI,MAAaR,EAAI4I,S,EACjBnI,YAA2BvC,EAAYsK,a,2DAGrC,MAAO,qB,GALkBvI,GCMd6I,G,2KAJX,MAAO,gB,GAFa3K,GCQT4K,G,4MAPbzK,MAAed,EAAMwL,K,2DAGnB,MAAO,W,GAJQ7K,GCQJ8K,G,4MAPb3K,MAAed,EAAM0L,O,2DAGnB,MAAO,c,GAJW/K,GCMPgL,G,2KAJX,MAAO,gB,GAFahL,GCCXoD,GAAa,I,iLCEK3I,GAC3B,OAAQA,EAAQoK,SACd,IAAK,cACH,OAAO7H,KAAKgI,kBAAkBiG,GAAiBxQ,GACjD,IAAK,SACH,OAAOuC,KAAKgI,kBAAkBiG,GAAYxQ,GAC5C,IAAK,cACH,OAAOuC,KAAKgI,kBAAkBiG,GAAiBxQ,GACjD,IAAK,QACH,OAAOuC,KAAK+H,gBAAgBkG,GAAWxQ,GACzC,IAAK,YACH,OAAOuC,KAAK+H,gBAAgBkG,GAAexQ,GAC7C,IAAK,cACH,OAAOuC,KAAKgI,kBAAkBiG,GAAiBxQ,GACjD,IAAK,WACH,OAAOuC,KAAK+H,gBAAgBkG,GAAcxQ,GAC5C,IAAK,aACH,OAAOuC,KAAKgI,kBAAkBiG,GAAgBxQ,GAChD,IAAK,sBACH,OAAOuC,KAAKgI,kBAAkBiG,GAAyBxQ,GACzD,IAAK,cACH,OAAOuC,KAAK+H,gBAAgBkG,GAAiBxQ,GAC/C,IAAK,iBACH,OAAOuC,KAAKgI,kBAAkBiG,GAAoBxQ,GACpD,IAAK,iBACH,OAAOuC,KAAKgI,kBAAkBiG,GAAoBxQ,GACpD,IAAK,YACH,OAAOuC,KAAK+H,gBAAgBkG,GAAexQ,GAC7C,IAAK,OACH,OAAOuC,KAAK+H,gBAAgBkG,GAAUxQ,GACxC,IAAK,UACH,OAAOuC,KAAK+H,gBAAgBkG,GAAaxQ,GAC3C,IAAK,YACH,OAAOuC,KAAK+H,gBAAgBkG,GAAexQ,GAC7C,QACE,OAAO,0EAAyBA,Q,GApCZyI,IDAfgI,GAAiB,IAAI1O,EESlC,SAAS2O,GAAYC,GAEnB,OAD0BA,EANL,GAQZA,EAfa,GAiBIA,EATR,GAWTA,EAZY,GARD,GAsBHA,EAZC,GAcTA,EAfS,GAND,GAOC,KAgBdA,EArBa,GADC,GA6BpB,SAASC,GAAYC,GAEnB,OAD0BA,GAlCN,GAoCXA,EApCW,GAQC,GA8BKA,GArCJ,GAuCbA,EAvCa,GACP,KAwCXA,EAnCY,EAsCCA,GA1CA,GA4CRA,EA5CQ,GAMC,GAJD,KA4CbA,EAvCc,GACC,GA6CrB,SAASC,GAAiBC,EAAgBC,EAAgBC,GAKxD,MAAO,CAJSF,IAAW,GACA,EAATA,IAAkB,EAAMC,IAAW,GAC1B,GAATA,IAAoB,EAAMC,IAAW,EAC9B,GAATA,GAgBlB,SAASC,GAAaC,GACpB,OAAO3D,OAAO4D,aAAP,MAAA5D,OAAM,YAAiB2D,EAAOrO,IAAI4N,M,aC7ErCW,GAAM,IAAIC,YACVC,GAAM,IAAIC,YCKT,SAASC,GAAOzP,GACrB,IDJqBe,ECIf2O,EAASjB,GAAekB,aAAa3P,GACrC4P,GDLe7O,ECKI2O,EDJlBL,GAAII,OAAO1O,ICMlB,OFsEK,SAAgB8O,GACrB,IACI7D,EADEmD,EAAS,GAEf,IAAKnD,EAAI,EAAGA,EAAI6D,EAAMxQ,OAAS,EAAG2M,GAAK,EACrCmD,EAAOW,KAAP,MAAAX,EAAM,YAASL,GAAiBe,EAAM7D,GAAI6D,EAAM7D,EAAI,GAAI6D,EAAM7D,EAAI,MAGpE,OAAIA,IAAM6D,EAAMxQ,OAAS,GACvB8P,EAAOW,KAAP,MAAAX,EAAM,YAASL,GAAiBe,EAAM7D,GAAI6D,EAAM7D,EAAI,GAAI,KACjDkD,GAAaC,GAAQY,MAAM,GAAI,GAAK,KAEzC/D,IAAM6D,EAAMxQ,OAAS,GACvB8P,EAAOW,KAAP,MAAAX,EAAM,YAASL,GAAiBe,EAAM7D,GAAI,EAAG,KACtCkD,GAAaC,GAAQY,MAAM,GAAI,GAAK,MAGtCb,GAAaC,GEtFba,CADUC,KAAaL,IAIzB,SAASM,GAAOC,GACrB,IAAMC,EFqFD,SAAgBC,GACrB,GAAIA,EAAQhR,OAAS,IAAM,EACzB,MAAM,IAAI+B,MAAM,gCAUlB,IAPA,IAvCA2N,EACAC,EACAC,EACAqB,EAoCMC,EAAoC,OAAtBF,EAAQN,OAAO,GAC7BS,GAAeD,GAAqC,MAAtBF,EAAQN,OAAO,GAC7CF,EAAQ,IAAIY,MAAMJ,EAAQhR,QAC7BqR,KAAK,GACL5P,KAAI,SAAC6P,EAAG3E,GAAJ,OAAUqE,EAAQO,WAAW5E,MACjClL,IAAI8N,IACDO,EAAS,GACNnD,EAAI,EAAGA,EAAI6D,EAAMxQ,OAAS,EAAG2M,GAAK,EACzCmD,EAAOW,KAAP,MAAAX,EAAM,aA/CRJ,EA+CkCc,EAAM7D,GA9CxCgD,EA8C4Ca,EAAM7D,EAAI,GA7CtDiD,EA6C0DY,EAAM7D,EAAI,GA5CpEsE,EA4CwET,EAAM7D,EAAI,GAvC3E,CAHU+C,GAAU,EAAMC,IAAW,GACjB,GAATA,IAAoB,EAAMC,IAAW,GAC5B,EAATA,IAAkB,EAAKqB,MA0CzC,OAAIC,EACK,IAAIM,WAAW1B,EAAOY,MAAM,GAAI,IAC9BS,EACF,IAAIK,WAAW1B,EAAOY,MAAM,GAAI,IAEhC,IAAIc,WAAW1B,GEzGPa,CAAcG,GAEzBT,EDTD,SAAgBE,GACrB,OAAOL,GAAIW,OAAON,GCQHkB,CADFb,KAAaG,IAE1B,OAAO3B,GAAesC,eAAerB,GCTxBsB,OANf,SAA0B9Q,GACxB+Q,qBAAU,WACR3S,SAAS4B,MAAQA,IAChB,CAACA,KCGSgR,OANf,SAAenF,GAGb,OAFYoF,iBAAO,GAAD,OAAIpF,EAAJ,YAAcqF,KAAKC,SAASC,SAAS,IAAIC,UAAU,KAE1DC,SC0CEC,OA7Cf,SAAqBC,EAA8BC,GACjD,IAAMC,EAAMT,iBAAOQ,GAEnBV,qBAAU,WACR,SAASY,EAAgBvU,QACNmH,IAAbiN,GAiBV,SAAyBA,EAAkBpU,GACzC,IAD+D,EAC3D+D,GAAS,EAEPyQ,EAAWJ,EAASvQ,MAAM,KAH+B,cAIzC2Q,GAJyC,IAI/D,2BAAgC,CAAC,IAAtB9T,EAAqB,QAE5BqD,EADc,SAAZrD,EACOqD,GAAU/D,EAAMyU,QACJ,UAAZ/T,EACAqD,GAAU/D,EAAM0U,SACJ,QAAZhU,EACAqD,GAAU/D,EAAM2U,OACJ,SAAZjU,EACAqD,IAAyB,MAAd/D,EAAMgE,KAA6B,MAAdhE,EAAMgE,KAC1B,UAAZtD,EACAqD,GAAwB,MAAd/D,EAAMgE,IAEhBD,GAAU/D,EAAMgE,IAAI6J,gBAAkBnN,EAAQmN,eAhBI,8BAoB/D,OAAO9J,EArC2B6Q,CAAgBR,EAAUpU,KACtDA,EAAM6U,iBACNP,EAAIJ,WAKR,OADAlT,SAAS8T,iBAAiB,UAAWP,GAC9B,WACLvT,SAAS+T,oBAAoB,UAAWR,MAEzC,CAACH,IAEJT,qBAAU,WACRW,EAAIJ,QAAUG,M,0BCpBZW,G,WA2BJ,WAAYC,EAAaC,EAAeC,GAAe,yBA1B9CF,SA0B6C,OAzB7CC,WAyB6C,OAxB7CC,UAwB6C,EACpDlS,KAAKgS,IAAMD,EAAMI,kBAAkBH,GACnChS,KAAKiS,MAAQF,EAAMI,kBAAkBF,GACrCjS,KAAKkS,KAAOH,EAAMI,kBAAkBD,G,0DAwBpC,MAAM,IAAN,OAAWH,EAAMK,SAASpS,KAAKgS,MAA/B,OAAsCD,EAAMK,SAASpS,KAAKiS,QAA1D,OAAmEF,EAAMK,SAASpS,KAAKkS,S,0BAGrFG,EAAcC,GAChB,IAAMC,EAAcR,EAAMS,MAAM,EAAG,EAAGF,GAChCG,EAAa,EAAIF,EAIvB,OAAO,IAAIR,EAHCU,EAAazS,KAAKgS,IAAMO,EAAcF,EAAML,IAC1CS,EAAazS,KAAKiS,MAAQM,EAAcF,EAAMJ,MAC/CQ,EAAazS,KAAKkS,KAAOK,EAAcF,EAAMH,S,qCA7BvCQ,GAInB,OAAO,IAAIX,EAHCjH,SAAS4H,EAAUlD,MAAM,EAAG,GAAI,IAC9B1E,SAAS4H,EAAUlD,MAAM,EAAG,GAAI,IACjC1E,SAAS4H,EAAUlD,MAAM,EAAG,GAAI,O,4BAI1BmD,EAAaC,EAAa5R,GAC7C,OAAOA,EAAQ2R,EAAMA,EAAM3R,EAAQ4R,EAAMA,EAAM5R,I,wCAGhBA,GAC/B,IAAM6R,EAAUd,EAAMS,MAAM,EAAG,IAAKxR,GACpC,OAAO6P,KAAKiC,MAAMD,K,+BAGI7R,GACtB,OAAOA,EAAM+P,SAAS,IAAIgC,SAAS,EAAG,S,KAlDpChB,GAKYiB,KAAOjB,GAAMkB,cAAc,WALvClB,GAMYmB,OAASnB,GAAMkB,cAAc,WANzClB,GAOYoB,OAASpB,GAAMkB,cAAc,WAPzClB,GAQYqB,KAAOrB,GAAMkB,cAAc,WARvClB,GASYsB,IAAMtB,GAAMkB,cAAc,WATtClB,GAUYuB,OAASvB,GAAMkB,cAAc,WAVzClB,GAWYwB,OAASxB,GAAMkB,cAAc,WAXzClB,GAYYyB,MAAQzB,GAAMkB,cAAc,WAZxClB,GAaY0B,KAAO1B,GAAMkB,cAAc,WAbvClB,GAcY2B,KAAO3B,GAAMkB,cAAc,WAdvClB,GAeY4B,MAAQ5B,GAAMkB,cAAc,WAfxClB,GAgBY6B,KAAO7B,GAAMkB,cAAc,WAhBvClB,GAiBY8B,UAAY9B,GAAMkB,cAAc,WAjB5ClB,GAkBY+B,QAAU/B,GAAMkB,cAAc,WAlB1ClB,GAmBYgC,UAAYhC,GAAMkB,cAAc,WAnB5ClB,GAoBYiC,QAAUjC,GAAMkB,cAAc,WApB1ClB,GAqBYkC,KAAOlC,GAAM2B,KArBzB3B,GAsBYmC,QAAUnC,GAAMwB,OAtB5BxB,GAuBYoC,OAASpC,GAAMsB,IAvB3BtB,GAwBYqC,MAAQrC,GAAMkB,cAAc,WAxBxClB,GAyBYsC,KAAOtC,GAAMkB,cAAc,WA0C9BlB,ICnEVuC,GDmEUvC,MEiBAwC,G,WA5Eb,WAAYC,GAA0B,yBAJrBA,eAIoB,OAH7BC,OAAqB,GAGQ,KAF7BC,MAAQ,EAGd1U,KAAKwU,UAAYA,E,4DAGHrF,GAGd,OAFAnP,KAAK0U,MAAQ,EACb1U,KAAKyU,OAASzU,KAAKwU,UAAUG,SAASxF,GAC/BnP,KAAK4U,U,8BAKIC,GAChB,IAAMC,EAAQ9U,KAAKyU,OAAOzU,KAAK0U,OAC/B,GAAII,EAAMD,OAASA,EAEjB,OADA7U,KAAK0U,OAAS,EACPI,EAEP,MAAM,IAAIjU,MAAJ,mBAAsBgU,EAAtB,qBAAuCC,EAAMD,S,mCAWU,IAAD,uBAAxCE,EAAwC,yBAAxCA,EAAwC,gBAC9D,cAAqBA,EAArB,eAA8B,CAAzB,IAAM5O,EAAM,KACTnF,EAAQhB,KAAKgV,cAAc7O,GACjC,QAAcjC,IAAVlD,EACF,OAAOA,EAIX,MAAM,IAAIH,MAAM,iC,+BAGIsF,GAEpB,IADA,IAAMrF,EAAS,IAAI0B,MACN,CACX,IAAMyS,EAAWjV,KAAK0U,MACtB,IACE5T,EAAO8B,IAAIuD,EAAO+O,KAAKlV,OACvB,MAAOqJ,GAEP,OADArJ,KAAK0U,MAAQO,EACNnU,EAGT,GADiBd,KAAK0U,OACNO,EACd,MAAM,IAAIpU,MAAM,iC,oCAKKsF,GACzB,IACIrF,EADEmU,EAAWjV,KAAK0U,MAEtB,IACE5T,EAASqF,EAAO+O,KAAKlV,MACrB,MAAOqJ,GAEP,YADArJ,KAAK0U,MAAQO,GAKf,GADiBjV,KAAK0U,OACNO,EACd,MAAM,IAAIpU,MAAM,8BAGlB,OAAOC,M,KC7BIqU,G,iDAhDLC,QAAU,G,KACVV,MAAQ,E,qDAEPU,GACPpV,KAAKoV,QAAUA,EACfpV,KAAK0U,MAAQ,EAEb,IADA,IAAMD,EAAS,GACRzU,KAAK0U,MAAQ1U,KAAKoV,QAAQtW,QAAQ,CACvC,IAAMmW,EAAWjV,KAAK0U,MAChBG,EAAO7U,KAAKqV,OACZC,EAAWtV,KAAK0U,MACtB,GAAIY,GAAYL,EACd,MAAM,IAAIpU,MAAM,kCAGlB,GAAa,OAATgU,EAAJ,CAIA,IAAM7T,EAAQhB,KAAKoV,QAAQ5F,MAAMyF,EAAUK,GAC3Cb,EAAOlF,KAAK,CAAEsF,OAAM7T,WAGtB,OAAOyT,I,8BAKSc,GAChB,IAAMC,EAAQxV,KAAKoV,QAAQ5F,MAAMxP,KAAK0U,OAAOc,MAAMD,GACnD,OAAc,OAAVC,IAIJxV,KAAK0U,OAASc,EAAM,GAAG1W,QAChB,K,iCAGYyW,GACnB,QAAIvV,KAAKoV,QAAQK,WAAWF,EAAQvV,KAAK0U,SACvC1U,KAAK0U,OAASa,EAAOzW,QACd,O,eF5CRwV,O,mBAAAA,I,mBAAAA,I,iBAAAA,I,eAAAA,I,aAAAA,I,eAAAA,I,iBAAAA,I,mBAAAA,I,2BAAAA,I,kBAAAA,Q,KAaUA,I,GAAAA,MGmBAoB,G,qKA1BX,OAAI1V,KAAK2V,QAAQ,SAGb3V,KAAK2V,QAAQ,kBACb3V,KAAK2V,QAAQ,gBAJgB,KAO7B3V,KAAK2V,QAAQ,qCAA6CrB,GAASsB,MACnE5V,KAAK2V,QAAQ,uBAA+BrB,GAASuB,OAGrD7V,KAAKyV,WAAW,KAAanB,GAASwB,OACtC9V,KAAKyV,WAAW,KAAanB,GAASyB,OACtC/V,KAAKyV,WAAW,KAAanB,GAAS0B,MACtChW,KAAKyV,WAAW,KAAanB,GAAS2B,KACtCjW,KAAKyV,WAAW,KAAanB,GAAS4B,IACtClW,KAAKyV,WAAW,KAAanB,GAAS6B,KAEtCnW,KAAK2V,QAAQ,2BAAmCrB,GAAS8B,YAG7DpW,KAAK2V,QAAQ,MACNrB,GAAS+B,W,GAzBOlB,ICOZmB,GANb,WAAYvV,EAAaC,GAAiB,yBAHjCD,SAGgC,OAFhCC,WAEgC,EACvChB,KAAKe,IAAMA,EACXf,KAAKgB,MAAQA,G,YCMdmB,OAAOC,S,IAuCKmU,G,WA7Cb,aAA+C,IAAnCC,EAAkC,uDAArB,IAAIhU,IAAiB,yBAF3BjC,SAE2B,EAC5CP,KAAKO,IAAM,IAAI+F,IACb,YAAIkQ,GAAYjW,KAAI,SAACkW,GAAD,MAAc,CAACA,EAAS1V,IAAK0V,EAASzV,W,+CAK5D,OAAOhB,KAAKO,IAAImW,Y,6BAGXnW,GAAyB,IAAD,gBACFA,GADE,IAC7B,2BAAgC,CAAC,IAAD,yBAApBQ,EAAoB,KAAfC,EAAe,KAC9BhB,KAAKO,IAAIkH,IAAI1G,EAAKC,IAFS,8BAI7B,OAAOhB,O,gCAGCe,EAAasJ,GACrB,IAAMrJ,EAAQhB,KAAKO,IAAI+G,IAAIvG,GAC3B,MAAqB,kBAAVC,EACFA,EAGFqJ,I,+BAGAtJ,EAAasJ,GACpB,IAAMrJ,EAAQhB,KAAKO,IAAI+G,IAAIvG,GAC3B,OAAIC,aAAiB+Q,GACZ/Q,EAGFqJ,I,+BAGAtJ,EAAasJ,GACpB,IAAMrJ,EAAQhB,KAAKO,IAAI+G,IAAIvG,GAC3B,MAAqB,kBAAVC,EACFA,EAGFqJ,M,KClBIsM,G,WAvBb,aAAsC,IAA1BC,EAAyB,uDAAjB,IAAIpU,IAAa,yBAF5BoU,WAE4B,EACnC5W,KAAK4W,MAAQA,E,0DAGDC,GACZ,IAD4C,EACtC/V,EAAS,IAAIyV,GADyB,eAEpBM,GAAjBC,EAFqC,KAE5BC,EAF4B,WAGtCC,EAAUD,EAAKjY,OAAS,EAHc,cAIzBkB,KAAK4W,OAJoB,IAI5C,2BAA+B,CAAC,IAArBK,EAAoB,QAC7B,GAAIA,EAAKC,SAASC,MAAQL,EAAM,CAC9B,IAAMN,EAAa,IAAID,GAAYU,EAAKT,YACpCQ,IACFR,EAAWY,OAAOpX,KAAKqX,cAAcN,IACrCP,EAAWY,OAAOH,EAAKI,cAAcN,KAEvCjW,EAAOsW,OAAOZ,KAX0B,8BAe5C,OAAO1V,M,KCVIwW,G,kDAPb,WAAYJ,EAAoBV,EAA2BI,GAAmB,IAAD,8BAC3E,cAAMA,IAJCM,cAGoE,IAFpEV,gBAEoE,EAE3E,EAAKU,SAAWA,EAChB,EAAKV,WAAaA,EAHyD,E,UAJ5DG,ICQJY,GAPb,WAAYJ,EAAaK,EAAsBzN,GAAc,yBAJpDoN,SAImD,OAHnDK,aAGmD,OAFnDzN,QAEmD,EAC1D/J,KAAKmX,IAAMA,EACXnX,KAAKwX,QAAUA,EACfxX,KAAK+J,GAAKA,GCED5D,GAAS,I,kDCApB,aAAe,uCACP,IAAIuP,I,oDAIV,OAAO,IAAIiB,GAAM3W,KAAKyX,kB,qCAItB,OAAOzX,KAAK0X,SAAS1X,KAAK2X,a,kCAI1B,IAAMT,EAAWlX,KAAK4X,gBACtB5X,KAAK6X,QAAQvD,GAASwB,QACtB,IAAMU,EAAaxW,KAAK8X,mBAClBlB,EAAQ5W,KAAKyX,eAGnB,OAFAzX,KAAK6X,QAAQvD,GAASyB,QAEf,IAAIuB,GAAKJ,EAAUV,EAAYI,K,sCAItC,IAAMO,EAAMnX,KAAK6X,QAAQvD,GAAS8B,YAC5BoB,EAAUxX,KAAK+X,gBACfhO,EAAK/J,KAAKgY,kBAEhB,OAAO,IAAIT,GAASJ,EAAInW,MAAOwW,EAASzN,K,yCAIxC,OAAO/J,KAAK0X,SAAS1X,KAAKiY,iB,sCAI1B,IAAMlX,EAAMf,KAAKkY,kBACjBlY,KAAK6X,QAAQvD,GAAS0B,OAEtB,IAAMhV,EAAQhB,KAAKmY,WAAWnY,KAAKoY,WAAYpY,KAAKqY,YAAarY,KAAKsY,sBAGtE,OAFAtY,KAAK6X,QAAQvD,GAAS2B,MAEf,IAAIK,GAASvV,EAAKC,K,sCAIzB,OAAOhB,KAAK0X,SAAS1X,KAAKuY,c,mCAM1B,OAFAvY,KAAK6X,QAAQvD,GAAS4B,KACJlW,KAAK6X,QAAQvD,GAAS8B,YACvBpV,Q,wCAIjB,OAAOhB,KAAKgV,cAAchV,KAAKwY,W,gCAM/B,OAFAxY,KAAK6X,QAAQvD,GAAS6B,MACXnW,KAAK6X,QAAQvD,GAAS8B,YACvBpV,Q,mCAIV,IAAMyX,EAAQzY,KAAK6X,QAAQvD,GAASsB,OACpC,OAAO7D,GAAMkB,cAAcwF,EAAMzX,S,oCAIjC,IAAM0X,EAAS1Y,KAAK6X,QAAQvD,GAASuB,QACrC,OAAO8C,WAAWD,EAAO1X,S,6CAIzB,IAAM4X,EAAa5Y,KAAKkY,kBACxB,OAAQU,GACN,IAAK,OACH,OAAO7G,GAAMiB,KACf,IAAK,SACH,OAAOjB,GAAMmB,OACf,IAAK,SACH,OAAOnB,GAAMoB,OACf,IAAK,OACH,OAAOpB,GAAMqB,KACf,IAAK,MACH,OAAOrB,GAAMsB,IACf,IAAK,SACH,OAAOtB,GAAMuB,OACf,IAAK,SACH,OAAOvB,GAAMwB,OACf,IAAK,QACH,OAAOxB,GAAMyB,MACf,IAAK,OACH,OAAOzB,GAAM0B,KACf,IAAK,OACH,OAAO1B,GAAM2B,KACf,IAAK,QACH,OAAO3B,GAAM4B,MACf,IAAK,OACH,OAAO5B,GAAM6B,KACf,IAAK,YACH,OAAO7B,GAAM8B,UACf,IAAK,UACH,OAAO9B,GAAM+B,QACf,IAAK,YACH,OAAO/B,GAAMgC,UACf,IAAK,UACH,OAAOhC,GAAMiC,QACf,IAAK,OACH,OAAOjC,GAAMkC,KACf,IAAK,UACH,OAAOlC,GAAMmC,QACf,IAAK,SACH,OAAOnC,GAAMoC,OACf,IAAK,QACH,OAAOpC,GAAMqC,MACf,IAAK,OACH,OAAOrC,GAAMsC,KACf,QACE,OAAOuE,K,wCAMX,OADmB5Y,KAAK6X,QAAQvD,GAAS8B,YACvBpV,U,GA/HEuT,KCGxB,SAASsE,GAAgBC,GACvB,IAAMtN,EAASsN,EAAOtJ,MAAM,EAAG,GAAG5E,cAClC,OAAIvL,EAAQ0Z,SAASvN,GACZA,EAEA5O,EAAO2C,QAIlB,SAASyZ,KACP,GAAI5a,IAAoB,CACtB,IAAM6a,EAAe1a,aAAa2a,QAAQ,UAC1C,GAAqB,OAAjBD,EACF,OAAOA,EAIX,MAAkC,kBAAvBE,UAAUC,SACZD,UAAUC,SAGZxc,EAAO2C,QCEhB,SAAS8Z,GAAUC,GAYjB,OAXIlb,KACFG,aAAaC,QACX,OACA+a,KAAKC,UAAU,CACbC,KAAMH,EAAMG,KACZC,UAAWJ,EAAMI,UACjBC,UAAWL,EAAMK,UACjBC,KAAMN,EAAMM,QAIXN,ECpCF,SAASO,KACd,OAAOC,KAAU,WAAV,aAOT,IAAMC,GAAQC,aAA6B,CCIpC,SAAcD,GACnBA,EAAME,GAAG,SAAS,iBAAO,CACvBta,MAAO,GACPE,IAAK,GACLE,IAAK,GACLH,MAAO,IAAIiE,EACX/D,MAAO,IAAI6W,OAGboD,EAAME,GAAG,aAAa,SAACX,EAAD,GAAiC,IAAvBzZ,EAAsB,EAAtBA,IAAKE,EAAiB,EAAjBA,IAAKJ,EAAY,EAAZA,MACxCoa,EAAMG,SAAS,WAAYra,GAC3Bka,EAAMG,SAAS,WAAYna,GAC3Bga,EAAMG,SAAS,aAAcva,MAG/Boa,EAAME,GAAG,YAAY,SAACX,EAAO7b,GAC3B6b,EAAM1Z,MAAMwJ,SAAS3L,GACrBsc,EAAMG,SAAS,aAAcZ,EAAM1Z,UAGrCma,EAAME,GAAG,eAAe,SAACX,EAAO7b,GAC9B6b,EAAM1Z,MAAMua,YAAY1c,GACxBsc,EAAMG,SAAS,aAAcZ,EAAM1Z,UAGrCma,EAAME,GAAG,YAAY,SAACX,EAAOzZ,GAC3B,IAAMD,EAAQwG,GAAWgU,YAAYva,GACrC,OAAO,6BAAKyZ,GAAZ,IAAmBzZ,MAAKD,aAG1Bma,EAAME,GAAG,YAAY,SAACX,EAAOvZ,GAC3B,IAAMD,EAAQqG,GAAOO,gBAAgB3G,GACrC,OAAO,6BAAKuZ,GAAZ,IAAmBvZ,MAAKD,aAG1Bia,EAAME,GAAG,cAAc,SAACX,EAAO3Z,GAAR,oBAAC,gBAAuB2Z,GAAxB,IAA+B3Z,aAEtDoa,EAAME,GAAG,cAAc,SAACX,EAAO7b,GAC7B2I,GAAWiU,cAAc5c,GACzB,IAAMoC,EAAMuG,GAAWkU,UAAUhB,EAAM1Z,OACvC,OAAO,6BAAK0Z,GAAZ,IAAmBzZ,YHrBhB,SAAgBka,GACrBA,EAAME,GAAG,SAAS,iBAAO,CAAEnB,OAAQD,GAAgBG,UAEnDe,EAAME,GAAG,iBAAiB,SAACX,EAAOR,GAEhC,OAXJ,SAAqBA,GACf1a,KACFG,aAAaC,QAAQ,SAAUsa,GAQ/ByB,CAAYzB,GACL,6BAAKQ,GAAZ,IAAmBR,eCGhB,SAAciB,GACnB,IACMS,EAAc,CAAC,IAAM,GAAK,IAAM,EAAK,KAAM,IAAK,EAAG,GAEzDT,EAAME,GACJ,SACA,WAAkB,IAAD,EA9BrB,WACE,GAAI7b,IAAoB,CACtB,IAAMmM,EAAOhM,aAAa2a,QAAQ,QAClC,GAAa,OAAT3O,EAAe,OAAOgP,KAAK3E,MAAMrK,GAGvC,MAAO,GAyB8DkQ,GADlD,IACPhB,YADO,aACOC,iBADP,MACmB,EADnB,MACsBC,iBADtB,MACkC,EADlC,MACqCC,KACpD,MAAO,CAAEH,OAAMC,YAAWC,YAAWC,UAFtB,MAC4C,EAD5C,MAMnBG,EAAME,GAAG,iBAAiB,SAACS,GACzBX,EAAMG,SAAS,iBAAkBQ,EAAUhB,UAZ7B,OAehBK,EAAME,GAAG,kBAAkB,SAACS,GAC1BX,EAAMG,SAAS,iBAAkBQ,EAAUhB,UAhB7B,OAmBhBK,EAAME,GAAG,eAAe,SAACS,GACvBX,EAAMG,SAAS,iBAAkBQ,EAAUf,UApB7B,OAuBhBI,EAAME,GAAG,iBAAiB,SAACS,GACzBX,EAAMG,SAAS,iBAAkBQ,EAAUf,UAxB7B,OA2BhBI,EAAME,GAAG,eAAe,YAAe,IAAZL,EAAW,EAAXA,KACnBlF,EAAQ8F,EAAYG,QAAQf,GAC9BlF,EAAQ,EAAI8F,EAAY1b,QAC1Bib,EAAMG,SAAS,YAAaM,EAAY9F,EAAQ,OAIpDqF,EAAME,GAAG,gBAAgB,YAAe,IAAZL,EAAW,EAAXA,KACpBlF,EAAQ8F,EAAYG,QAAQf,GAC9BlF,EAAQ,GACVqF,EAAMG,SAAS,YAAaM,EAAY9F,EAAQ,OAIpDqF,EAAME,GAAG,kBAAkB,WACzBF,EAAMG,SAAS,YAAa,MAG9BH,EAAME,GAAG,aAAa,SAACS,EAAWjB,GAChC,OAAOJ,GAAU,6BAAKqB,GAAN,IAAiBjB,aAGnCM,EAAME,GAAG,kBAAkB,SAACS,EAAWhB,GACrC,OAAOL,GAAU,6BAAKqB,GAAN,IAAiBhB,kBAGnCK,EAAME,GAAG,kBAAkB,SAACS,EAAWf,GACrC,OAAON,GAAU,6BAAKqB,GAAN,IAAiBf,kBAGnCI,EAAME,GAAG,aAAa,SAACS,EAAWd,GAChC,OAAOP,GAAU,6BAAKqB,GAAN,IAAiBd,gBCxF9B,SAASgB,GAAT,GAAqC,IAApBrY,EAAmB,EAAnBA,SACtB,OAAOsY,IAAM7c,cAAc8c,KAAaC,SAAU,CAAE/Z,MAAO+Y,IAASxX,G,mBEZvDyY,OAJf,YAA8C,IAApBzY,EAAmB,EAAnBA,SACxB,OAAO,qBAAK0Y,UAAU,kBAAf,SAAkC1Y,KCC5B2Y,OARf,WACE,OACE,6BACE,oBAAID,UAAU,wB,oBC0BLE,OAvBf,YAAwC,IAApBhK,EAAmB,EAAnBA,SACZiK,EAAOC,cACPC,EAAQ,IAAIhV,IAAI,CACpB,CAAC,MAAO8U,EAAKG,cAAc,CAAExR,GAAI,eAAgByR,eAAgB,SACjE,CAAC,YAAaJ,EAAKG,cAAc,CAAExR,GAAI,qBAAsByR,eAAgB,UAC7E,CAAC,aAAcJ,EAAKG,cAAc,CAAExR,GAAI,sBAAuByR,eAAgB,WAC/E,CAAC,UAAWJ,EAAKG,cAAc,CAAExR,GAAI,mBAAoByR,eAAgB,QACzE,CAAC,YAAaJ,EAAKG,cAAc,CAAExR,GAAI,qBAAsByR,eAAgB,UAC7E,CAAC,OAAQJ,EAAKG,cAAc,CAAExR,GAAI,gBAAiByR,eAAgB,UACnE,CAAC,SAAUJ,EAAKG,cAAc,CAAExR,GAAI,kBAAmByR,eAAgB,YACvE,CAAC,QAASJ,EAAKG,cAAc,CAAExR,GAAI,iBAAkByR,eAAgB,WACrE,CAAC,OAAQJ,EAAKG,cAAc,CAAExR,GAAI,gBAAiByR,eAAgB,UACnE,CAAC,QAASJ,EAAKG,cAAc,CAAExR,GAAI,iBAAkByR,eAAgB,aAGjE1V,EAAOqL,EACVvQ,MAAM,KACNL,KAAI,SAACkb,GAAD,uBAAUH,EAAMhU,IAAImU,UAApB,QAA6BA,KACjC/a,KAAK,KAER,OAAO,sBAAMua,UAAU,uBAAhB,SAAwCnV,KCSlC4V,OAvBf,YAAuE,IAA/CC,EAA8C,EAA9CA,QAASxK,EAAqC,EAArCA,SAAUyK,EAA2B,EAA3BA,OAAQrZ,EAAmB,EAAnBA,SAUjD,OAJA2O,GAAYC,GAAU,WACb,OAAPwK,QAAO,IAAPA,UAIA,6BACE,yBACEA,QAZN,SAAqB5e,GACnBA,EAAM6U,iBACC,OAAP+J,QAAO,IAAPA,QAWIV,UAAWY,KAAW,6BAA8B,CAAED,WAFxD,UAIGrZ,EACA4O,GAAY,cAAC,GAAD,CAAUA,SAAUA,UCT1B2K,OAXf,YAA6E,IAAD,IAApDC,iBAAoD,MAAxC,QAAwC,EAA/BC,EAA+B,EAA/BA,WAAYzZ,EAAmB,EAAnBA,SACvD,OACE,oBACE0Y,UAAWY,KAAW,gBAAD,wBAAmCE,IACxDE,kBAAiBD,EAFnB,SAIGzZ,K,SCoBQ2Z,OAzBf,YAA6D,IAAnCnS,EAAkC,EAAlCA,GAAIkR,EAA8B,EAA9BA,UAAW1Y,EAAmB,EAAnBA,SACjC4Z,EAAWvL,iBAAwB,MAWzC,OACE,wBACE7G,GAAIA,EACJsH,IAZJ,SAAmB5T,GACM,IAAD,EAAN,OAAZA,GACF,UAAA0e,EAASlL,eAAT,SAAkBmL,UAClBD,EAASlL,QAAU,MAEnBkL,EAASlL,QAAU,IAAIoL,KAAS5e,IAQhC6e,gBAAc,QACdC,iBAAe,WACftB,UAAWY,KAAW,MAAO,WAAY,kBAAmBZ,GAL9D,SAOG1Y,K,gFCVP,SAASia,GAAcC,EAAuBC,GAK5C,OAJA,OAAIA,QAAJ,IAAIA,OAAJ,EAAIA,MACFC,YAAW,WACJF,EAAGnD,MAAMsD,kBAAkBH,EAAGI,SAAS,CAAEC,gBAAgB,MAC7D,KACEC,KAAWC,KAGpB,SAASC,GAAkBR,GACzB,OAAOD,GAAcC,GAAI,WACvB,IAAMS,EAAMT,EAAGU,YACf,MAAkE,MAA3DV,EAAGW,SAASL,KAAWM,IAAIH,EAAII,KAAMJ,EAAIK,GAAK,GAAIL,MAI7D,SAASM,GAAgBf,GACvB,OAAOD,GAAcC,GAAI,WACvB,IAAMgB,EAAMhB,EAAGiB,WAAWjB,EAAGU,aAC7B,SACe,WAAbM,EAAIE,MACF,OAAOC,KAAKH,EAAItO,OAAO0O,OAAOJ,EAAItO,OAAOrQ,OAAS,KAA6B,IAAtB2e,EAAItO,OAAOrQ,SAG1Die,KAAWe,UAAUrB,EAAGsB,UAAWN,EAAInE,OAAOA,MAC/CzR,WAqEFmW,OAjEf,YAA+D,IAA7C5E,EAA4C,EAA5CA,SAAUpY,EAAkC,EAAlCA,MAAOid,EAA2B,EAA3BA,OAAQC,EAAmB,EAAnBA,SACnCC,EAAcvN,iBAAOsN,GACrB7M,EAAMT,iBAA4B,MAClCwN,EAASxN,iBAA0B,MA2DzC,OAzDAF,qBAAU,WACRyN,EAAYlN,QAAUiN,IACrB,CAACA,IAEJxN,qBAAU,WACR,IAAM2N,EAAoB,QAAbjF,EAAqB,MAAQ,cACpCkF,EAAc,CAAEC,WAAYN,GAC5BO,EAAazB,KAAW0B,aAAapN,EAAIJ,QAAU,CACvDoN,OACAK,aAAa,EACbC,MAAO,OACPC,WAAW,EACXC,aAAa,EACbC,QAAS,EACTC,UAAW,CACT,MAAOvC,GACP,MAAOS,GACP,MAAOO,GACP,MAAOA,GACP,aAAc,eACd,SAAU,iBAEZc,gBAIF,OAFAF,EAAOnN,QAAUuN,EAEV,WACLA,EAAWQ,gBAEZ,CAAC5F,EAAU6E,IAEdvN,qBAAU,WAKR,SAASuO,EAAcliB,GACjBA,EAAMgE,IAAIgY,SAAS,UACrBhc,EAAMmiB,kBAIV,SAASC,IACP,IACwB,EADlBC,EAAWhB,EAAOnN,QAASoO,WAC7BD,IAAape,IACf,UAAAmd,EAAYlN,eAAZ,cAAAkN,EAAsBiB,IAM1B,OAnBIhB,EAAOnN,QAASoO,aAAere,GACjCod,EAAOnN,QAASqO,SAASte,GAgB3Bod,EAAOnN,QAASsO,oBAAoB1N,iBAAiB,UAAWoN,GAChEb,EAAOnN,QAASgJ,GAAG,SAAUkF,GACtB,WACLf,EAAOnN,QAASsO,oBAAoBzN,oBAAoB,UAAWmN,GACnEb,EAAOnN,QAASuO,IAAI,SAAUL,MAE/B,CAACne,IAEG,0BAAUqQ,IAAKA,EAAKoO,aAAcze,KC9F5B0e,OARf,YAA6D,IAArCxhB,EAAoC,EAApCA,KAAM+c,EAA8B,EAA9BA,UAAW1Y,EAAmB,EAAnBA,SACvC,OACE,mBAAGrE,KAAMA,EAAM+c,UAAWA,EAAW9R,OAAO,SAASwW,IAAI,sBAAzD,SACGpd,K,MCAQqd,OAJf,YAAmC,IAAnBC,EAAkB,EAAlBA,QACd,OAAO,sBAAM5E,UAAWY,KAAW,YAAagE,M,eCUnCC,OARf,YAA+D,IAA/CjhB,EAA8C,EAA9CA,KAA8C,IAAxC4Z,aAAwC,MAAhC1G,GAAMsC,KAA0B,MAApB0L,YAAoB,MAAb,GAAa,EAC5D,OACE,qBAAK9E,UAAU,YAAYhY,MAAO8c,EAAM7c,OAAQ6c,EAAM5P,KAAMsI,EAAMuH,cAAlE,SACE,qBAAKC,UAAS,UAAKC,KAAL,YAAgBrhB,QCbrB,OAA0B,iCCuB1BshB,OAdf,YAAuC,IAApB5d,EAAmB,EAAnBA,SACjB,OACE,qBAAK0Y,UAAU,8CAA8Cnb,MAAO,CAAEsgB,SAAU,QAAhF,SACE,eAAC,GAAD,WACE,uBAAMnF,UAAU,eAAhB,UACE,qBAAKoF,IAAI,OAAOC,IAAKC,GAAMrd,OAAQ,GAAID,MAAO,GAAIgY,UAAU,6BAA8B,IAC1F,cAAC,KAAD,CAAkBlR,GAAG,QAAQyR,eAAe,kBAE9C,oBAAIP,UAAU,wCAAd,SAAuD1Y,UCLhDie,OAJf,YAAkD,IAA/BvF,EAA8B,EAA9BA,UAAW1Y,EAAmB,EAAnBA,SAC5B,OAAO,oBAAI0Y,UAAWY,KAAW,WAAYZ,GAAtC,SAAmD1Y,KCoB7Cke,OAff,YAAsE,IAAD,IAArD7E,cAAqD,SAArCG,EAAqC,EAArCA,UAAWpc,EAA0B,EAA1BA,MAAO4C,EAAmB,EAAnBA,SAC1CwH,EAAK4G,GAAM,QAEjB,OACE,eAAC,GAAD,CAASsK,UAAU,WAAnB,UACE,cAAC,GAAD,CAAgBlR,GAAIA,EAAIkR,UAAWY,KAAW,WAAY,CAAED,WAA5D,SACGjc,IAEH,cAAC,GAAD,CAAcoc,UAAWA,EAAWC,WAAYjS,EAAhD,SACGxH,Q,MCQMme,OApBf,YAA0D,IAAjCjhB,EAAgC,EAAhCA,KAAMkhB,EAA0B,EAA1BA,gBAa7B,OACE,eAAC,GAAD,CAAchF,QAbhB,WAA8B,IAAD,gBACLlc,EAAKG,OADA,IAC3B,2BAAkC,CAAC,IAAxBnC,EAAuB,SAC5BA,EAAQmjB,cAEDnjB,aAAmBqH,IACxBrH,EAAQwH,GAAG2b,cAAgBnjB,EAAQsH,KAAK6b,gBAF5CD,EAAgBljB,IAHO,gCAaS0T,SAAS,SAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,WADb,IACyB,cAAC,KAAD,CAAkBkL,GAAG,cAAcyR,eAAe,eCahEqF,OA5Bf,YAA0D,IAA9BphB,EAA6B,EAA7BA,KAAMqhB,EAAuB,EAAvBA,aAqBhC,OACE,eAAC,GAAD,CAAcnF,QArBhB,WACE,IAD2B,EACrBoF,EAAsB,IAAIve,IADL,cAEL/C,EAAKG,OAFA,IAE3B,2BAAkC,CAAC,IAAxBnC,EAAuB,QAC5BA,EAAQmjB,eACVG,EAAoBne,IAAInF,GACxBA,EAAQujB,aAAY,KALG,kDASLD,GATK,IAS3B,2BAA2C,CAAC,IAAjCtjB,EAAgC,QACnCwjB,EAAQxjB,EAAQwjB,QACtBA,EAAMD,aAAY,GAFuB,oBAGrBvjB,EAAQwG,eAHa,IAGzC,2BAA2C,CAAC,IACpCid,EADmC,QAChBD,QACzBA,EAAM7X,SAAS8X,IALwB,8BAOzCJ,EAAaG,IAhBY,gCAqBS9P,SAAS,SAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,UADb,IACwB,cAAC,KAAD,CAAkBkL,GAAG,iBAAiByR,eAAe,kBCElE2F,OA1Bf,YAA2C,IAAxBC,EAAuB,EAAvBA,aACXhG,EAAOC,cAkBb,OACE,eAAC,GAAD,CAAcM,QAjBhB,WACE,IAAM0F,EAAWjG,EAAKG,cAAc,CAAExR,GAAI,WAAYyR,eAAgB,aAChE8F,EAAUlG,EAAKG,cAAc,CACjCxR,GAAI,mBACJyR,eAAgB,wCAEZ7b,EAAQrB,OAAOijB,OAAOD,EAASD,GACvB,OAAV1hB,GACFyhB,EAAa,CACXzhB,QACAI,IAAKX,EACLS,IAAKV,KAMT,UACE,cAAC,GAAD,CAAMN,KAAK,sBADb,IACoC,cAAC,KAAD,CAAkBkL,GAAG,WAAWyR,eAAe,gBCNxEgG,OAff,YAA4C,IAAxBJ,EAAuB,EAAvBA,aAQlB,OACE,eAAC,GAAD,CAAczF,QARhB,W1EwDK,IAAoB8F,K0EvDZ,O1EwDN,IAAIC,SAAgB,SAACC,GAC1B,IAAMC,EAAc7jB,SAASC,cAAc,SAE3C4jB,EAAY/P,iBACV,UACA,WACM+P,EAAYC,MAAO/iB,OAAS,GAC9B6iB,EAAQC,EAAYC,MAAOtX,KAAK,GAAIzE,UAGxC,CAAEgc,MAAM,IAGVF,EAAYjE,KAAO,OACnBiE,EAAYG,OAASN,EACrBG,EAAYI,UAAW,EACvBJ,EAAYzjB,Y0ExEO8jB,MAAK,SAAC/hB,GACvB,IAAMT,EAAOyO,GAAesC,eAAetQ,GAC3CkhB,EAAa3hB,OAKqB0R,SAAS,SAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,WADb,IACyB,cAAC,KAAD,CAAkBkL,GAAG,YAAYyR,eAAe,iBCgB9D0G,OA1Bf,YAAqD,IAA/BziB,EAA8B,EAA9BA,KAAM0iB,EAAwB,EAAxBA,cACpB/G,EAAOC,cAab,OACE,eAAC,GAAD,CAAcM,QAZhB,WACE,IAAM2F,EAAUlG,EAAKG,cAAc,CACjCxR,GAAI,sBACJyR,eAAgB,uBAEZ4G,EAAW9jB,OAAOijB,OAAOD,EAAS7hB,EAAKE,OAC5B,OAAbyiB,GACFD,EAAcC,IAKhB,UACE,cAAC,GAAD,CAAMvjB,KAAK,WAAY,IACvB,cAAC,KAAD,CACEkL,GAAG,cACHyR,eAAe,uBACftQ,OAAQ,CAAEvL,MAAOF,EAAKE,aCNf0iB,OAff,YAAoC,IAAhB5iB,EAAe,EAAfA,KAQlB,OACE,eAAC,GAAD,CAAckc,QARhB,WACE,IAAMzb,EAAUoiB,KAAKpU,GAAekB,aAAa3P,IAC3C8iB,EAAM,IAAIC,IAAJ,iCAAkCtiB,IAE9CvC,EAAa,GAAD,OAAIH,EAAiBiC,EAAKE,OAA1B,QAAwC4iB,EAAIxR,aAIpBI,SAAS,SAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,mBADb,IACiC,cAAC,KAAD,CAAkBkL,GAAG,YAAYyR,eAAe,iBCGtEiH,OAVf,YAA0E,IAApD3J,EAAmD,EAAnDA,OAAQja,EAA2C,EAA3CA,KAA2C,IAArCghB,eAAqC,MAA3B/G,EAA2B,EAAnBoF,EAAmB,EAAnBA,SAC9C9C,EAAOC,cAEb,OACE,eAAC,GAAD,CAAcO,OAAQR,EAAKtC,SAAWA,EAAQ6C,QAAS,kBAAMuC,EAASpF,IAAtE,UACE,cAAC,GAAD,CAAM+G,QAASA,IADjB,IAC8BhhB,MCInB6jB,OAbf,YAAsC,IAAlBC,EAAiB,EAAjBA,OAKlB,OACE,eAAC,GAAD,CAAchH,QALhB,WACEgH,KAIoCxR,SAAS,YAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,sBAAuB,IAClC,cAAC,KAAD,CAAkBkL,GAAG,gBAAgByR,eAAe,kBCK3CoH,OAbf,YAAsC,IAAlBD,EAAiB,EAAjBA,OAKlB,OACE,eAAC,GAAD,CAAchH,QALhB,WACEgH,KAIoCxR,SAAS,YAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,sBAAuB,IAClC,cAAC,KAAD,CAAkBkL,GAAG,gBAAgByR,eAAe,kBCK3CqH,OAbf,YAAuC,IAAlBF,EAAiB,EAAjBA,OAKnB,OACE,eAAC,GAAD,CAAchH,QALhB,WACEgH,KAIoCxR,SAAS,aAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,uBAAwB,IACnC,cAAC,KAAD,CAAkBkL,GAAG,iBAAiByR,eAAe,mBCI5CsH,OAZf,YAAoC,IAAlBH,EAAiB,EAAjBA,OAKhB,OACE,eAAC,GAAD,CAAchH,QALhB,WACEgH,KAIoCxR,SAAS,UAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,oBADb,IACkC,cAAC,KAAD,CAAkBkL,GAAG,cAAcyR,eAAe,gBCuHzEuH,G,WAhIb,WAAYC,GAAiB,yBAFZA,YAEW,EAC1BhjB,KAAKgjB,OAASA,E,wDAGJ7f,EAAc8f,GACxB,OAAQ9f,GACN,KAAKd,EAAMe,UAET,YADApD,KAAKkjB,mBAAmBD,GAE1B,KAAK5gB,EAAM8gB,QAET,YADAnjB,KAAKojB,iBAAiBH,GAExB,KAAK5gB,EAAM0L,OAET,YADA/N,KAAKqjB,gBAAgBJ,GAEvB,KAAK5gB,EAAMwL,KAET,YADA7N,KAAKsjB,cAAcL,GAErB,KAAK5gB,EAAMkhB,IAET,YADAvjB,KAAKwjB,aAAaP,GAEpB,KAAK5gB,EAAMohB,KAET,YADAzjB,KAAK0jB,cAAcT,GAErB,KAAK5gB,EAAM0K,UAET,YADA/M,KAAK2jB,mBAAmBV,M,yCAKHA,GAAuB,IACxC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OACrBlD,KAAKgjB,OAAOY,KAAKvmB,EAAGC,EAAG2F,EAAOC,K,uCAGP+f,GAAuB,IACtC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OACrBlD,KAAKgjB,OAAOa,QAAQxmB,EAAGC,EAAG2F,EAAOC,K,sCAGX+f,GAAuB,IACrC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OAGrBlD,KAAKgjB,OAAOY,KAAKvmB,EAAGC,EADE,GADD,GACC,IAEtB0C,KAAKgjB,OAAOY,KAAKvmB,EAAGC,EAAG2F,EAAOC,K,oCAGV+f,GAAuB,IACnC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OACf4gB,EAAY,GAClB9jB,KAAKgjB,OAAOe,OAAO1mB,EAAGC,GACtB0C,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAI4F,GAC1BlD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAQ6gB,EAAWxmB,EAAI4F,GAC9ClD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,EAAI4F,EAAS4gB,GAC3C9jB,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,GAC9B0C,KAAKgjB,OAAOiB,YAEZjkB,KAAKgjB,OAAOe,OAAO1mB,EAAI4F,EAAQ6gB,EAAWxmB,EAAI4F,GAC9ClD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,EAAI4F,EAAS4gB,GAC3C9jB,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAQ6gB,EAAWxmB,EAAI4F,EAAS4gB,GACvD9jB,KAAKgjB,OAAOiB,c,mCAGOhB,GAAuB,IAClC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OACfghB,EAAY,GAClBlkB,KAAKgjB,OAAOY,KAAKvmB,EAAGC,EAAG2F,EAAOC,GAE9BlD,KAAKgjB,OAAOe,OAAO1mB,EAAGC,GACtB0C,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,GAC9B0C,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAQihB,EAAW5mB,EAAI4mB,GAC9ClkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI6mB,EAAW5mB,EAAI4mB,GACtClkB,KAAKgjB,OAAOiB,YAEZjkB,KAAKgjB,OAAOe,OAAO1mB,EAAI4F,EAAO3F,GAC9B0C,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,EAAI4F,GAClClD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAQihB,EAAW5mB,EAAI4F,EAASghB,GACvDlkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAQihB,EAAW5mB,EAAI4mB,GAC9ClkB,KAAKgjB,OAAOiB,c,oCAGQhB,GAAuB,IACnC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OACfihB,EAAY,GAClBnkB,KAAKgjB,OAAOe,OAAO1mB,EAAI8mB,EAAW7mB,GAClC0C,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAI6mB,GAC1BnkB,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAI4F,GAC1BlD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,EAAI4F,GAClClD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,GAC9B0C,KAAKgjB,OAAOiB,YAEZjkB,KAAKgjB,OAAOe,OAAO1mB,EAAI8mB,EAAW7mB,GAClC0C,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAI6mB,GAC1BnkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI8mB,EAAW7mB,EAAI6mB,GACtCnkB,KAAKgjB,OAAOiB,c,yCAGahB,GAAuB,IACxC5lB,EAAwB4lB,EAAxB5lB,EAAGC,EAAqB2lB,EAArB3lB,EAAG2F,EAAkBggB,EAAlBhgB,MAAOC,EAAW+f,EAAX/f,OACfkhB,EAAkB,GAClBC,EAAmB,GACnBC,GAAephB,EAASmhB,IAAwB,EAEtDrkB,KAAKgjB,OAAOe,OAAO1mB,EAAGC,GACtB0C,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAIgnB,GAC1BtkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI+mB,GAAqB9mB,EAAIgnB,GAChDtkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI+mB,GAAqB9mB,EAAIgnB,EAAcD,GAC9DrkB,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAIgnB,EAAcD,GACxCrkB,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAIgnB,EAAcD,IACxCrkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI+mB,GAAqB9mB,EAAIgnB,EAAcD,IAC9DrkB,KAAKgjB,OAAOgB,OAAO3mB,EAAI+mB,GAAqB9mB,EAAIgnB,EAAcD,IAC9DrkB,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAIgnB,EAAcD,IACxCrkB,KAAKgjB,OAAOgB,OAAO3mB,EAAGC,EAAI4F,GAC1BlD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,EAAI4F,GAClClD,KAAKgjB,OAAOgB,OAAO3mB,EAAI4F,EAAO3F,GAC9B0C,KAAKgjB,OAAOiB,YAEZjkB,KAAKgjB,OAAOY,KAAKvmB,GAAI+mB,GAAsB9mB,EAAIgnB,EAAaF,EAAiBC,GAC7ErkB,KAAKgjB,OAAOY,KACVvmB,GAAI+mB,GACJ9mB,EAAIgnB,EAAc,GAClBF,EACAC,O,KCzDSE,G,WA3Db,WAAYznB,EAAoB+Z,EAAwBmM,GAAiB,yBALxDlmB,cAKuD,OAJvD+Z,aAIuD,OAHvDmM,YAGuD,OAFvDwB,mBAEuD,EACtExkB,KAAKlD,SAAWA,EAChBkD,KAAK6W,QAAUA,EACf7W,KAAKgjB,OAASA,EACdhjB,KAAKwkB,cAAgB,IAAIzB,GAAcC,G,6DAGxBze,GACfvE,KAAK6W,QAAQtH,KACXhL,EAAW8G,aACX9G,EAAWqE,WAAa,GACxBrE,EAAWsE,YAAc,IAG3B7I,KAAKgjB,OAAOyB,OACZzkB,KAAK0kB,WAAWngB,GAChBvE,KAAK2kB,UAAUpgB,GACfvE,KAAKgjB,OAAO7S,OACZnQ,KAAKgjB,OAAO4B,SACZ5kB,KAAKgjB,OAAO6B,OAEZ7kB,KAAKgjB,OAAO8B,UAAUvgB,EAAWlB,UAAYrE,EAASuF,EAAWjB,SAAWtE,GAd/B,oBAezBuF,EAAWN,eAfc,IAe7C,2BAA8C,SACtC8gB,OAAO/kB,KAAKlD,WAhByB,8BAmB7CkD,KAAKgjB,OAAOgC,UAEZhlB,KAAK6W,QAAQoO,Q,0CAGK1gB,EAAwBlH,EAAWC,GACrD0C,KAAKgjB,OAAOyB,OACZzkB,KAAK2kB,UAAUpgB,GACf,IACM2gB,EADYllB,KAAKgjB,OAAOmC,eACH5nB,eAAe,CAAEF,IAAGC,MACzCwD,EAASd,KAAKgjB,OAAOoC,cAAcF,EAAS7nB,EAAG6nB,EAAS5nB,GAG9D,OAFA0C,KAAKgjB,OAAOgC,UAELlkB,I,iCAGUyD,GACjB,IAAMiS,EAAaxW,KAAK6W,QAAQwO,qBAChCrlB,KAAKgjB,OAAOsC,UAAY9O,EAAW+O,SAAS,aAAc,KAC1DvlB,KAAKgjB,OAAOwC,YAAchP,EAAWiP,SAAS,SAAU1T,GAAMsC,MAC9D,IAAIlE,EAAOqG,EAAWiP,SAAS,OAAQ1T,GAAM4B,OACzCpP,EAAWmhB,cACbvV,EAAOA,EAAKwV,IAAI5T,GAAMkC,KAAM,MAE9BjU,KAAKgjB,OAAO4C,UAAYzV,I,gCAGR5L,GAChBvE,KAAKgjB,OAAO6C,YACZ7lB,KAAKwkB,cAAcsB,YAAYvhB,EAAWpB,MAAOoB,EAAWwhB,oB,KCLjDC,OA7Df,SACEhD,EACAla,GAyBA,IAvBA,IAiBImd,EACAC,EACAC,EACAC,EACAC,EAAwBC,EArBtBC,EAAMzd,EAAa/D,KACnByhB,EAAM1d,EAAa7D,GACnBwhB,EAAKF,EAAIG,WAAW5d,EAAa9D,YACjC2hB,EAAKJ,EAAIK,WAAW9d,EAAa9D,YACjC6hB,EAAKL,EAAIE,WAAW5d,EAAa5D,UACjC4hB,EAAKN,EAAII,WAAW9d,EAAa5D,UAGjC6hB,EAAKlW,KAAKmW,IAAIH,EAAKJ,GACnBQ,EAAKpW,KAAKmW,IAAIF,EAAKH,GAGnBO,EAAKL,EAAKJ,EAAK,GAAK,EACpBU,EAAKL,EAAKH,EAAK,GAAK,EAEtBS,GAAQ,EACRC,GAAQ,EAOHhqB,EAAIopB,EAAInpB,EAAIqpB,EAAIjoB,EAAIqoB,EAAKE,GAAI5pB,IAAMwpB,GAAMvpB,IAAMwpB,KAClDM,IAAUpE,EAAOsE,oBAAoBf,EAAKlpB,EAAGC,KAC/C2oB,EAAM5oB,EACN8oB,EAAM7oB,EACN8pB,GAAQ,IAELC,GAASrE,EAAOsE,oBAAoBd,EAAKnpB,EAAGC,KAC/C4oB,EAAMG,GAAMhpB,EACZ+oB,EAAME,GAAMhpB,EACZ+pB,GAAQ,GAELD,IAASC,IAX8C,CAc5DhB,EAAKhpB,EACLipB,EAAKhpB,EACL,IAAMiqB,EAAK,EAAI7oB,EACX6oB,GAAMN,IACRvoB,GAAKuoB,EACL5pB,GAAK6pB,GAEHK,EAAKR,IACProB,GAAKqoB,EACLzpB,GAAK6pB,GAIT,YAAYjjB,IAAR+hB,QAA6B/hB,IAARiiB,QAA6BjiB,IAARgiB,QAA6BhiB,IAARkiB,EAC1D,CAACK,EAAIE,EAAIE,EAAIC,GAGf,CAACb,EAAKE,EAAKD,EAAKE,ICgFVoB,G,WAnIb,WAAY1qB,EAAoBkmB,GAAiB,yBAHhClmB,cAG+B,OAF/BkmB,YAE+B,EAC9ChjB,KAAKlD,SAAWA,EAChBkD,KAAKgjB,OAASA,E,+DAGGla,GAAmC,IAAD,EAC1Bkd,GAAmBhmB,KAAKlD,SAAUgM,GADR,mBAC5C2d,EAD4C,KACxCE,EADwC,KACpCE,EADoC,KAChCC,EADgC,KAE7CW,EAAQ5W,KAAK6W,MAAMZ,EAAKH,EAAIE,EAAKJ,GAEvCzmB,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOe,OAAO0C,EAAIE,GACvB3mB,KAAKgjB,OAAOgB,OAAO6C,EAAIC,GACvB9mB,KAAK2nB,uBAAuB7e,GAC5B9I,KAAKgjB,OAAO4B,SACZ5kB,KAAK4nB,YAAY9e,EAAc2e,EAAOhB,EAAIE,GAC1C3mB,KAAK6nB,UAAU/e,EAAc2e,EAAOZ,EAAIC,GACxC9mB,KAAKgjB,OAAOgC,Y,6CAGiBlc,GAI7B,OAHA9I,KAAKgjB,OAAOsC,UAAY,IACxBtlB,KAAKgjB,OAAOwC,YAAczT,GAAMsC,KAChCrU,KAAKgjB,OAAO4C,UAAY7T,GAAM4B,MACtB7K,EAAaxD,aACnB,KAAKvC,EAAYwC,MACfvF,KAAKgjB,OAAO8E,YAAY,IACxB,MACF,KAAK/kB,EAAY4J,KACf3M,KAAKgjB,OAAO8E,YAAY,CAAC,EAAG,IAC5B,MACF,KAAK/kB,EAAYglB,aACf/nB,KAAKgjB,OAAO8E,YAAY,CAAC,EAAG,IAC5B,MACF,KAAK/kB,EAAYilB,aACfhoB,KAAKgjB,OAAO8E,YAAY,CAAC,GAAI,KAC7B,MACF,KAAK/kB,EAAYsK,aACfrN,KAAKgjB,OAAO8E,YAAY,CAAC,GAAI,O,kCAKfhf,EAA4B2e,EAAepqB,EAAWC,GACxE0C,KAAKioB,QAAQnf,EAAa3D,QAAS9H,EAAGC,EAAGmqB,EAAQ5W,KAAKqX,M,gCAGtCpf,EAA4B2e,EAAepqB,EAAWC,GACtE0C,KAAKioB,QAAQnf,EAAazD,MAAOhI,EAAGC,EAAGmqB,K,8BAGzBU,EAAU9qB,EAAWC,EAAWmqB,GAC1CU,IAAQtjB,EAAIO,OACdpF,KAAKgjB,OAAO8E,YAAY,IACxB9nB,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO8B,UAAUznB,EAAGC,GACzB0C,KAAKgjB,OAAOoF,OAAOX,GACnBznB,KAAKqoB,YAAYF,GACjBnoB,KAAKgjB,OAAOgC,a,kCAIImD,GAClB,OAAQA,GACN,KAAKtjB,EAAIuI,MACPpN,KAAKsoB,YACL,MACF,KAAKzjB,EAAI4I,SACPzN,KAAKuoB,eACL,MACF,KAAK1jB,EAAI2jB,gBACPxoB,KAAKgjB,OAAO4C,UAAY5lB,KAAKgjB,OAAOwC,YACpCxlB,KAAKuoB,eACL,MACF,KAAK1jB,EAAI6H,QACP1M,KAAKyoB,cACL,MACF,KAAK5jB,EAAIoI,eACPjN,KAAKgjB,OAAO4C,UAAY5lB,KAAKgjB,OAAOwC,YACpCxlB,KAAKyoB,cACL,MACF,KAAK5jB,EAAI6jB,OACP1oB,KAAK2oB,aACL,MACF,KAAK9jB,EAAI+jB,cACP5oB,KAAKgjB,OAAO4C,UAAY5lB,KAAKgjB,OAAOwC,YACpCxlB,KAAK2oB,gB,kCAMT3oB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOe,OAAO,EAAG,GACtB/jB,KAAKgjB,OAAOgB,QAAQ,GAAI,GACxBhkB,KAAKgjB,OAAOe,OAAO,EAAG,GACtB/jB,KAAKgjB,OAAOgB,QAAQ,IAAK,GACzBhkB,KAAKgjB,OAAOiB,YACZjkB,KAAKgjB,OAAO4B,W,qCAIZ5kB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOe,OAAO,EAAG,GACtB/jB,KAAKgjB,OAAOgB,QAAQ,GAAI,IACxBhkB,KAAKgjB,OAAOgB,QAAQ,IAAK,IACzBhkB,KAAKgjB,OAAOiB,YACZjkB,KAAKgjB,OAAO7S,OACZnQ,KAAKgjB,OAAO4B,W,oCAIZ5kB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOe,OAAO,EAAG,GACtB/jB,KAAKgjB,OAAOgB,QAAQ,GAAI,GACxBhkB,KAAKgjB,OAAOgB,QAAQ,GAAI,GACxBhkB,KAAKgjB,OAAOgB,QAAQ,IAAK,GACzBhkB,KAAKgjB,OAAOiB,YACZjkB,KAAKgjB,OAAO7S,OACZnQ,KAAKgjB,OAAO4B,W,mCAIZ5kB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOa,SAAS,IAAK,GAAI,GAAI,IAClC7jB,KAAKgjB,OAAOiB,YACZjkB,KAAKgjB,OAAO7S,OACZnQ,KAAKgjB,OAAO4B,a,KC1HDiE,GAPb,WAAYxrB,EAAWC,EAAW6D,GAAiB,yBAJ1C9D,OAIyC,OAHzCC,OAGyC,OAFzC6D,YAEyC,EAChDnB,KAAK3C,EAAIA,EACT2C,KAAK1C,EAAIA,EACT0C,KAAKmB,OAASA,GCiJH2nB,G,WArJb,WAAYC,GAAgC,yBAF3BA,SAE0B,EACzC/oB,KAAK+oB,IAAMA,E,wDA2DDC,GACVhpB,KAAK+oB,IAAIjB,YAAYkB,K,6BAIrBhpB,KAAK+oB,IAAItE,S,gCAITzkB,KAAK+oB,IAAI/D,Y,gCAGD3nB,EAAWC,GACnB0C,KAAK+oB,IAAIjE,UAAUznB,EAAGC,K,6BAGjBmqB,GACLznB,KAAK+oB,IAAIX,OAAOX,K,kCAIhBznB,KAAK+oB,IAAIlD,c,2BAGNxoB,EAAWC,EAAW2F,EAAeC,GACxClD,KAAK+oB,IAAInF,KAAKvmB,EAAGC,EAAG2F,EAAOC,K,8BAGrB7F,EAAWC,EAAW2F,EAAeC,GAC3C,IAAM+lB,EAAUhmB,EAAQ,EAClBimB,EAAUhmB,EAAS,EACzBlD,KAAK+oB,IAAIlF,QAAQxmB,EAAI4rB,EAAS3rB,EAAI4rB,EAASD,EAASC,EAAS,EAAG,EAAa,EAAVrY,KAAKqX,M,6BAGnE7qB,EAAWC,GAChB0C,KAAK+oB,IAAIhF,OAAO1mB,EAAGC,K,6BAGdD,EAAWC,GAChB0C,KAAK+oB,IAAI/E,OAAO3mB,EAAGC,K,oCAGPD,EAAWC,GACvB,OAAO0C,KAAK+oB,IAAI3D,cAAc/nB,EAAGC,K,kCAIjC0C,KAAK+oB,IAAI9E,c,qCAIT,OAAOjkB,KAAK+oB,IAAI5D,iB,6BAIhBnlB,KAAK+oB,IAAI5Y,S,+BAITnQ,KAAK+oB,IAAInE,W,6BAIT5kB,KAAK+oB,IAAIlE,S,+BAGF/e,EAAc3E,EAAoC9D,EAAWC,GACpE,IAAM6rB,EAAUnpB,KAAK+oB,IAAIK,YAAYtjB,GAC/BujB,EAAU/rB,EAAI6rB,EAAQG,sBACxBC,EAAUlsB,EACC,WAAX8D,EACFooB,GAAoBJ,EAAQlmB,MAAQ,EAChB,QAAX9B,IACTooB,GAAoBJ,EAAQlmB,OAE9BjD,KAAK+oB,IAAIS,SAAS1jB,EAAMyjB,EAASF,K,uCAGV3U,GACvB,OAAO1U,KAAK+oB,IAAIU,KAAK7oB,MAAM,IAAK,GAAG8T,K,0CAGTA,EAAe1T,GACzC,IAAM0oB,EAAQ1pB,KAAK+oB,IAAIU,KAAK7oB,MAAM,IAAK,GACvC8oB,EAAMhV,GAAS1T,EACfhB,KAAK+oB,IAAIU,KAAOC,EAAMhpB,KAAK,O,gCA5I3B,OAAOqR,GAAMkB,cAAchI,OAAOjL,KAAK+oB,IAAIY,a,aAG/BlR,GACZzY,KAAK+oB,IAAIY,UAAYlR,EAAMuH,gB,kCAI3B,OAAOjO,GAAMkB,cAAchI,OAAOjL,KAAK+oB,IAAIa,e,aAG7BnR,GACdzY,KAAK+oB,IAAIa,YAAcnR,EAAMuH,gB,gCAI7B,OAAOhgB,KAAK+oB,IAAIzD,W,aAGJriB,GACZjD,KAAK+oB,IAAIzD,UAAYriB,I,gCAIrB,OAAOjD,KAAK6pB,iBAAiB,I,aAGjBC,GACZ9pB,KAAK+pB,oBAAoB,EAAGD,K,iCAI5B,OAAO9pB,KAAK6pB,iBAAiB,I,aAGhBG,GACbhqB,KAAK+pB,oBAAoB,EAAGC,K,+BAI5B,OAAOhqB,KAAK6pB,iBAAiB,I,aAGlBI,GACXjqB,KAAK+pB,oBAAoB,EAAGE,K,iCAI5B,OAAOjqB,KAAK6pB,iBAAiB,I,aAGhBK,GACblqB,KAAK+pB,oBAAoB,EAAGG,O,KCnBjBC,G,WApCb,WAAYC,EAAqBC,EAAsBvqB,GAAe,yBALrDmD,WAKoD,OAJpDC,YAIoD,OAHpD2T,aAGoD,OAFpD/W,WAEoD,EACnEE,KAAKiD,MAAQ,CAACmnB,GACdpqB,KAAKkD,OAAS,CAACmnB,GACfrqB,KAAK6W,QAAU,GACf7W,KAAKF,MAAQA,E,iDAGVjB,EAAcoE,EAAgBC,GACjClD,KAAK6W,QAAQyT,QAAQzrB,GACrBmB,KAAKiD,MAAMqnB,QAAX,OAAmBrnB,QAAnB,IAAmBA,IAASjD,KAAK4I,YACjC5I,KAAKkD,OAAOonB,QAAZ,OAAoBpnB,QAApB,IAAoBA,IAAUlD,KAAK6I,e,4BAInC7I,KAAK6W,QAAQ0T,QACbvqB,KAAKiD,MAAMsnB,QACXvqB,KAAKkD,OAAOqnB,U,gCAIZ,OAAOvqB,KAAK6W,QAAQ,K,iCAIpB,OAAO7W,KAAKiD,MAAM,K,kCAIlB,OAAOjD,KAAKkD,OAAO,K,2CAInB,OAAOlD,KAAKF,MAAMuX,cAAc,YAAIrX,KAAK6W,SAAS/T,e,KCwLvC0nB,G,WAlMb,WAAYxH,EAA2BljB,EAAc2qB,GAAyB,yBAT7D5T,aAS4D,OAR5DmM,YAQ4D,OAP5D0H,wBAO4D,OAN5DC,0BAM4D,OAL5DlR,UAK4D,OAJ5DmR,gBAI4D,OAH5DC,gBAG4D,OAF5DjR,UAE4D,EAC3E5Z,KAAK6W,QAAU,IAAIsT,GAAcnH,EAAO/f,MAAO+f,EAAO9f,OAAQpD,GAC9DE,KAAKyZ,KAAOgR,EAAQhR,KACpBzZ,KAAK4qB,WAAaH,EAAQG,WAC1B5qB,KAAK6qB,WAAaJ,EAAQI,WAC1B7qB,KAAK4Z,KAAO6Q,EAAQ7Q,KACpB5Z,KAAKgjB,OAASA,EAAO8H,WAAW,MAChC,IAAMC,EAAc,IAAIjC,GAAY9oB,KAAKgjB,QACzChjB,KAAK0qB,mBAAqB,IAAInG,GAAyBvkB,KAAMA,KAAK6W,QAASkU,GAC3E/qB,KAAK2qB,qBAAuB,IAAInD,GAA2BxnB,KAAM+qB,G,2DAGpD1tB,EAAWC,GACxB,MAAO,CACLD,GAAIA,EAAI2C,KAAK4qB,YAAc5qB,KAAK4Z,KAChCtc,GAAIA,EAAI0C,KAAK6qB,YAAc7qB,KAAK4Z,Q,8BAKlC5Z,KAAKgjB,OAAOgI,UAAU,EAAG,EAAGhrB,KAAK6W,QAAQjO,WAAY5I,KAAK6W,QAAQhO,aAC9D7I,KAAKyZ,MACPzZ,KAAKirB,e,mCAKP,IAAM1nB,GAAQvD,KAAK4qB,WACblmB,EAAQ1E,KAAK6W,QAAQjO,WAAa5I,KAAK4qB,WACvCpnB,GAAOxD,KAAK6qB,WACZpmB,EAASzE,KAAK6W,QAAQhO,YAAc7I,KAAK6qB,WAEzCK,ExF5DU,GwF4DUlrB,KAAK4Z,KAEzBuR,EAAOnrB,KAAKorB,QAAQ7nB,EAAM2nB,GAC1BG,EAAOrrB,KAAKsrB,OAAO5mB,EAAOwmB,GAC1BK,EAAOvrB,KAAKorB,QAAQ5nB,EAAK0nB,GACzBM,EAAOxrB,KAAKsrB,OAAO7mB,EAAQymB,GAEjClrB,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO8B,UAAU9kB,KAAK4qB,WAAY5qB,KAAK6qB,YAC5C7qB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAO4G,YAAc,YAC1B,IAAK,IAAIvsB,EAAI8tB,EAAM9tB,EAAIguB,EAAMhuB,GAAK6tB,EAChClrB,KAAKgjB,OAAOe,OAAO1mB,EAAGmG,GACtBxD,KAAKgjB,OAAOgB,OAAO3mB,EAAGoH,GAExB,IAAK,IAAInH,EAAIiuB,EAAMjuB,EAAIkuB,EAAMluB,GAAK4tB,EAChClrB,KAAKgjB,OAAOe,OAAOxgB,EAAMjG,GACzB0C,KAAKgjB,OAAOgB,OAAOtf,EAAOpH,GAE5B0C,KAAKgjB,OAAO4B,SACZ5kB,KAAKgjB,OAAOgC,Y,8BAGEtM,EAAgB+S,GAC9B,OAAO5a,KAAK6a,MAAMhT,EAAS+S,GAAMA,I,6BAGpB/S,EAAgB+S,GAC7B,OAAO5a,KAAK8a,KAAKjT,EAAS+S,GAAMA,I,oCAGpB9kB,GACZ3G,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO8B,UAAU9kB,KAAK4qB,WAAY5qB,KAAK6qB,YAC5C7qB,KAAKgjB,OAAO4I,MAAM5rB,KAAK4Z,KAAM5Z,KAAK4Z,MAHE,oBAIhBjT,EAAQ1C,eAJQ,IAIpC,2BAA2C,SACnC8gB,OAAO/kB,OALqB,8BAOpCA,KAAK6rB,cAAcllB,GACnB3G,KAAKgjB,OAAOgC,Y,uCAGGzgB,GACfvE,KAAK0qB,mBAAmBjnB,iBAAiBc,K,0CAGvBA,EAAwBlH,EAAWC,GACrD,OAAO0C,KAAK0qB,mBAAmBpD,oBAAoB/iB,EAAYlH,EAAGC,K,yCAGjDwL,GACjB9I,KAAK2qB,qBAAqBnlB,mBAAmBsD,K,iCAGpChD,GACT9F,KAAK6W,QAAQtH,KAAK,QAClBvP,KAAK8rB,SAAShmB,EAAKA,KAAM,OAAQ,QACjC9F,KAAKgjB,OAAO8B,UAAU,EAAG,IACzB9kB,KAAK6W,QAAQoO,Q,kCAGHtlB,GACVK,KAAK6W,QAAQtH,KAAK,SAClBvP,KAAK8rB,SAASnsB,EAAMmG,KAAM,OAAQ,UAClC9F,KAAKgjB,OAAO8B,UAAU,EAAG,IACzB9kB,KAAK6W,QAAQoO,Q,sCAGC8G,GACd/rB,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOe,QAAO,GAAU/kB,GAC7BgB,KAAKgjB,OAAOgB,OAAOhkB,KAAK6W,QAAQjO,WAAa5J,EAASA,GACtDgB,KAAKgjB,OAAOsC,UAAY,IACxBtlB,KAAKgjB,OAAO4G,YAAc,UAC1B5pB,KAAKgjB,OAAO4B,SACZ5kB,KAAKgjB,OAAOgC,UACZhlB,KAAKgjB,OAAO8B,UAAU,EAAG,M,uCAGVkH,GACf,IAAMC,EAAcjsB,KAAK6W,QAAQqV,UACjClsB,KAAK6W,QAAQtH,KAAK,cAClBvP,KAAK8rB,SAAL,cAAkBG,EAAlB,QAAkC,OAAQ,UAC1CjsB,KAAKgjB,OAAO8B,UAAU,EAAG,IACzB9kB,KAAK6W,QAAQoO,Q,+BAGEnf,EAAcia,EAAcoM,GAC3C,IAAM3V,EAAaxW,KAAK6W,QAAQwO,qBAC1B+G,EAAS5V,EAAW6V,UAAU,cAAe,UAC7CvsB,EAAQ0W,EAAW6V,UAAU,aAAc,UAC3CC,EAAS9V,EAAW6V,UAAU,cAAe,2CAEnDrsB,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOyG,KAAZ,UAAsB3pB,EAAtB,YAA+BssB,EAA/B,YAAyCrM,EAAzC,YAAiDuM,GACjDtsB,KAAKgjB,OAAO2G,UAAYnT,EAAWiP,SAAS,QAAS1T,GAAMsC,MAAM2L,cACjE,IAAMmJ,EAAUnpB,KAAKgjB,OAAOoG,YAAYtjB,GAClCzI,EAAc,WAAV8uB,GAAsBnsB,KAAK6W,QAAQjO,WAAaugB,EAAQlmB,OAAS,EAAI,EAC/EjD,KAAKgjB,OAAOwG,SAAS1jB,EAAMzI,EAAG8rB,EAAQG,uBACtCtpB,KAAKgjB,OAAOgC,Y,oCAGQre,GACpB3G,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO2G,UAAY,QACxB3pB,KAAKgjB,OAAO4G,YAAc,QAC1B5pB,KAAKgjB,OAAOsC,UAAY,EAJoB,oBAMrBtlB,KAAKusB,WAAW5lB,IANK,IAM5C,2BAAiD,CAAC,IAAD,UAApCtJ,EAAoC,EAApCA,EAAGC,EAAiC,EAAjCA,EACd0C,KAAKwsB,oBAAoBnvB,EAAGC,IAPc,8BAU5C0C,KAAKgjB,OAAOgC,Y,6CAGMre,G,yFACEA,EAAQ1C,e,8DAAjBtB,E,mBACYK,GAAcL,EAAMie,c,gBACvC,uBAAO5gB,KAAKysB,qBAAqB9pB,GAAjC,Q,+OAKsBtF,EAAWC,GACrC0C,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOY,KAAKvmB,EAAI6B,EAAe5B,EAAI4B,EAAeA,EAAmBA,GAC1Ec,KAAKgjB,OAAO7S,OACZnQ,KAAKgjB,OAAO4B,W,yCAGKje,EAAkBtJ,EAAWC,GAAgC,IAAD,gBACxD0C,KAAKusB,WAAW5lB,IADwC,IAC7E,2BAA+C,CAAC,IAArC+lB,EAAoC,QAC7C,GAAI1sB,KAAK2sB,gBAAgBD,EAAQrvB,EAAGC,GAClC,OAAOovB,GAHkE,iC,sCASvDA,EAAgBrvB,EAAWC,GACjD,OAAOuT,KAAKmW,IAAI3pB,EAAIqvB,EAAOrvB,IAAM6B,GAAiB2R,KAAKmW,IAAI1pB,EAAIovB,EAAOpvB,IAAM4B,I,uDAGhDqF,G,6EAM5B,OALMkiB,EAAKliB,EAAWlB,UAChBwjB,EAAKtiB,EAAWJ,WAChBwiB,EAAKpiB,EAAWjB,SAChBwjB,EAAKviB,EAAWH,Y,SAEhB,IAAIykB,GAAOpC,EAAIE,EAAI5nB,EAAO6tB,I,OAChC,O,SAAM,IAAI/D,GAAOtkB,EAAWsoB,aAAclG,EAAI5nB,EAAOyC,G,OACrD,O,UAAM,IAAIqnB,GAAOhC,EAAIF,EAAI5nB,EAAO+tB,I,QAChC,O,UAAM,IAAIjE,GAAOpC,EAAIliB,EAAWwoB,aAAchuB,EAAOiD,G,QACrD,O,UAAM,IAAI6mB,GAAOhC,EAAItiB,EAAWwoB,aAAchuB,EAAOgD,G,QACrD,O,UAAM,IAAI8mB,GAAOpC,EAAIK,EAAI/nB,EAAOiuB,I,QAChC,O,UAAM,IAAInE,GAAOtkB,EAAWsoB,aAAc/F,EAAI/nB,EAAO0C,G,QACrD,O,UAAM,IAAIonB,GAAOhC,EAAIC,EAAI/nB,EAAOkuB,I,mDCxDrBC,G,WAjJb,WAAYC,GAAwB,yBAfpCvH,UAAY7T,GAAM4B,MAeiB,KAdnC6R,YAAczT,GAAMsC,KAce,KAbnCiR,UAAY,EAauB,KAZnC4E,WAAa,YAYsB,KAXnCD,SAAW,OAWwB,KAVnCH,UAAY,SAUuB,KATnCE,WAAa,SASsB,KARlBjsB,cAQkB,OAPlBqvB,WAOkB,OANlBC,MAAsB,GAMJ,KALlBC,MAAsB,GAKJ,KAJlBC,OAAsB,CAAC,IAAIC,WAIT,KAH3BC,UAG2B,OAF3BzE,KAAiB,GAGvBhpB,KAAKjC,SAAWovB,EAAUjjB,cAC1BlK,KAAKotB,MAAQ,CAACD,G,wDAGJnE,GACVhpB,KAAKgpB,KAAOA,I,6BAIZhpB,KAAKstB,MAAM/d,KAAKvP,KAAK0tB,gBACrB1tB,KAAKutB,OAAOhe,KAAK,IAAIie,UAAUxtB,KAAK2tB,gBAAgB5c,e,sCAIpD,OAAO/Q,KAAKutB,OAAOvtB,KAAKutB,OAAOzuB,OAAS,K,gCAIxC,IAAMwuB,EAAQttB,KAAKstB,MAAMrI,MACzBjlB,KAAKotB,MAAMQ,OAAO5tB,KAAKotB,MAAMzS,QAAQ2S,GAAS,GAC9CttB,KAAKutB,OAAOtI,Q,gCAGJ5nB,EAAWC,GACnB,IAAMuwB,EAAM7tB,KAAK8tB,UAAU,KAC3BD,EAAIhjB,aAAa,YAAjB,oBAA2CxN,EAA3C,YAAgDC,EAAhD,MACA0C,KAAK0tB,eAAeK,OAAOF,GAE3B7tB,KAAKotB,MAAM7d,KAAKse,GAChB7tB,KAAK2tB,gBAAgB7I,UAAUznB,EAAGC,K,6BAG7BmqB,GACL,IAAMoG,EAAM7tB,KAAK8tB,UAAU,KAC3BD,EAAIhjB,aAAa,YAAjB,iBAAwC7K,KAAKguB,iBAAiBvG,GAA9D,MACAznB,KAAK0tB,eAAeK,OAAOF,GAE3B7tB,KAAKotB,MAAM7d,KAAKse,GAChB7tB,KAAK2tB,gBAAgBvF,OAAOX,K,kCAI5BznB,KAAKqtB,MAAMO,OAAO,K,2BAGfvwB,EAAWC,EAAW2F,EAAeC,GACxC,IAAM0gB,EAAO5jB,KAAK8tB,UAAU,QAC5BlK,EAAK/Y,aAAa,IAAKI,OAAO5N,IAC9BumB,EAAK/Y,aAAa,IAAKI,OAAO3N,IAC9BsmB,EAAK/Y,aAAa,QAASI,OAAOhI,IAClC2gB,EAAK/Y,aAAa,SAAUI,OAAO/H,IACnClD,KAAKqtB,MAAM9d,KAAKqU,K,8BAGVvmB,EAAWC,EAAW2F,EAAeC,GAC3C,IAAM2gB,EAAU7jB,KAAK8tB,UAAU,WACzB7E,EAAUhmB,EAAQ,EAClBimB,EAAUhmB,EAAS,EACzB2gB,EAAQhZ,aAAa,KAAMI,OAAO5N,EAAI4rB,IACtCpF,EAAQhZ,aAAa,KAAMI,OAAO3N,EAAI4rB,IACtCrF,EAAQhZ,aAAa,KAAMI,OAAOge,IAClCpF,EAAQhZ,aAAa,KAAMI,OAAOie,IAClClpB,KAAKqtB,MAAM9d,KAAKsU,K,6BAGXxmB,EAAWC,GAChB0C,KAAKytB,KAAOztB,KAAK8tB,UAAU,QAC3B9tB,KAAKytB,KAAK5iB,aAAa,IAAvB,WAAgCxN,EAAhC,YAAqCC,IACrC0C,KAAKqtB,MAAM9d,KAAKvP,KAAKytB,Q,6BAGhBpwB,EAAWC,GAChB,IAAMiP,EAAOvM,KAAKytB,KAAMzjB,aAAa,KACrChK,KAAKytB,KAAM5iB,aAAa,IAAxB,UAAgC0B,EAAhC,aAAyClP,EAAzC,YAA8CC,M,kCAI9C,IAAMiP,EAAOvM,KAAKytB,KAAMzjB,aAAa,KACrChK,KAAKytB,KAAM5iB,aAAa,IAAxB,UAAgC0B,EAAhC,S,qCAIA,OAAOvM,KAAK2tB,kB,oCAGAtwB,EAAWC,GACvB,OAAO,I,6BAIP0C,KAAKiuB,cADM,oBAEQjuB,KAAKqtB,OAFb,IAEX,2BAA+B,SACxBxiB,aAAa,OAAQ7K,KAAK4lB,UAAU5F,gBAHhC,iC,+BAQXhgB,KAAKiuB,cADQ,oBAEMjuB,KAAKqtB,OAFX,IAEb,2BAA+B,CAAC,IAArBI,EAAoB,QAC7BA,EAAK5iB,aAAa,SAAU7K,KAAKwlB,YAAYxF,eAC7CyN,EAAK5iB,aAAa,eAAgBI,OAAOjL,KAAKslB,YAC9CmI,EAAK5iB,aAAa,mBAAoB7K,KAAKgpB,KAAKtoB,KAAK,OAL1C,iC,+DAWNoF,EAAc3E,EAAoC9D,EAAWC,GACpE,IAAM4wB,EAASluB,KAAK8tB,UAAU,QAC9BI,EAAOrjB,aAAa,IAAKI,OAAO5N,IAChC6wB,EAAOrjB,aAAa,IAAKI,OAAO3N,EAAI,KACpC4wB,EAAOrjB,aAAa,cAAe1J,GACnC+sB,EAAOrjB,aAAa,cAAe7K,KAAKkqB,YACxCgE,EAAOrjB,aAAa,YAAa7K,KAAKiqB,UACtCiE,EAAOrjB,aAAa,aAAc7K,KAAK8pB,WACvCoE,EAAOrjB,aAAa,cAAe7K,KAAKgqB,YACxCkE,EAAO3iB,YAAYvL,KAAKjC,SAASyO,eAAexM,KAAKmuB,WAAWroB,KAChE9F,KAAKqtB,MAAM9d,KAAK2e,GAChBluB,KAAKmQ,S,iCAGYrK,GACjB,IACMgK,GADc,IAAIf,aACIG,OAAOpJ,GACnC,OAAOmF,OAAO4D,aAAP,MAAA5D,OAAM,YAAiB6E,M,oCAGH,IAAD,GAC1B,EAAA9P,KAAK0tB,gBAAeK,OAApB,oBAA8B/tB,KAAKqtB,U,qCAInC,OAAOrtB,KAAKotB,MAAMptB,KAAKotB,MAAMtuB,OAAS,K,gCAGgBrB,GACtD,OAAOuC,KAAKjC,SAASqwB,gBAAgB,6BAA8B3wB,K,uCAG5CgqB,GACvB,OAAQ,IAAMA,EAAS5W,KAAKqX,O,KC5DjBmG,G,WA3Eb,WAAYR,EAAoB/tB,GAAe,yBAL9B+W,aAK6B,OAJ7BmM,YAI6B,OAH7B0H,wBAG6B,OAF7BC,0BAE6B,EAC5C3qB,KAAK6W,QAAU,IAAIsT,GAAc0D,EAAI5qB,MAAMqrB,QAAQttB,MAAO6sB,EAAI3qB,OAAOorB,QAAQttB,MAAOlB,GACpFE,KAAKgjB,OAAS,IAAIkK,GAAUW,GAC5B7tB,KAAK0qB,mBAAqB,IAAInG,GAAyBvkB,KAAMA,KAAK6W,QAAS7W,KAAKgjB,QAChFhjB,KAAK2qB,qBAAuB,IAAInD,GAA2BxnB,KAAMA,KAAKgjB,Q,0DAG1Drc,GAAyB,IAAD,gBAChBA,EAAQ1C,eADQ,IACpC,2BAA2C,SACnC8gB,OAAO/kB,OAFqB,iC,uCAMrBuE,GACfvE,KAAK0qB,mBAAmBjnB,iBAAiBc,K,0CAGvBA,EAAwBlH,EAAWC,GACrD,OAAO0C,KAAK0qB,mBAAmBpD,oBAAoB/iB,EAAYlH,EAAGC,K,yCAGjDwL,GACjB9I,KAAK2qB,qBAAqBnlB,mBAAmBsD,K,iCAGpChD,GACT9F,KAAK6W,QAAQtH,KAAK,QAClBvP,KAAK8rB,SAAShmB,EAAKA,KAAM,OAAQ,SACjC9F,KAAKgjB,OAAO8B,UAAU,EAAG,IACzB9kB,KAAK6W,QAAQoO,Q,kCAGHtlB,GACVK,KAAK6W,QAAQtH,KAAK,SAClBvP,KAAK8rB,SAASnsB,EAAMmG,KAAM,OAAQ,UAClC9F,KAAKgjB,OAAO8B,UAAU,EAAG,IACzB9kB,KAAK6W,QAAQoO,Q,uCAGE+G,GACf,IAAMC,EAAcjsB,KAAK6W,QAAQqV,UACjClsB,KAAK6W,QAAQtH,KAAK,cAClBvP,KAAK8rB,SAAL,cAAkBG,EAAlB,QAAkC,OAAQ,UAC1CjsB,KAAKgjB,OAAO8B,UAAU,EAAG,IACzB9kB,KAAK6W,QAAQoO,Q,sCAGC8G,GACd/rB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAOe,QAAO,GAAU/kB,GAC7BgB,KAAKgjB,OAAOgB,OAAOhkB,KAAK6W,QAAQjO,WAAa5J,EAASA,GACtDgB,KAAKgjB,OAAOsC,UAAY,IACxBtlB,KAAKgjB,OAAOwC,YAAczT,GAAMsC,KAChCrU,KAAKgjB,OAAO4B,SACZ5kB,KAAKgjB,OAAO8B,UAAU,EAAG,M,+BAGVhf,EAAcia,EAAcoM,GAC3C,IAAM3V,EAAaxW,KAAK6W,QAAQwO,qBAChCrlB,KAAKgjB,OAAOgH,WAAaxT,EAAW6V,UAAU,cAAe,UAC7DrsB,KAAKgjB,OAAO8G,UAAYtT,EAAW6V,UAAU,aAAc,UAC3DrsB,KAAKgjB,OAAOiH,SAAWzT,EAAW6V,UAAU,YAAatM,GACzD/f,KAAKgjB,OAAOkH,WAAa1T,EAAW6V,UAClC,cACA,2CAEFrsB,KAAKgjB,OAAOyB,OACZzkB,KAAKgjB,OAAO6C,YACZ7lB,KAAKgjB,OAAO4C,UAAYpP,EAAWiP,SAAS,QAAS1T,GAAMsC,MAC3D,IAAMhX,EAAc,WAAV8uB,EAAqBnsB,KAAK6W,QAAQjO,WAAa,EAAI,EAC7D5I,KAAKgjB,OAAOwG,SAAS1jB,EAAMqmB,EAAO9uB,EAAG,GACrC2C,KAAKgjB,OAAOgC,c,KC7DDuJ,OAzBf,YAAqC,IAAhB9uB,EAAe,EAAfA,KAkBnB,OACE,eAAC,GAAD,CAAckc,QAlBhB,WACE,IAAMqH,EAASjlB,SAASC,cAAc,UACtCglB,EAAO/f,MAAQxD,EAAKG,MAAMgJ,WAAa,GACvCoa,EAAO9f,OAASzD,EAAKG,MAAMiJ,YAAc,GAExB,IAAI2hB,GAAexH,EAAQvjB,EAAKK,MAAO,CACtD2Z,MAAM,EACNmR,WAAY3rB,EAASQ,EAAKG,MAAMyD,UAChCwnB,WAAY5rB,EAASQ,EAAKG,MAAM0D,SAChCsW,KAAM,IAEC9V,cAAcrE,EAAKG,OAE5B,IAAM/B,EAAUmlB,EAAOwL,UAAU,aACjC7wB,EAAa,GAAD,OAAIH,EAAiBiC,EAAKE,OAA1B,QAAwC9B,IAIhBsT,SAAS,SAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,UADb,IACwB,cAAC,KAAD,CAAkBkL,GAAG,aAAayR,eAAe,mBCS9DiT,OA7Bf,YAAqC,IAAhBhvB,EAAe,EAAfA,KAsBnB,OACE,eAAC,GAAD,CAAckc,QAtBhB,WACE,IAAM+S,EAAU,CACdjvB,EAAKG,MAAMyD,UAAYpE,EACvBQ,EAAKG,MAAM0D,SAAWrE,EACtBQ,EAAKG,MAAMgJ,WAAa,GACxBnJ,EAAKG,MAAMiJ,YAAc,IACzBnI,KAAK,KACDsG,EAAOjJ,SAASqwB,gBAAgB,6BAA8B,OACpEpnB,EAAK6D,aAAa,QAASI,OAAOxL,EAAKG,MAAMgJ,WAAa,KAC1D5B,EAAK6D,aAAa,SAAUI,OAAOxL,EAAKG,MAAMiJ,YAAc,KAC5D7B,EAAK6D,aAAa,UAAW6jB,GAEZ,IAAIL,GAAYrnB,EAAMvH,EAAKK,OACnCgE,cAAcrE,EAAKG,OAE5B,IACMiuB,GADgB,IAAIrnB,eACAU,kBAAkBF,GACtCnJ,EAAU,IAAI2kB,IAAJ,oCAAqCF,KAAKuL,KAAQ9c,WAClEpT,EAAa,GAAD,OAAIH,EAAiBiC,EAAKE,OAA1B,QAAwC9B,IAIhBsT,SAAS,eAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,eADb,IAC6B,cAAC,KAAD,CAAkBkL,GAAG,aAAayR,eAAe,mBCXnEmT,OAdf,YAAgD,IAA1BlV,EAAyB,EAAzBA,KAAMyE,EAAmB,EAAnBA,SACpB0Q,EAAOnV,EAAO,oBAAsB,eAM1C,OACE,eAAC,GAAD,CAAckC,QALhB,WACEuC,GAAUzE,IAI0BtI,SAAS,QAA7C,UACE,cAAC,GAAD,CAAMtS,KAAM+vB,IADd,IACuB,cAAC,KAAD,CAAkB7kB,GAAG,YAAYyR,eAAe,oBCE5DqT,OAZf,YAAoC,IAAlBC,EAAiB,EAAjBA,OAKhB,OACE,eAAC,GAAD,CAAcnT,QALhB,WACEmT,KAIoC3d,SAAS,YAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,YADb,IAC0B,cAAC,KAAD,CAAkBkL,GAAG,cAAcyR,eAAe,gBCKjEuT,OAZf,YAAqC,IAAlBD,EAAiB,EAAjBA,OAKjB,OACE,eAAC,GAAD,CAAcnT,QALhB,WACEmT,KAIoC3d,SAAS,aAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,aADb,IAC2B,cAAC,KAAD,CAAkBkL,GAAG,eAAeyR,eAAe,iBCKnEwT,OAZf,YAAuC,IAAlBF,EAAiB,EAAjBA,OAKnB,OACE,eAAC,GAAD,CAAcnT,QALhB,WACEmT,KAIoC3d,SAAS,SAA7C,UACE,cAAC,GAAD,CAAMtS,KAAK,WADb,IACyB,cAAC,KAAD,CAAkBkL,GAAG,iBAAiByR,eAAe,mBCgGnEyT,OAxFf,WACE,IAAMxvB,EAAOoa,GAAS,QAAS,MAAO,MAAO,QAAS,SADrC,EAEUA,GAAS,QAA5BJ,EAFS,EAETA,KAAMS,EAFG,EAEHA,SACRkB,EAAOC,cAEb,SAAS6T,EAAiBzvB,GACxBya,EAAS,YAAaza,GAexB,SAAS0vB,EAAmBrW,GAC1BoB,EAAS,gBAAiBpB,GAG5B,OACE,eAAC,GAAD,WACE,eAAC,GAAD,CAAMnZ,MAAOyb,EAAKG,cAAc,CAAExR,GAAI,OAAQyR,eAAgB,SAA9D,UACE,cAAC,GAAD,CAAS4F,aAAc8N,IACvB,cAAC,GAAD,IACA,cAAC,GAAD,CAAU9N,aAAc8N,IACxB,cAAC,GAAD,CAAUzvB,KAAMA,IAChB,cAAC,GAAD,IACA,cAAC,GAAD,CAAYA,KAAMA,EAAM0iB,cAAe,SAACxiB,GAAD,OAAWuvB,EAAiB,6BAAKzvB,GAAN,IAAYE,iBAGhF,eAAC,GAAD,CAAMA,MAAOyb,EAAKG,cAAc,CAAExR,GAAI,OAAQyR,eAAgB,SAA9D,UACE,cAAC,GAAD,CAAkB/b,KAAMA,EAAMqhB,aA5BpC,SAA0BrjB,GACxByc,EAAS,WAAYzc,MA4BjB,cAAC,GAAD,CAAegC,KAAMA,EAAMkhB,gBAzBjC,SAA6BljB,GAC3Byc,EAAS,cAAezc,SA2BtB,eAAC,GAAD,CAAMkC,MAAOyb,EAAKG,cAAc,CAAExR,GAAI,OAAQyR,eAAgB,SAA9D,UACE,cAAC,GAAD,CAAUmH,OAAQ,kBAAMzI,EAAS,oBACjC,cAAC,GAAD,CAAWyI,OAAQ,kBAAMzI,EAAS,qBAClC,cAAC,GAAD,CAAQyI,OAAQ,kBAAMzI,EAAS,kBAC/B,cAAC,GAAD,CAAUyI,OAAQ,kBAAMzI,EAAS,oBACjC,cAAC,GAAD,IACA,cAAC,GAAD,CAAW4U,OAAQ,kBAAM5U,EAAS,qBAClC,cAAC,GAAD,CAAQ4U,OAAQ,kBAAM5U,EAAS,kBAC/B,cAAC,GAAD,CAAS4U,OAAQ,kBAAM5U,EAAS,mBAChC,cAAC,GAAD,IACA,cAAC,GAAD,CAAYT,KAAMA,EAAMyE,SAlC9B,SAA0BzE,GACxBS,EAAS,YAAaT,SAoCpB,eAAC,GAAD,CAAM9Z,MAAOyb,EAAKG,cAAc,CAAExR,GAAI,SAAUyR,eAAgB,WAAhE,UACE,cAAC,GAAD,CAAW/b,KAAMA,IACjB,cAAC,GAAD,CAAWA,KAAMA,OAGnB,qBAAKwb,UAAU,gBAEf,cAAC,GAAD,UACE,eAAC,GAAD,CAAcA,UAAU,WAAW/c,KAAK,qCAAxC,UACE,cAAC,GAAD,CAAMW,KAAK,WACX,cAAC,KAAD,CAAkBkL,GAAG,SAASyR,eAAe,gBAGjD,eAAC,GAAD,CACEO,UAAU,MACVpc,MACE,qCACE,cAAC,GAAD,CAAMd,KAAK,UACX,cAAC,KAAD,CAAkBkL,GAAG,OAAOyR,eAAe,gBALjD,UASE,cAAC,GAAD,CAAY1C,OAAQlc,EAAO0C,OAAQT,KAAK,UAAUqf,SAAUiR,IAC5D,cAAC,GAAD,CACErW,OAAQlc,EAAO2C,QACfV,KAAK,UACLqf,SAAUiR,EACVtP,QAAQ,cC/FlB,SAASuP,GAAepM,EAA2BljB,EAAcuvB,GAC/D,OAAO,IAAI7E,GAAexH,EAAQljB,EAAO,CACvC2Z,KAAM4V,EAAK5V,KACXmR,WAAYyE,EAAK3V,UAAYsJ,EAAO/f,MAAQ,EAC5C4nB,WAAYwE,EAAK1V,UAAYqJ,EAAO9f,OAAS,EAC7C0W,KAAMyV,EAAKzV,OA+KA0V,OA3Kf,WACE,IAAMD,EAAOxV,GAAS,OAAQ,YAAa,YAAa,QADxC,EAEmBA,GAAS,QAAS,SAA7Cja,EAFQ,EAERA,MAAOE,EAFC,EAEDA,MAAOoa,EAFN,EAEMA,SAChBqV,EAAM3e,iBAAuB,MAC7BoS,EAASpS,iBAA0B,MACnC4e,EAAkB5e,iBAAoB,MACtC6e,EAAqB7e,iBAAkB,MACvC8e,EAAkB9e,iBAAyB,MA0BjD,SAAS+e,EAAUC,GACjB5M,EAAO/R,QAASnR,MAAM8vB,OAASA,EA0BjC,SAASC,EAA0BxyB,EAAWC,GAC5C,InG9B0BwyB,EAAoBrE,EANnBsE,EAAmBC,EmGoCxC7mB,EAASvJ,EAAMqwB,MAAK,SAACC,GAAD,OAAQA,EAAGtP,gBACrC,GAAIzX,aAAkBnG,EAAY,CAAC,IAAD,GnGrCP+sB,EmGuCR,CAAE1yB,IAAGC,KnGvCsB0yB,EmGuCjBR,EAAgBve,QnGjCnB6e,EAHrB,CAAEzyB,EAFC0yB,EAAK1yB,EAAI2yB,EAAK3yB,EAEZC,EADFyyB,EAAKzyB,EAAI0yB,EAAK1yB,GAIwBmuB,EC/C9B,GDgDX,CACLpuB,EAAGwT,KAAKiC,MAAMgd,EAAMzyB,EAAIouB,GAAMA,EAC9BnuB,EAAGuT,KAAKiC,MAAMgd,EAAMxyB,EAAImuB,GAAMA,ImG6BjB0E,EADqB,EACxB9yB,EAAc+yB,EADU,EACb9yB,EAInB,GAAIoyB,EAAgBze,UAAY9H,EAI9B,OAHAA,EAAOknB,QAAQZ,EAAmBxe,QAAS5T,EAAI8yB,GAC/ChnB,EAAOmnB,OAAOb,EAAmBxe,QAAS3T,EAAI8yB,QAC9ClW,EAAS,aAAc/Q,GAGrBumB,EAAgBze,mBAAmB4X,IApC3C,SAA4B1f,EAAoBujB,EAAgByD,EAAgBC,GAC1E1D,EAAOvrB,SAAWpC,EAAOiD,GAAK0qB,EAAOvrB,SAAWpC,EAAO6tB,IAAMF,EAAOvrB,SAAWpC,EAAOiuB,KACxF7jB,EAAOonB,SAASd,EAAmBxe,QAAShO,MAAQktB,GACpDhnB,EAAOknB,QAAQZ,EAAmBxe,QAAS5T,EAAI8yB,GAC/CjW,EAAS,aAAc/Q,IAErBujB,EAAOvrB,SAAWpC,EAAOgD,GAAK2qB,EAAOvrB,SAAWpC,EAAO+tB,IAAMJ,EAAOvrB,SAAWpC,EAAOkuB,KACxF9jB,EAAOonB,SAASd,EAAmBxe,QAAShO,MAAQktB,GACpDhnB,EAAOknB,QAAQZ,EAAmBxe,QAAS5T,GAC3C6c,EAAS,aAAc/Q,IAErBujB,EAAOvrB,SAAWpC,EAAOyC,GAAKkrB,EAAOvrB,SAAWpC,EAAO6tB,IAAMF,EAAOvrB,SAAWpC,EAAO+tB,KACxF3jB,EAAOqnB,UAAUf,EAAmBxe,QAAS/N,OAASktB,GACtDjnB,EAAOmnB,OAAOb,EAAmBxe,QAAS3T,EAAI8yB,GAC9ClW,EAAS,aAAc/Q,IAErBujB,EAAOvrB,SAAWpC,EAAO0C,GAAKirB,EAAOvrB,SAAWpC,EAAOiuB,IAAMN,EAAOvrB,SAAWpC,EAAOkuB,KACxF9jB,EAAOqnB,UAAUf,EAAmBxe,QAAS/N,OAASktB,GACtDjnB,EAAOmnB,OAAOb,EAAmBxe,QAAS3T,GAC1C4c,EAAS,aAAc/Q,IAkBrBsnB,CAAmBtnB,EAAQumB,EAAgBze,QAASkf,EAAQC,IAiFlE,OAhJA1f,qBAAU,WACR,SAASggB,IACP,GAAoB,OAAhBnB,EAAIte,QAAR,CAIA,IAAM2S,EAAO2L,EAAIte,QAAQ7T,wBACzB4lB,EAAO/R,QAAShO,MAAQ4N,KAAK8f,MAAM/M,EAAK3gB,OACxC+f,EAAO/R,QAAS/N,OAAS2N,KAAK8f,MAAM/M,EAAK1gB,QAEzC,IAAMpG,EAAWsyB,GAAepM,EAAO/R,QAAUnR,EAAOuvB,GACxDvyB,EAAS2J,QACT3J,EAASgH,cAAclE,IAKzB,OAFAtB,OAAOuT,iBAAiB,SAAU6e,GAClCA,IACO,WACLpyB,OAAOwT,oBAAoB,SAAU4e,OA+HvC,qBACErf,IAAKke,EACLtU,UAAU,SACVnb,MAAO,CAAE8wB,gBAAiB,sBAAuBxQ,SAAU,UAH7D,SAKE,wBACE/O,IAAK2R,EACL6N,YApFN,SAAyB9zB,GACvB,IAAMD,EAAWsyB,GAAepM,EAAO/R,QAAUnR,EAAOuvB,GADK,EAE5CxyB,EAAoBC,EAAUC,GAAvCM,EAFqD,EAErDA,EAAGC,EAFkD,EAElDA,EAEX,GAAoB,EAAhBP,EAAM+zB,QAIR,OAHAjB,EAA0BxyB,EAAGC,GAC7BR,EAAS2J,aACT3J,EAASgH,cAAclE,GAPoC,oBAWvCA,GAXuC,IAW7D,2BAA6B,SACnBmxB,YAAW,IAZwC,8BAe7D,IAAMrE,EAAS5vB,EAASk0B,mBAAmBpxB,EAAOvC,EAAGC,GACrD,QAAe4G,IAAXwoB,EACFiD,EAAU,GAAD,OAAI5wB,EAAO2tB,EAAOvrB,QAAQyJ,cAA1B,gBACJ,CACL+kB,EAAU,WADL,oBAGoB/vB,GAHpB,IAGL,2BAAgC,CAAC,IAAtB2E,EAAqB,QAC9B,GAAIA,aAAsBvB,EAExB,GADuBlG,EAASwqB,oBAAoB/iB,EAAYlH,EAAGC,GAC/C,CAClBiH,EAAWwsB,YAAW,GACtB,QARD,+BAcPj0B,EAAS2J,QACT3J,EAASgH,cAAclE,IAoDnBqxB,YAxBN,SAAyBl0B,GACvB,IAAMD,EAAWsyB,GAAepM,EAAO/R,QAAUnR,EAAOuvB,GADK,EAE5CxyB,EAAoBC,EAAUC,IA3BjD,SAAyBD,EAA0BO,EAAWC,GAC5D,IAAM4zB,EAAkBtxB,EAAMqwB,MAAK,SAACC,GAAD,OAAQA,EAAGtP,gBACxC8L,EAAS5vB,EAASk0B,mBAAmBpxB,EAAOvC,EAAGC,GACrD,QAAe4G,IAAXwoB,GAAwBwE,aAA2BluB,EAIrD,OAHAysB,EAAmBxe,QAAUigB,EAAgBnL,eAC7CyJ,EAAgBve,QAAU,CAAE5T,IAAGC,UAC/BoyB,EAAgBze,QAAUyb,GAIb,OAAfwE,QAAe,IAAfA,KAAiBlQ,aAAY,GAV0C,oBAW9CphB,GAX8C,IAWvE,2BAAgC,CAAC,IAAtB2E,EAAqB,QAC9B,GAAIA,aAAsBvB,GACDlG,EAASwqB,oBAAoB/iB,EAAYlH,EAAGC,GAMjE,OAJAiH,EAAWyc,aAAY,GACvByO,EAAmBxe,QAAU1M,EAAWwhB,eACxCyJ,EAAgBve,QAAU,CAAE5T,IAAGC,UAC/BoyB,EAAgBze,QAAU1M,IAlBuC,+BA6BvE4sB,CAAgBr0B,EAJ6C,EAErDO,EAFqD,EAElDC,GAGXR,EAAS2J,QACT3J,EAASgH,cAAclE,IAmBnBwxB,UAhBN,WACE3B,EAAmBxe,QAAU,KAC7Bue,EAAgBve,QAAU,KAC1Bye,EAAgBze,QAAU,WC7JfogB,OAVf,WAAsB,IAAD,EACOxX,GAAS,OAA3B9Z,EADW,EACXA,IAAKma,EADM,EACNA,SAEb,OACE,qBAAKe,UAAU,YAAYnb,MAAO,CAAEsgB,SAAU,MAAOkR,SAAU,YAA/D,SACE,cAAC,GAAD,CAAQlY,SAAS,MAAMpY,MAAOjB,EAAKme,SAAU,SAACne,GAAD,OAASma,EAAS,WAAYna,S,2BCIjF,SAASwxB,GAAkBzY,GACzB,OAAQA,GACN,KAAKlc,EAAO0C,OACV,OAAOkyB,GACT,QACE,OAAOC,IAiBEC,OAbf,YAA4C,IAApBnvB,EAAmB,EAAnBA,SACduW,EAAWe,GAAS,UAApBf,OACR,OACE,cAAC,KAAD,CACE6Y,SAAUJ,GAAkBzY,GAC5BA,OAAQA,EACR8Y,cAAeh1B,EAAO2C,QAHxB,SAKGgD,KC3BDsvB,GAAeluB,OAAOmuB,KAAK/yB,GAC9BgzB,QAAO,SAACC,GAAD,OAAQA,EAAGxc,MAAM,YACxBjV,KAAI,SAACyxB,GAAD,OAAQA,EAAGpnB,iBAEZqnB,GAActuB,OAAOmuB,KAAKzvB,GAC7B0vB,QAAO,SAACC,GAAD,OAAQA,EAAGxc,MAAM,YACxBjV,KAAI,SAACyxB,GAAD,OAAQA,EAAGpnB,iBAEZsnB,GAAYvuB,OAAOmuB,KAAKjtB,GAC3BktB,QAAO,SAACC,GAAD,OAAQA,EAAGxc,MAAM,YACxBjV,KAAI,SAACyxB,GAAD,OAAQA,EAAGpnB,iBAMZunB,GAAmB,CACvB5vB,SAAU,CAAC,QAAS,YAAa,SAAU,cAC3CmnB,MAAO,CACLrsB,EAAG,KACHC,EAAG,KACH2F,MAAO,KACPC,OAAQ,KACR/B,OAAQ0wB,GACR1uB,MAAO8uB,KAILG,GAAqB,CACzB1I,MAAO,CACL3kB,KAAM,KACNI,QAAS+sB,GACTjtB,GAAI,KACJI,MAAO6sB,GACP5sB,YAtBsB3B,OAAOmuB,KAAK/uB,GACnCgvB,QAAO,SAACC,GAAD,OAAQA,EAAGxc,MAAM,YACxBjV,KAAI,SAACyxB,GAAD,OAAQA,EAAGpnB,mBAwBZynB,GAAc,CAClBxlB,MAAOslB,GACPnvB,WAAYmvB,GACZrlB,UAAWqlB,GACXjlB,SAAUilB,GACV5kB,YAAa4kB,GACbxkB,UAAWwkB,GACXvkB,KAAMukB,GACNxuB,OAAQwuB,GACRrkB,QAASqkB,GACTnkB,UAAWmkB,IAGPG,GAAgB,CACpB7lB,YAAa2lB,GACbrzB,OAAQqzB,GACRxlB,YAAawlB,GACbplB,YAAaolB,GACbjlB,WAAYilB,GACZ9kB,oBAAqB8kB,GACrB5kB,eAAgB4kB,GAChB1kB,eAAgB0kB,GAChBttB,aAAcstB,IAgBDnU,GAbH,2BACV,OAAQ,CAAC,WACT,SAAU,CACRlU,GAAI,KACJwoB,MAAO,MAET1uB,QAAS,CACPtB,SAAS,GAAD,mBAAMoB,OAAOmuB,KAAKO,KAAlB,YAAmC1uB,OAAOmuB,KAAKQ,QAEtDD,IACAC,ICxDUE,OAff,WAAsB,IAAD,EACO3Y,GAAS,OAA3Bha,EADW,EACXA,IAAKqa,EADM,EACNA,SAEb,OACE,qBAAKe,UAAU,YAAYnb,MAAO,CAAEsgB,SAAU,MAAOkR,SAAU,YAA/D,SACE,cAAC,GAAD,CACElY,SAAS,MACTpY,MAAOnB,EACPoe,OAAQwU,GACRvU,SAAU,SAACre,GAAD,OAASqa,EAAS,WAAYra,SCgCjC6yB,OApCf,WAAgB,IAAD,EACyB7Y,GAAS,QAAS,MAAO,OAAvDla,EADK,EACLA,MAAOI,EADF,EACEA,IAAKF,EADP,EACOA,IAAKqa,EADZ,EACYA,SACnBkB,EAAOC,cACPsX,EAAcvX,EAAKG,cAAc,CAAExR,GAAI,WAAYyR,eAAgB,aACnEoX,EAAWxX,EAAKG,cAAc,CAAExR,GAAI,QAASyR,eAAgB,eAsBnE,OApBA/K,GAAiB,GAAD,OAAI9Q,EAAJ,cAAeizB,IAE/BliB,qBAAU,WACR,GAAIpS,OAAOu0B,SAASjjB,KAAK6F,WAAW,WAAY,CAC9C,IACMhW,EAAOkQ,GADArR,OAAOu0B,SAASjjB,KAAKJ,MAAM,UAAU1Q,SAElD,GAAIW,EAAKI,KAAOJ,EAAKM,IAEnB,YADAma,EAAS,YAAaza,GAK1Bya,EAAS,YAAa,CAAEra,IAAKV,EAAaY,IAAKX,EAAaO,MAAOgzB,MAClE,CAACA,EAAazY,IAEjBxJ,qBAAU,WACR,IAAMd,EAAOV,GAAO,CAAEvP,QAAOE,MAAKE,QAClCzB,OAAOu0B,SAASjjB,KAAhB,gBAAgCA,KAC/B,CAACjQ,EAAOE,EAAKE,IAGd,sBAAKkb,UAAU,mBAAf,UACE,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,IACA,cAAC,GAAD,QC1BS6X,I,MAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqB/Q,MAAK,YAAkD,IAA/CgR,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,QCAdO,IAASvO,OACP,cAAC,IAAMwO,WAAP,UACE,cAAC3Y,GAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,UAIN7c,SAASoM,eAAe,SAM1B2oB,O","file":"static/js/main.c4cae8de.chunk.js","sourcesContent":["import { MouseEvent } from \"react\";\nimport { Style } from \"./css\";\nimport { Diagram } from \"./model\";\nimport { CanvasRenderer } from \"./renderer\";\n\nexport interface Coordinates {\n  readonly x: number;\n  readonly y: number;\n}\n\nexport interface Predicate<T> {\n  (item: T): boolean;\n}\n\nexport interface SerializableFile {\n  title: string;\n  xml: string;\n  css: string;\n}\n\nexport interface File extends SerializableFile {\n  model: Diagram;\n  style: Style;\n}\n\nexport enum Locale {\n  GERMAN = \"de\",\n  ENGLISH = \"en\",\n}\n\nexport function getMouseCoordinates(\n  renderer: CanvasRenderer,\n  event: MouseEvent<HTMLCanvasElement>,\n): Coordinates {\n  const { clientX, clientY } = event;\n  const boundingClientRect = event.currentTarget.getBoundingClientRect();\n\n  const x = clientX - boundingClientRect.x;\n  const y = clientY - boundingClientRect.y;\n\n  return renderer.transformPoint(x, y);\n}\n\nexport function subtractCoords(vec1: Coordinates, vec2: Coordinates): Coordinates {\n  const x = vec1.x - vec2.x;\n  const y = vec1.y - vec2.y;\n  return { x, y };\n}\n\nexport function roundCoordsBy(coord: Coordinates, by: number): Coordinates {\n  return {\n    x: Math.round(coord.x / by) * by,\n    y: Math.round(coord.y / by) * by,\n  };\n}\n\nexport function sanitizeFilename(element: string): string {\n  return element.replace(/[^a-zA-Z_-]+/g, \"-\");\n}\n\nexport function downloadFile(filename: string, dataURL: string): void {\n  const downloadLink = document.createElement(\"a\");\n  downloadLink.download = filename;\n  downloadLink.href = dataURL;\n  downloadLink.click();\n}\n\nexport function uploadFile(pattern: string): Promise<string> {\n  return new Promise<string>((resolve) => {\n    const uploadInput = document.createElement(\"input\");\n\n    uploadInput.addEventListener(\n      \"change\",\n      () => {\n        if (uploadInput.files!.length > 0) {\n          resolve(uploadInput.files!.item(0)!.text());\n        }\n      },\n      { once: true },\n    );\n\n    uploadInput.type = \"file\";\n    uploadInput.accept = pattern;\n    uploadInput.multiple = false;\n    uploadInput.click();\n  });\n}\n\nexport function storageAvailable(): boolean {\n  const storage = window.localStorage;\n  try {\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return (\n      e instanceof DOMException &&\n      // everything except Firefox\n      (e.code === 22 ||\n        // Firefox\n        e.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        e.name === \"QuotaExceededError\" ||\n        // Firefox\n        e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storage?.length !== 0\n    );\n  }\n}\n","import { Locale } from \"./utils\";\n\nexport const GRID = 20;\nexport const PADDING = 10;\nexport const MARGIN = 10;\nexport const HANDLE_RADIUS = 4.5;\nexport const INITIAL_XML = `\\\n<Diagram>\n  <Interface id=\"i1\" anchor=\"s\" y=\"-60\">\n    <Stereotype/>\n    <Title>Visitor</Title>\n  </Interface>\n\n  <Class id=\"c1\" anchor=\"n\" y=\"60\" width=\"400\">\n    <Stereotype/>\n    <Title>Concrete Visitor</Title>\n    <Separator/>\n    <Text>visitSomething(something: Something)</Text>\n  </Class>\n\n  <Implementation from=\"c1\" to=\"i1\"/>\n</Diagram>\n`;\nexport const INITIAL_CSS = `\\\nInterface {\n  Title {\n    font-style: italic;\n  }\n}\n\nClass {\n  Title {\n    font-weight: bold;\n  }\n}\n`;\nexport const LOCALES = [Locale.GERMAN, Locale.ENGLISH];\n","enum Anchor {\n  N,\n  NNE,\n  NE,\n  ENE,\n  E,\n  ESE,\n  SE,\n  SSE,\n  S,\n  SSW,\n  SW,\n  WSW,\n  W,\n  WNW,\n  NW,\n  NNW,\n  CENTER,\n}\n\nexport default Anchor;\n","import { SerializableFile } from \"../utils\";\n\nclass FileSerializer {\n  saveToString(file: SerializableFile): string {\n    const header = `title: ${file.title}`;\n    const model = file.xml;\n    const style = file.css;\n    return this.joinSections(header, model, style);\n  }\n\n  loadFromString(content: string): SerializableFile {\n    const [headerString, model, style] = this.splitSections(content, 3);\n    const header = this.parseHeader(headerString);\n    return {\n      title: header.title ?? \"Untitled\",\n      xml: model,\n      css: style,\n    };\n  }\n\n  private joinSections(...sections: string[]): string {\n    return sections.map((str) => str.trim()).join(\"\\n---\\n\") + \"\\n\";\n  }\n\n  private splitSections(content: string, expectedNumber: number): string[] {\n    const sections = content.split(\"\\n---\\n\");\n    if (sections.length !== expectedNumber) {\n      throw new Error(`Expected ${expectedNumber} sections`);\n    }\n\n    return sections;\n  }\n\n  private parseHeader(headerString: string): Record<string, string> {\n    const result: Record<string, string> = {};\n    for (const line of headerString.split(/\\r\\n|[\\r\\n]/)) {\n      const [key, value] = line.split(/:\\s*/, 2);\n      result[key] = value;\n    }\n\n    return result;\n  }\n}\n\nexport default FileSerializer;\n","import { Anchor } from \"../model\";\n\nconst EAST = 2;\nconst SOUTH = 6;\nconst WEST = 10;\nconst NORTH = 14;\n\nconst NUM_SIDE = 5;\nconst NUM_OUTER = 16;\n\nfunction isSide(side: number, anchor: Anchor): boolean {\n  return (anchor + side) % NUM_OUTER < NUM_SIDE;\n}\n\nexport function qsin(anchor: Anchor): number {\n  if (anchor === Anchor.CENTER) {\n    return 1 / 2;\n  }\n\n  if (isSide(SOUTH, anchor)) {\n    return 0;\n  }\n\n  if (isSide(NORTH, anchor)) {\n    return 1;\n  }\n\n  switch (anchor) {\n    case Anchor.NNW:\n    case Anchor.SSW:\n      return 1 / 4;\n    case Anchor.N:\n    case Anchor.S:\n      return 1 / 2;\n    case Anchor.NNE:\n    case Anchor.SSE:\n      return 3 / 4;\n  }\n\n  throw new Error();\n}\n\nexport function qcos(anchor: Anchor): number {\n  if (anchor === Anchor.CENTER) {\n    return 1 / 2;\n  }\n\n  if (isSide(EAST, anchor)) {\n    return 0;\n  }\n\n  if (isSide(WEST, anchor)) {\n    return 1;\n  }\n\n  switch (anchor) {\n    case Anchor.ENE:\n    case Anchor.WNW:\n      return 1 / 4;\n    case Anchor.E:\n    case Anchor.W:\n      return 1 / 2;\n    case Anchor.ESE:\n    case Anchor.WSW:\n      return 3 / 4;\n  }\n\n  throw new Error();\n}\n","import Element from \"./Element\";\nimport Renderer from \"./Renderer\";\n\nabstract class AbstractElement implements Element {\n  private readonly children = new Set<Element>();\n  private hovered = false;\n  private selected = false;\n\n  abstract render(renderer: Renderer): void;\n\n  abstract getTagName(): string;\n\n  abstract clone(): Element;\n\n  getChildren(): readonly Element[] {\n    return [...this.children];\n  }\n\n  addChild(child: Element): this {\n    this.children.add(child);\n    return this;\n  }\n\n  deleteChild(child: Element): boolean {\n    return this.children.delete(child);\n  }\n\n  *[Symbol.iterator](): Iterator<Element> {\n    for (const child of [...this.children].reverse()) {\n      yield* child;\n    }\n    yield this;\n  }\n\n  isHovered(): boolean {\n    return this.hovered;\n  }\n\n  setHovered(hovered: boolean): void {\n    this.hovered = hovered;\n  }\n\n  isSelected(): boolean {\n    return this.selected;\n  }\n\n  setSelected(selected: boolean): void {\n    this.selected = selected;\n  }\n}\n\nexport default AbstractElement;\n","enum Shape {\n  RECTANGLE,\n  ELLIPSE,\n  NOTE,\n  FOLDER,\n  BOX,\n  FILE,\n  COMPONENT,\n}\n\nexport default Shape;\n","enum LinePattern {\n  SOLID,\n  DOTS,\n  SMALL_DASHES,\n  LARGE_DASHES,\n  TIGHT_DASHES,\n}\n\nexport default LinePattern;\n","import { qcos, qsin } from \"../renderer/anchors\";\nimport AbstractElement from \"./AbstractElement\";\nimport Anchor from \"./Anchor\";\nimport Rectangle from \"./Rectangle\";\nimport Renderer from \"./Renderer\";\nimport Shape from \"./Shape\";\n\nclass Classifier extends AbstractElement {\n  readonly anchor: Anchor;\n  x: number;\n  y: number;\n  private width: number;\n  private height: number;\n  shape: Shape = Shape.RECTANGLE;\n\n  constructor(anchor: Anchor, x: number, y: number, width: number, height: number) {\n    super();\n    this.anchor = anchor;\n    this.x = x;\n    this.y = y;\n    this.width = width;\n    this.height = height;\n  }\n\n  getTagName(): string {\n    return \"Classifier\";\n  }\n\n  getRectangle(): Rectangle {\n    return {\n      x: this.getLeft(),\n      y: this.getTop(),\n      width: this.width,\n      height: this.height,\n    };\n  }\n\n  getWidth(): number {\n    return this.width;\n  }\n\n  setWidth(width: number): void {\n    this.width = width;\n  }\n\n  getX(): number {\n    return this.x;\n  }\n\n  getY(): number {\n    return this.y;\n  }\n\n  getAnchorX(anchor: Anchor): number {\n    return this.getLeft() + qsin(anchor) * this.width;\n  }\n\n  getAnchorY(anchor: Anchor): number {\n    return this.getTop() + qcos(anchor) * this.height;\n  }\n\n  getHeight(): number {\n    return this.height;\n  }\n\n  setHeight(height: number): void {\n    this.height = height;\n  }\n\n  getLeft(): number {\n    return this.x - this.width * qsin(this.anchor);\n  }\n\n  setLeft(left: number): void {\n    this.x = left + this.width * qsin(this.anchor);\n  }\n\n  getCenterX(): number {\n    return this.getLeft() + this.width / 2;\n  }\n\n  getRight(): number {\n    return this.getLeft() + this.width;\n  }\n\n  getTop(): number {\n    return this.y - this.height * qcos(this.anchor);\n  }\n\n  setTop(top: number): void {\n    this.y = top + this.height * qcos(this.anchor);\n  }\n\n  getCenterY(): number {\n    return this.getTop() + this.height / 2;\n  }\n\n  getBottom(): number {\n    return this.getTop() + this.height;\n  }\n\n  render(renderer: Renderer): void {\n    renderer.renderClassifier(this);\n  }\n\n  clone(): Classifier {\n    const { constructor } = Object.getPrototypeOf(this);\n    return new constructor(this.anchor, this.x + 20, this.y + 20, this.width, this.height);\n  }\n}\n\nexport default Classifier;\n","import { Predicate } from \"../utils\";\nimport AbstractElement from \"./AbstractElement\";\nimport Classifier from \"./Classifier\";\nimport Element from \"./Element\";\nimport Renderer from \"./Renderer\";\n\nclass Diagram extends AbstractElement {\n  render(renderer: Renderer): void {\n    renderer.renderDiagram(this);\n  }\n\n  getTagName(): string {\n    return \"Diagram\";\n  }\n\n  clone(): Diagram {\n    return new Diagram();\n  }\n\n  find(predicate: Predicate<Element>): Element | undefined {\n    return this.findElement(this, predicate);\n  }\n\n  private findElement(element: Element, predicate: Predicate<Element>): Element | undefined {\n    const result = predicate(element);\n    if (result) {\n      return element;\n    }\n\n    for (const child of element.getChildren()) {\n      const result = this.findElement(child, predicate);\n      if (result !== undefined) {\n        return result;\n      }\n    }\n\n    return undefined;\n  }\n\n  getWidth(): number {\n    return this.getRight() - this.getLeft();\n  }\n\n  getHeight(): number {\n    return this.getBottom() - this.getTop();\n  }\n\n  getTop(): number {\n    return this.reduceClassifiers((acc, classifier) => {\n      const top = classifier.getTop();\n      return acc > top ? top : acc;\n    }, Infinity);\n  }\n\n  getBottom(): number {\n    return this.reduceClassifiers((acc, classifier) => {\n      const bottom = classifier.getBottom();\n      return acc < bottom ? bottom : acc;\n    }, -Infinity);\n  }\n\n  getLeft(): number {\n    return this.reduceClassifiers((acc, classifier) => {\n      const left = classifier.getLeft();\n      return acc > left ? left : acc;\n    }, Infinity);\n  }\n\n  getRight(): number {\n    return this.reduceClassifiers((acc, classifier) => {\n      const right = classifier.getRight();\n      return acc < right ? right : acc;\n    }, -Infinity);\n  }\n\n  private reduceClassifiers(\n    reducer: (acc: number, classifier: Classifier) => number,\n    seed: number,\n  ): number {\n    let acc = seed;\n    for (const classifier of this.getChildren()) {\n      if (classifier instanceof Classifier) {\n        acc = reducer(acc, classifier);\n      }\n    }\n\n    if (acc === seed) {\n      return 0;\n    }\n\n    return acc;\n  }\n}\n\nexport default Diagram;\n","enum Tip {\n  NONE,\n  ARROW,\n  TRIANGLE,\n  FILLED_TRIANGLE,\n  DIAMOND,\n  FILLED_DIAMOND,\n  CIRCLE,\n  FILLED_CIRCLE,\n}\n\nexport default Tip;\n","import AbstractElement from \"./AbstractElement\";\nimport Anchor from \"./Anchor\";\nimport Classifier from \"./Classifier\";\nimport LinePattern from \"./LinePattern\";\nimport Renderer from \"./Renderer\";\nimport Tip from \"./Tip\";\n\nclass Relationship extends AbstractElement {\n  from: Classifier;\n  fromAnchor: Anchor;\n  fromTip: Tip = Tip.NONE;\n  to: Classifier;\n  toAnchor: Anchor;\n  toTip: Tip = Tip.NONE;\n  linePattern: LinePattern = LinePattern.SOLID;\n\n  constructor(from: Classifier, fromAnchor: Anchor, to: Classifier, toAnchor: Anchor) {\n    super();\n    this.from = from;\n    this.fromAnchor = fromAnchor;\n    this.to = to;\n    this.toAnchor = toAnchor;\n  }\n\n  render(renderer: Renderer): void {\n    renderer.renderRelationship(this);\n  }\n\n  getTagName(): string {\n    return \"Relationship\";\n  }\n\n  clone(): Relationship {\n    const { constructor } = Object.getPrototypeOf(this);\n    return new constructor(this.from, this.fromAnchor, this.to, this.toAnchor);\n  }\n}\n\nexport default Relationship;\n","import AbstractElement from \"./AbstractElement\";\nimport Renderer from \"./Renderer\";\n\nclass Separator extends AbstractElement {\n  render(renderer: Renderer): void {\n    renderer.renderSeparator(this);\n  }\n\n  getTagName(): string {\n    return \"Separator\";\n  }\n\n  clone(): Separator {\n    return new Separator();\n  }\n}\n\nexport default Separator;\n","import AbstractElement from \"./AbstractElement\";\nimport Renderer from \"./Renderer\";\n\nclass Stereotype extends AbstractElement {\n  render(renderer: Renderer): void {\n    renderer.renderStereotype(this);\n  }\n\n  getTagName(): string {\n    return \"Stereotype\";\n  }\n\n  clone(): Stereotype {\n    return new Stereotype();\n  }\n}\n\nexport default Stereotype;\n","import AbstractElement from \"./AbstractElement\";\nimport Renderer from \"./Renderer\";\n\nclass Text extends AbstractElement {\n  readonly text: string;\n\n  constructor(text: string) {\n    super();\n    this.text = text;\n  }\n\n  render(renderer: Renderer): void {\n    renderer.renderText(this);\n  }\n\n  getTagName(): string {\n    return \"Text\";\n  }\n\n  clone(): Text {\n    const { constructor } = Object.getPrototypeOf(this);\n    return new constructor(this.text);\n  }\n}\n\nexport default Text;\n","import Text from \"./Text\";\nimport Renderer from \"./Renderer\";\n\nclass Title extends Text {\n  render(renderer: Renderer): void {\n    renderer.renderTitle(this);\n  }\n\n  getTagName(): string {\n    return \"Title\";\n  }\n}\n\nexport default Title;\n","import * as Model from \"../model\";\n\ninterface Class<T> {\n  new (...args: any[]): T;\n}\n\nclass Serializer {\n  private readonly parser: DOMParser;\n  private readonly serializer: XMLSerializer;\n  private readonly elementMap = new Map<Element, Model.Element>();\n\n  constructor() {\n    this.parser = new DOMParser();\n    this.serializer = new XMLSerializer();\n  }\n\n  deserialize(xml: string): Model.Diagram {\n    this.elementMap.clear();\n    const document = this.parser.parseFromString(xml, \"text/xml\");\n    const diagram = this.parseElement(document.documentElement);\n    if (!(diagram instanceof Model.Diagram)) {\n      return new Model.Diagram();\n    }\n\n    return diagram;\n  }\n\n  serialize(diagram: Model.Diagram): string {\n    if (this.hasElement(diagram)) {\n      const root = this.getElement(diagram)!;\n      return this.serializer.serializeToString(root);\n    }\n\n    return \"\";\n  }\n\n  updateElement(element: Model.Element): void {\n    if (this.hasElement(element)) {\n      const xmlElement = this.getElement(element)!;\n      this.setElement(xmlElement, element);\n    }\n  }\n\n  private parseElement(element: Element): Model.Element {\n    if (this.elementMap.has(element)) {\n      return this.elementMap.get(element)!;\n    }\n\n    const parsed = this.parseElementSwitch(element);\n    this.elementMap.set(element, parsed);\n    return parsed;\n  }\n\n  private setElement(xmlElement: Element, element: Model.Element) {\n    if (element instanceof Model.Diagram) {\n      this.setDiagram(xmlElement, element);\n    } else if (element instanceof Model.Classifier) {\n      this.setClassifier(xmlElement, element);\n    } else if (element instanceof Model.Text) {\n      this.setText(xmlElement, element);\n    }\n  }\n\n  protected parseElementSwitch(element: Element): Model.Element {\n    switch (element.tagName) {\n      case \"Diagram\":\n        return this.parseDiagram(element);\n      case \"Classifier\":\n        return this.parseClassifier(Model.Classifier, element);\n      case \"Relationship\":\n        return this.parseRelationship(Model.Relationship, element);\n      case \"Title\":\n        return this.parseTitle(element);\n      case \"Text\":\n        return this.parseText(element);\n      case \"Separator\":\n        return new Model.Separator();\n      case \"Stereotype\":\n        return new Model.Stereotype();\n    }\n\n    throw new Error(`Unknown tag: ${element.tagName}`);\n  }\n\n  private parseDiagram(element: Element): Model.Diagram {\n    const diagram = new Model.Diagram();\n    this.parseChildren(element, diagram);\n    return diagram;\n  }\n\n  private setDiagram(element: Element, diagram: Model.Diagram): void {\n    this.updateChildren(element, diagram);\n  }\n\n  protected parseClassifier<C extends Model.Classifier>(\n    constructor: Class<C>,\n    element: Element,\n  ): C {\n    const anchor = this.parseAnchorAttribute(element, \"anchor\");\n    const x = this.parseIntAttribute(element, \"x\", 0);\n    const y = this.parseIntAttribute(element, \"y\", 0);\n    const width = this.parseIntAttribute(element, \"width\", 200);\n    const height = this.parseIntAttribute(element, \"height\", 120);\n    const classifier = new constructor(anchor, x, y, width, height);\n    classifier.shape = this.parseEnumAttribute(Model.Shape, element, \"shape\", classifier.shape);\n    this.parseChildren(element, classifier);\n    return classifier;\n  }\n\n  protected setClassifier(element: Element, classifier: Model.Classifier): void {\n    this.setAnchorAttribute(element, \"anchor\", classifier.anchor);\n    this.setIntAttribute(element, \"x\", 0, classifier.getX());\n    this.setIntAttribute(element, \"y\", 0, classifier.getY());\n    this.setIntAttribute(element, \"width\", 200, classifier.getWidth());\n    this.setIntAttribute(element, \"height\", 120, classifier.getHeight());\n    this.updateChildren(element, classifier);\n  }\n\n  protected parseRelationship<R extends Model.Relationship>(\n    constructor: Class<R>,\n    element: Element,\n  ): R {\n    const from = this.parseClassifierAttribute(element, \"from\");\n    const fromAnchor = this.parseAnchorAttribute(element, \"fromAnchor\");\n    const to = this.parseClassifierAttribute(element, \"to\");\n    const toAnchor = this.parseAnchorAttribute(element, \"toAnchor\");\n    const relationship = new constructor(from, fromAnchor, to, toAnchor);\n    relationship.fromTip = this.parseTipAttribute(element, \"fromTip\", relationship.fromTip);\n    relationship.toTip = this.parseTipAttribute(element, \"toTip\", relationship.toTip);\n    relationship.linePattern = this.parseLinePatternAttribute(\n      element,\n      \"linePattern\",\n      relationship.linePattern,\n    );\n    return relationship;\n  }\n\n  private parseTitle(element: Element): Model.Title {\n    const text = element.textContent ?? \"\";\n    return new Model.Title(text);\n  }\n\n  private parseText(element: Element): Model.Text {\n    const text = element.textContent ?? \"\";\n    return new Model.Text(text);\n  }\n\n  private setText(element: Element, text: Model.Text) {\n    element.textContent = text.text;\n  }\n\n  private parseChildren(element: Element, target: Model.Element) {\n    for (const child of element.children) {\n      try {\n        target.addChild(this.parseElement(child));\n      } catch (err) {\n        console.error(err);\n      }\n    }\n  }\n\n  private updateChildren(element: Element, target: Model.Element) {\n    const visitedChildren = new Set<Element>();\n    for (const child of target.getChildren()) {\n      const childElement = this.getOrCreateElement(element, child);\n      this.setElement(childElement, child);\n      visitedChildren.add(childElement);\n    }\n\n    for (const child of element.children) {\n      if (!visitedChildren.has(child)) {\n        child.remove();\n        this.elementMap.delete(child);\n      }\n    }\n\n    this.cleanupWhiteSpace(element);\n  }\n\n  private getOrCreateElement(element: Element, child: Model.Element): Element {\n    if (this.hasElement(child)) {\n      return this.getElement(child)!;\n    } else {\n      return this.createElement(element, child);\n    }\n  }\n\n  private parseClassifierAttribute(element: Element, attribute: string): Model.Classifier {\n    if (element.hasAttribute(attribute)) {\n      const id = element.getAttribute(attribute)!;\n      const elementById = element.ownerDocument.getElementById(id);\n      if (elementById !== null) {\n        const classifier = this.parseElement(elementById);\n        if (classifier instanceof Model.Classifier) {\n          return classifier;\n        }\n      }\n    }\n\n    throw new Error(\n      `Invalid classifier: <${element.tagName} ${attribute}=\"${element.getAttribute(\n        attribute,\n      )}\" />`,\n    );\n  }\n\n  private parseAnchorAttribute(element: Element, attribute: string): Model.Anchor {\n    return this.parseEnumAttribute(Model.Anchor, element, attribute, Model.Anchor.CENTER);\n  }\n\n  private setAnchorAttribute(element: Element, attribute: string, anchor: Model.Anchor) {\n    this.setEnumAttribute(Model.Anchor, element, attribute, anchor, Model.Anchor.CENTER);\n  }\n\n  private parseTipAttribute(element: Element, attribute: string, fallback: Model.Tip): Model.Tip {\n    return this.parseEnumAttribute(Model.Tip, element, attribute, fallback);\n  }\n\n  private parseLinePatternAttribute(\n    element: Element,\n    attribute: string,\n    fallback: Model.LinePattern,\n  ): Model.LinePattern {\n    return this.parseEnumAttribute(Model.LinePattern, element, attribute, fallback);\n  }\n\n  private parseEnumAttribute<E>(\n    enumClass: Record<string, unknown>,\n    element: Element,\n    attribute: string,\n    fallback: E,\n  ): E {\n    if (element.hasAttribute(attribute)) {\n      const value = element.getAttribute(attribute)!;\n      const item = Reflect.get(enumClass, value.toUpperCase());\n      if (item !== undefined) {\n        return item;\n      }\n    }\n\n    return fallback;\n  }\n\n  private setEnumAttribute(\n    enumClass: Record<number, string>,\n    element: Element,\n    attribute: string,\n    enumValue: number,\n    fallback: number,\n  ): void {\n    if (enumValue === fallback) {\n      element.removeAttribute(attribute);\n    } else {\n      const value = enumClass[enumValue].toLowerCase();\n      element.setAttribute(attribute, value);\n    }\n  }\n\n  private parseIntAttribute(element: Element, attribute: string, fallback: number): number {\n    if (element.hasAttribute(attribute)) {\n      const value = parseInt(element.getAttribute(attribute)!, 10);\n      if (!Number.isNaN(value)) {\n        return value;\n      }\n    }\n\n    return fallback;\n  }\n\n  private setIntAttribute(\n    element: Element,\n    attribute: string,\n    fallback: number,\n    value: number,\n  ): void {\n    if (value !== fallback) {\n      element.setAttribute(attribute, String(value));\n    } else {\n      element.removeAttribute(attribute);\n    }\n  }\n\n  private hasElement(element: Model.Element): boolean {\n    for (const value of this.elementMap.values()) {\n      if (value === element) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  private getElement(element: Model.Element): Element | undefined {\n    for (const [xmlElement, el] of this.elementMap) {\n      if (el === element) {\n        return xmlElement;\n      }\n    }\n    return undefined;\n  }\n\n  private createElement(parent: Element, element: Model.Element): Element {\n    const newElement = parent.ownerDocument.createElement(element.getTagName());\n    const id = this.generateId(parent.ownerDocument, element);\n    newElement.setAttribute(\"id\", id);\n    this.elementMap.set(newElement, element);\n\n    parent.appendChild(newElement);\n\n    return newElement;\n  }\n\n  private generateId(document: Document, element: Model.Element): string {\n    let prefix = element.getTagName().toLowerCase();\n    if (prefix === \"interface\") {\n      prefix = \"i\";\n    } else if (prefix === \"class\") {\n      prefix = \"c\";\n    }\n\n    let i = 1;\n    while (document.getElementById(prefix + i) !== null) {\n      i += 1;\n    }\n    return prefix + i;\n  }\n\n  private cleanupWhiteSpace(element: Element): void {\n    const level = this.getLevel(0, element);\n    const originalChildren = [...element.children];\n    while (element.childNodes.length > 0) {\n      element.removeChild(element.childNodes.item(0));\n    }\n\n    let first = true;\n    for (const originalChild of originalChildren) {\n      let extraNewLine = \"\";\n      if (level === 0 && !first) {\n        extraNewLine = \"\\n\";\n      }\n      this.addText(element, extraNewLine + this.getIndent(level + 1));\n      element.appendChild(originalChild);\n      first = false;\n    }\n    this.addText(element, this.getIndent(level));\n  }\n\n  private getIndent(level: number): string {\n    return \"\\n\" + \"  \".repeat(level);\n  }\n\n  private getLevel(offset: number, parent: Element): number {\n    if (parent.parentElement === null) {\n      return offset;\n    } else {\n      return this.getLevel(offset + 1, parent.parentElement);\n    }\n  }\n\n  private addText(parent: Element, data: string): void {\n    parent.appendChild(parent.ownerDocument.createTextNode(data));\n  }\n}\n\nexport default Serializer;\n","import { Relationship, Tip } from \"../model\";\n\nclass Aggregation extends Relationship {\n  toTip: Tip = Tip.DIAMOND;\n\n  getTagName(): string {\n    return \"Aggregation\";\n  }\n}\n\nexport default Aggregation;\n","import { LinePattern, Relationship } from \"../model\";\n\nclass Anchor extends Relationship {\n  linePattern: LinePattern = LinePattern.DOTS;\n\n  getTagName(): string {\n    return \"Anchor\";\n  }\n}\n\nexport default Anchor;\n","import { Relationship } from \"../model\";\n\nclass Association extends Relationship {\n  getTagName(): string {\n    return \"Association\";\n  }\n}\n\nexport default Association;\n","import { Classifier } from \"../model\";\n\nclass Class extends Classifier {\n  getTagName(): string {\n    return \"Class\";\n  }\n}\n\nexport default Class;\n","import { Classifier, Shape } from \"../model\";\n\nclass Component extends Classifier {\n  shape: Shape = Shape.COMPONENT;\n\n  getTagName(): string {\n    return \"Component\";\n  }\n}\n\nexport default Component;\n","import { Relationship, Tip } from \"../model\";\n\nclass Composition extends Relationship {\n  toTip: Tip = Tip.FILLED_DIAMOND;\n\n  getTagName(): string {\n    return \"Composition\";\n  }\n}\n\nexport default Composition;\n","import { Classifier } from \"../model\";\n\nclass DataType extends Classifier {\n  getTagName(): string {\n    return \"DataType\";\n  }\n}\n\nexport default DataType;\n","import { LinePattern, Relationship, Tip } from \"../model\";\n\nclass Dependency extends Relationship {\n  toTip: Tip = Tip.ARROW;\n  linePattern: LinePattern = LinePattern.TIGHT_DASHES;\n\n  getTagName(): string {\n    return \"Dependency\";\n  }\n}\n\nexport default Dependency;\n","import { Relationship, Tip } from \"../model\";\n\nclass DirectedAssociation extends Relationship {\n  toTip: Tip = Tip.ARROW;\n\n  getTagName(): string {\n    return \"DirectedAssociation\";\n  }\n}\n\nexport default DirectedAssociation;\n","import { Classifier } from \"../model\";\n\nclass Enumeration extends Classifier {\n  getTagName(): string {\n    return \"Enumeration\";\n  }\n}\n\nexport default Enumeration;\n","import { Relationship, Tip } from \"../model\";\n\nclass Generalization extends Relationship {\n  toTip: Tip = Tip.TRIANGLE;\n\n  getTagName(): string {\n    return \"Generalization\";\n  }\n}\n\nexport default Generalization;\n","import { LinePattern, Relationship, Tip } from \"../model\";\n\nclass Implementation extends Relationship {\n  toTip: Tip = Tip.TRIANGLE;\n  linePattern: LinePattern = LinePattern.TIGHT_DASHES;\n\n  getTagName(): string {\n    return \"Implementation\";\n  }\n}\n\nexport default Implementation;\n","import { Classifier } from \"../model\";\n\nclass Interface extends Classifier {\n  getTagName(): string {\n    return \"Interface\";\n  }\n}\n\nexport default Interface;\n","import { Classifier, Shape } from \"../model\";\n\nclass Note extends Classifier {\n  shape: Shape = Shape.NOTE;\n\n  getTagName(): string {\n    return \"Note\";\n  }\n}\n\nexport default Note;\n","import { Classifier, Shape } from \"../model\";\n\nclass Package extends Classifier {\n  shape: Shape = Shape.FOLDER;\n\n  getTagName(): string {\n    return \"Package\";\n  }\n}\n\nexport default Package;\n","import { Classifier } from \"../model\";\n\nclass Primitive extends Classifier {\n  getTagName(): string {\n    return \"Primitive\";\n  }\n}\n\nexport default Primitive;\n","import FileSerializer from \"./FileSerializer\";\nimport UMLSerializer from \"./UMLSerializer\";\n\nexport const serializer = new UMLSerializer();\nexport const fileSerializer = new FileSerializer();\n","import Serializer from \"./Serializer\";\nimport * as Model from \"../model\";\nimport * as UML from \"../uml\";\n\nclass UMLSerializer extends Serializer {\n  protected parseElementSwitch(element: Element): Model.Element {\n    switch (element.tagName) {\n      case \"Aggregation\":\n        return this.parseRelationship(UML.Aggregation, element);\n      case \"Anchor\":\n        return this.parseRelationship(UML.Anchor, element);\n      case \"Association\":\n        return this.parseRelationship(UML.Association, element);\n      case \"Class\":\n        return this.parseClassifier(UML.Class, element);\n      case \"Component\":\n        return this.parseClassifier(UML.Component, element);\n      case \"Composition\":\n        return this.parseRelationship(UML.Composition, element);\n      case \"DataType\":\n        return this.parseClassifier(UML.DataType, element);\n      case \"Dependency\":\n        return this.parseRelationship(UML.Dependency, element);\n      case \"DirectedAssociation\":\n        return this.parseRelationship(UML.DirectedAssociation, element);\n      case \"Enumeration\":\n        return this.parseClassifier(UML.Enumeration, element);\n      case \"Generalization\":\n        return this.parseRelationship(UML.Generalization, element);\n      case \"Implementation\":\n        return this.parseRelationship(UML.Implementation, element);\n      case \"Interface\":\n        return this.parseClassifier(UML.Interface, element);\n      case \"Note\":\n        return this.parseClassifier(UML.Note, element);\n      case \"Package\":\n        return this.parseClassifier(UML.Package, element);\n      case \"Primitive\":\n        return this.parseClassifier(UML.Primitive, element);\n      default:\n        return super.parseElementSwitch(element);\n    }\n  }\n}\n\nexport default UMLSerializer;\n","const ASCII_LOWER_A = 97;\nconst ASCII_CAPITAL_A = 65;\nconst ASCII_EQ = 61;\nconst ASCII_ZERO = 48;\nconst ASCII_SLASH = 47;\nconst ASCII_PLUS = 43;\n\nconst BASE64_EQ = 0;\nconst BASE64_LOWER_A = 26;\nconst BASE64_ZERO = 52;\nconst BASE64_PLUS = 62;\nconst BASE64_SLASH = 63;\n\nfunction byteToASCII(byte: number): number {\n  const isUpperCaseLetter = byte < BASE64_LOWER_A;\n  if (isUpperCaseLetter) {\n    return byte + ASCII_CAPITAL_A;\n  }\n  const isLowerCaseLetter = byte < BASE64_ZERO;\n  if (isLowerCaseLetter) {\n    return byte - BASE64_LOWER_A + ASCII_LOWER_A;\n  }\n  const isNumber = byte < BASE64_PLUS;\n  if (isNumber) {\n    return byte - BASE64_ZERO + ASCII_ZERO;\n  }\n  if (byte === BASE64_PLUS) {\n    return ASCII_PLUS;\n  } else {\n    return ASCII_SLASH;\n  }\n}\n\nfunction asciiToByte(ascii: number): number {\n  const isLowerCaseLetter = ascii >= ASCII_LOWER_A;\n  if (isLowerCaseLetter) {\n    return ascii - ASCII_LOWER_A + BASE64_LOWER_A;\n  }\n  const isUpperCaseLetter = ascii >= ASCII_CAPITAL_A;\n  if (isUpperCaseLetter) {\n    return ascii - ASCII_CAPITAL_A;\n  }\n  if (ascii === ASCII_EQ) {\n    return BASE64_EQ;\n  }\n  const isNumber = ascii >= ASCII_ZERO;\n  if (isNumber) {\n    return ascii - ASCII_ZERO + BASE64_ZERO;\n  }\n  if (ascii === ASCII_PLUS) {\n    return BASE64_PLUS;\n  } else {\n    return BASE64_SLASH;\n  }\n}\n\nfunction threeToFourBytes(input1: number, input2: number, input3: number): number[] {\n  const output1 = input1 >>> 2;\n  const output2 = ((input1 & 0b11) << 4) | (input2 >>> 4);\n  const output3 = ((input2 & 0b1111) << 2) | (input3 >>> 6);\n  const output4 = input3 & 0b111111;\n  return [output1, output2, output3, output4];\n}\n\nfunction fourToThreeBytes(\n  input1: number,\n  input2: number,\n  input3: number,\n  input4: number,\n): number[] {\n  const output1 = (input1 << 2) | (input2 >>> 4);\n  const output2 = ((input2 & 0b1111) << 4) | (input3 >>> 2);\n  const output3 = ((input3 & 0b11) << 6) | input4;\n  return [output1, output2, output3];\n}\n\nfunction encodeString(output: number[]): string {\n  return String.fromCharCode(...output.map(byteToASCII));\n}\n\nexport function encode(input: Uint8Array): string {\n  const output = [];\n  let i;\n  for (i = 0; i < input.length - 2; i += 3) {\n    output.push(...threeToFourBytes(input[i], input[i + 1], input[i + 2]));\n  }\n\n  if (i === input.length - 2) {\n    output.push(...threeToFourBytes(input[i], input[i + 1], 0));\n    return encodeString(output).slice(0, -1) + \"=\";\n  }\n  if (i === input.length - 1) {\n    output.push(...threeToFourBytes(input[i], 0, 0));\n    return encodeString(output).slice(0, -2) + \"==\";\n  }\n\n  return encodeString(output);\n}\n\nexport function decode(encoded: string): Uint8Array {\n  if (encoded.length % 4 !== 0) {\n    throw new Error(\"Base64 has incorrect length.\");\n  }\n\n  const endsWith2Eq = encoded.slice(-2) === \"==\";\n  const endsWith1Eq = !endsWith2Eq && encoded.slice(-1) === \"=\";\n  const input = new Array(encoded.length)\n    .fill(0)\n    .map((_, i) => encoded.charCodeAt(i))\n    .map(asciiToByte);\n  const output = [];\n  for (let i = 0; i < input.length - 3; i += 4) {\n    output.push(...fourToThreeBytes(input[i], input[i + 1], input[i + 2], input[i + 3]));\n  }\n  if (endsWith2Eq) {\n    return new Uint8Array(output.slice(0, -2));\n  } else if (endsWith1Eq) {\n    return new Uint8Array(output.slice(0, -1));\n  } else {\n    return new Uint8Array(output);\n  }\n}\n","const enc = new TextEncoder();\nconst dec = new TextDecoder();\n\nexport function encode(str: string): Uint8Array {\n  return enc.encode(str);\n}\n\nexport function decode(utf8: Uint8Array): string {\n  return dec.decode(utf8);\n}\n","import { fileSerializer } from \"../serializer\";\nimport { SerializableFile } from \"../utils\";\nimport * as Base64 from \"./base64\";\nimport * as Pako from \"pako\";\nimport * as UTF8 from \"./utf8\";\n\nexport function encode(file: SerializableFile): string {\n  const string = fileSerializer.saveToString(file);\n  const utf8 = UTF8.encode(string);\n  const deflated = Pako.deflate(utf8);\n  return Base64.encode(deflated);\n}\n\nexport function decode(hash: string): SerializableFile {\n  const deflated = Base64.decode(hash);\n  const utf8 = Pako.inflate(deflated);\n  const string = UTF8.decode(utf8);\n  return fileSerializer.loadFromString(string);\n}\n","import { useEffect } from \"react\";\n\nfunction useDocumentTitle(title: string): void {\n  useEffect(() => {\n    document.title = title;\n  }, [title]);\n}\n\nexport default useDocumentTitle;\n","import { useRef } from \"react\";\n\nfunction useId(prefix: string): string {\n  const ref = useRef(`${prefix}-${Math.random().toString(36).substring(2)}`);\n\n  return ref.current!;\n}\n\nexport default useId;\n","import { useEffect, useRef } from \"react\";\n\nfunction useShortcut(shortcut: string | undefined, handler: () => void): void {\n  const ref = useRef(handler);\n\n  useEffect(() => {\n    function keypressHandler(event: KeyboardEvent) {\n      if (shortcut !== undefined && matchesShortcut(shortcut, event)) {\n        event.preventDefault();\n        ref.current();\n      }\n    }\n\n    document.addEventListener(\"keydown\", keypressHandler);\n    return () => {\n      document.removeEventListener(\"keydown\", keypressHandler);\n    };\n  }, [shortcut]);\n\n  useEffect(() => {\n    ref.current = handler;\n  });\n}\n\nfunction matchesShortcut(shortcut: string, event: KeyboardEvent) {\n  let result = true;\n\n  const elements = shortcut.split(\"-\");\n  for (const element of elements) {\n    if (element === \"Ctrl\") {\n      result = result && event.ctrlKey;\n    } else if (element === \"Shift\") {\n      result = result && event.shiftKey;\n    } else if (element === \"Alt\") {\n      result = result && event.altKey;\n    } else if (element === \"Plus\") {\n      result = result && (event.key === \"=\" || event.key === \"+\");\n    } else if (element === \"Minus\") {\n      result = result && event.key === \"-\";\n    } else {\n      result = result && event.key.toLowerCase() === element.toLowerCase();\n    }\n  }\n\n  return result;\n}\n\nexport default useShortcut;\n","class Color {\n  readonly red: number;\n  readonly green: number;\n  readonly blue: number;\n\n  static readonly BLUE = Color.fromHexString(\"#0d6efd\");\n  static readonly INDIGO = Color.fromHexString(\"#6610f2\");\n  static readonly PURPLE = Color.fromHexString(\"#6f42c1\");\n  static readonly PINK = Color.fromHexString(\"#d63384\");\n  static readonly RED = Color.fromHexString(\"#dc3545\");\n  static readonly ORANGE = Color.fromHexString(\"#fd7e14\");\n  static readonly YELLOW = Color.fromHexString(\"#ffc107\");\n  static readonly GREEN = Color.fromHexString(\"#198754\");\n  static readonly TEAL = Color.fromHexString(\"#20c997\");\n  static readonly CYAN = Color.fromHexString(\"#0dcaf0\");\n  static readonly WHITE = Color.fromHexString(\"#ffffff\");\n  static readonly GRAY = Color.fromHexString(\"#6c757d\");\n  static readonly GRAY_DARK = Color.fromHexString(\"#343a40\");\n  static readonly PRIMARY = Color.fromHexString(\"#0d6efd\");\n  static readonly SECONDARY = Color.fromHexString(\"#6c757d\");\n  static readonly SUCCESS = Color.fromHexString(\"#198754\");\n  static readonly INFO = Color.CYAN;\n  static readonly WARNING = Color.YELLOW;\n  static readonly DANGER = Color.RED;\n  static readonly LIGHT = Color.fromHexString(\"#f8f9fa\");\n  static readonly DARK = Color.fromHexString(\"#212529\");\n\n  constructor(red: number, green: number, blue: number) {\n    this.red = Color.sanitizeComponent(red);\n    this.green = Color.sanitizeComponent(green);\n    this.blue = Color.sanitizeComponent(blue);\n  }\n\n  static fromHexString(hexString: string): Color {\n    const red = parseInt(hexString.slice(1, 3), 16);\n    const green = parseInt(hexString.slice(3, 5), 16);\n    const blue = parseInt(hexString.slice(5, 7), 16);\n    return new Color(red, green, blue);\n  }\n\n  private static clamp(min: number, max: number, value: number): number {\n    return value < min ? min : value > max ? max : value;\n  }\n\n  private static sanitizeComponent(value: number): number {\n    const clamped = Color.clamp(0, 255, value);\n    return Math.round(clamped);\n  }\n\n  private static intToHex(value: number): string {\n    return value.toString(16).padStart(2, \"0\");\n  }\n\n  toHexString(): string {\n    return `#${Color.intToHex(this.red)}${Color.intToHex(this.green)}${Color.intToHex(this.blue)}`;\n  }\n\n  mix(other: Color, percentage: number): Color {\n    const otherFactor = Color.clamp(0, 1, percentage);\n    const thisFactor = 1 - otherFactor;\n    const red = thisFactor * this.red + otherFactor * other.red;\n    const green = thisFactor * this.green + otherFactor * other.green;\n    const blue = thisFactor * this.blue + otherFactor * other.blue;\n    return new Color(red, green, blue);\n  }\n}\n\nexport default Color;\n","enum CSSToken {\n  LBRACE,\n  RBRACE,\n  COLON,\n  SEMI,\n  DOT,\n  HASH,\n  COLOR,\n  NUMBER,\n  IDENTIFIER,\n  ERROR,\n}\n\nexport default CSSToken;\n","import Token from \"./Token\";\nimport Tokenizer from \"./Tokenizer\";\n\nabstract class Parser<T, D> {\n  private readonly tokenizer: Tokenizer<T>;\n  private tokens: Token<T>[] = [];\n  private index = 0;\n\n  constructor(tokenizer: Tokenizer<T>) {\n    this.tokenizer = tokenizer;\n  }\n\n  parseFromString(string: string): D {\n    this.index = 0;\n    this.tokens = this.tokenizer.tokenize(string);\n    return this.parse();\n  }\n\n  protected abstract parse(): D;\n\n  protected consume(kind: T): Token<T> {\n    const token = this.tokens[this.index];\n    if (token.kind === kind) {\n      this.index += 1;\n      return token;\n    } else {\n      throw new Error(`Expected ${kind}, but was ${token.kind}`);\n    }\n  }\n\n  protected parseOneOf<U1, U2, U3>(\n    parser1: () => U1,\n    parser2: () => U2,\n    parser3: () => U3,\n  ): U1 | U2 | U3;\n  protected parseOneOf<U1, U2>(parser1: () => U1, parser2: () => U2): U1 | U2;\n  protected parseOneOf<U1>(parser1: () => U1): U1;\n  protected parseOneOf(...parsers: Array<() => unknown>): unknown {\n    for (const parser of parsers) {\n      const value = this.parseOptional(parser);\n      if (value !== undefined) {\n        return value;\n      }\n    }\n\n    throw new Error(\"None of the one ofs matched\");\n  }\n\n  protected parseSet<U>(parser: () => U): Set<U> {\n    const result = new Set<U>();\n    while (true) {\n      const oldIndex = this.index;\n      try {\n        result.add(parser.call(this));\n      } catch (err) {\n        this.index = oldIndex;\n        return result;\n      }\n      const newIndex = this.index;\n      if (newIndex <= oldIndex) {\n        throw new Error(\"Did not consume any tokens\");\n      }\n    }\n  }\n\n  protected parseOptional<U>(parser: () => U): U | undefined {\n    const oldIndex = this.index;\n    let result;\n    try {\n      result = parser.call(this);\n    } catch (err) {\n      this.index = oldIndex;\n      return undefined;\n    }\n\n    const newIndex = this.index;\n    if (newIndex <= oldIndex) {\n      throw new Error(\"Did not consume any tokens\");\n    }\n\n    return result;\n  }\n}\n\nexport default Parser;\n","import Token from \"./Token\";\n\nabstract class Tokenizer<T> {\n  private subject = \"\";\n  private index = 0;\n\n  tokenize(subject: string): Token<T>[] {\n    this.subject = subject;\n    this.index = 0;\n    const tokens = [];\n    while (this.index < this.subject.length) {\n      const oldIndex = this.index;\n      const kind = this.next();\n      const newIndex = this.index;\n      if (newIndex <= oldIndex) {\n        throw new Error(\"Did not consume any characters\");\n      }\n\n      if (kind === null) {\n        continue;\n      }\n\n      const value = this.subject.slice(oldIndex, newIndex);\n      tokens.push({ kind, value });\n    }\n\n    return tokens;\n  }\n\n  protected abstract next(): T | null;\n\n  protected matches(search: RegExp): boolean {\n    const match = this.subject.slice(this.index).match(search);\n    if (match === null) {\n      return false;\n    }\n\n    this.index += match[0].length;\n    return true;\n  }\n\n  protected startsWith(search: string): boolean {\n    if (this.subject.startsWith(search, this.index)) {\n      this.index += search.length;\n      return true;\n    }\n\n    return false;\n  }\n}\n\nexport default Tokenizer;\n","import { Tokenizer } from \"../parsing\";\nimport CSSToken from \"./CSSToken\";\n\nclass CSSTokenizer extends Tokenizer<CSSToken> {\n  protected next(): CSSToken | null {\n    // Whitespace\n    if (this.matches(/^\\s+/)) return null;\n\n    // Comments\n    if (this.matches(/^\\/\\/[^\\r\\n]*/)) return null;\n    if (this.matches(/^\\/\\*.*?\\*\\//)) return null;\n\n    // Literals\n    if (this.matches(/^#[0-9a-fA-F]{6}|^#[0-9a-fA-F]{3}/)) return CSSToken.COLOR;\n    if (this.matches(/^\\d+(\\.\\d*)?|^\\.\\d+/)) return CSSToken.NUMBER;\n\n    // Operators\n    if (this.startsWith(\"{\")) return CSSToken.LBRACE;\n    if (this.startsWith(\"}\")) return CSSToken.RBRACE;\n    if (this.startsWith(\":\")) return CSSToken.COLON;\n    if (this.startsWith(\";\")) return CSSToken.SEMI;\n    if (this.startsWith(\".\")) return CSSToken.DOT;\n    if (this.startsWith(\"#\")) return CSSToken.HASH;\n\n    if (this.matches(/^[a-zA-Z]+(-[a-zA-Z]+)*/)) return CSSToken.IDENTIFIER;\n\n    // Fallback\n    this.matches(/^./);\n    return CSSToken.ERROR;\n  }\n}\n\nexport default CSSTokenizer;\n","class Property {\n  readonly key: string;\n  readonly value: unknown;\n\n  constructor(key: string, value: unknown) {\n    this.key = key;\n    this.value = value;\n  }\n}\n\nexport default Property;\n","import Color from \"./Color\";\nimport Property from \"./Property\";\n\nclass PropertyMap implements Iterable<[string, unknown]> {\n  protected readonly map: Map<string, unknown>;\n\n  constructor(properties = new Set<Property>()) {\n    this.map = new Map<string, unknown>(\n      [...properties].map((property) => [property.key, property.value] as const),\n    );\n  }\n\n  [Symbol.iterator](): Iterator<[string, unknown]> {\n    return this.map.entries();\n  }\n\n  addAll(map: PropertyMap): this {\n    for (const [key, value] of map) {\n      this.map.set(key, value);\n    }\n    return this;\n  }\n\n  getString(key: string, fallback: string): string {\n    const value = this.map.get(key);\n    if (typeof value === \"string\") {\n      return value;\n    }\n\n    return fallback;\n  }\n\n  getColor(key: string, fallback: Color): Color {\n    const value = this.map.get(key);\n    if (value instanceof Color) {\n      return value;\n    }\n\n    return fallback;\n  }\n\n  getFloat(key: string, fallback: number): number {\n    const value = this.map.get(key);\n    if (typeof value === \"number\") {\n      return value;\n    }\n\n    return fallback;\n  }\n}\n\nexport default PropertyMap;\n","import PropertyMap from \"./PropertyMap\";\nimport Rule from \"./Rule\";\n\nclass Style {\n  readonly rules: Set<Rule>;\n\n  constructor(rules = new Set<Rule>()) {\n    this.rules = rules;\n  }\n\n  getProperties(context: string[]): PropertyMap {\n    const result = new PropertyMap();\n    const [head, ...tail] = context;\n    const hasTail = tail.length > 0;\n    for (const rule of this.rules) {\n      if (rule.selector.tag === head) {\n        const properties = new PropertyMap(rule.properties);\n        if (hasTail) {\n          properties.addAll(this.getProperties(tail));\n          properties.addAll(rule.getProperties(tail));\n        }\n        result.addAll(properties);\n      }\n    }\n\n    return result;\n  }\n}\n\nexport default Style;\n","import Style from \"./Style\";\nimport Property from \"./Property\";\nimport Selector from \"./Selector\";\n\nclass Rule extends Style {\n  readonly selector: Selector;\n  readonly properties: Set<Property>;\n\n  constructor(selector: Selector, properties: Set<Property>, rules: Set<Rule>) {\n    super(rules);\n    this.selector = selector;\n    this.properties = properties;\n  }\n}\n\nexport default Rule;\n","class Selector {\n  readonly tag: string;\n  readonly classes: Set<string>;\n  readonly id?: string;\n\n  constructor(tag: string, classes: Set<string>, id?: string) {\n    this.tag = tag;\n    this.classes = classes;\n    this.id = id;\n  }\n}\n\nexport default Selector;\n","import Color from \"./Color\";\nimport CSSParser from \"./CSSParser\";\nimport Property from \"./Property\";\nimport PropertyMap from \"./PropertyMap\";\nimport Rule from \"./Rule\";\nimport Selector from \"./Selector\";\nimport Style from \"./Style\";\n\nexport { Color, CSSParser, Property, PropertyMap, Rule, Selector, Style };\n\nexport const parser = new CSSParser();\n","import { Parser } from \"../parsing\";\nimport Color from \"./Color\";\nimport CSSToken from \"./CSSToken\";\nimport CSSTokenizer from \"./CSSTokenizer\";\nimport Property from \"./Property\";\nimport Rule from \"./Rule\";\nimport Selector from \"./Selector\";\nimport Style from \"./Style\";\n\nclass CSSParser extends Parser<CSSToken, Style> {\n  constructor() {\n    super(new CSSTokenizer());\n  }\n\n  protected parse(): Style {\n    return new Style(this.parseRuleSet());\n  }\n\n  private parseRuleSet(): Set<Rule> {\n    return this.parseSet(this.parseRule);\n  }\n\n  protected parseRule(): Rule {\n    const selector = this.parseSelector();\n    this.consume(CSSToken.LBRACE);\n    const properties = this.parsePropertySet();\n    const rules = this.parseRuleSet();\n    this.consume(CSSToken.RBRACE);\n\n    return new Rule(selector, properties, rules);\n  }\n\n  private parseSelector(): Selector {\n    const tag = this.consume(CSSToken.IDENTIFIER);\n    const classes = this.parseClassSet();\n    const id = this.parseOptionalId();\n\n    return new Selector(tag.value, classes, id);\n  }\n\n  private parsePropertySet(): Set<Property> {\n    return this.parseSet(this.parseProperty);\n  }\n\n  private parseProperty(): Property {\n    const key = this.parseIdentifier();\n    this.consume(CSSToken.COLON);\n\n    const value = this.parseOneOf(this.parseColor, this.parseNumber, this.parseIdentifierValue);\n    this.consume(CSSToken.SEMI);\n\n    return new Property(key, value);\n  }\n\n  private parseClassSet(): Set<string> {\n    return this.parseSet(this.parseClass);\n  }\n\n  private parseClass(): string {\n    this.consume(CSSToken.DOT);\n    const className = this.consume(CSSToken.IDENTIFIER);\n    return className.value;\n  }\n\n  private parseOptionalId(): string | undefined {\n    return this.parseOptional(this.parseId);\n  }\n\n  private parseId(): string {\n    this.consume(CSSToken.HASH);\n    const id = this.consume(CSSToken.IDENTIFIER);\n    return id.value;\n  }\n\n  private parseColor(): Color {\n    const color = this.consume(CSSToken.COLOR);\n    return Color.fromHexString(color.value);\n  }\n\n  private parseNumber(): number {\n    const number = this.consume(CSSToken.NUMBER);\n    return parseFloat(number.value);\n  }\n\n  private parseIdentifierValue(): string | Color {\n    const identifier = this.parseIdentifier();\n    switch (identifier) {\n      case \"blue\":\n        return Color.BLUE;\n      case \"indigo\":\n        return Color.INDIGO;\n      case \"purple\":\n        return Color.PURPLE;\n      case \"pink\":\n        return Color.PINK;\n      case \"red\":\n        return Color.RED;\n      case \"orange\":\n        return Color.ORANGE;\n      case \"yellow\":\n        return Color.YELLOW;\n      case \"green\":\n        return Color.GREEN;\n      case \"teal\":\n        return Color.TEAL;\n      case \"cyan\":\n        return Color.CYAN;\n      case \"white\":\n        return Color.WHITE;\n      case \"gray\":\n        return Color.GRAY;\n      case \"gray-dark\":\n        return Color.GRAY_DARK;\n      case \"primary\":\n        return Color.PRIMARY;\n      case \"secondary\":\n        return Color.SECONDARY;\n      case \"success\":\n        return Color.SUCCESS;\n      case \"info\":\n        return Color.INFO;\n      case \"warning\":\n        return Color.WARNING;\n      case \"danger\":\n        return Color.DANGER;\n      case \"light\":\n        return Color.LIGHT;\n      case \"dark\":\n        return Color.DARK;\n      default:\n        return identifier;\n    }\n  }\n\n  private parseIdentifier(): string {\n    const identifier = this.consume(CSSToken.IDENTIFIER);\n    return identifier.value;\n  }\n}\n\nexport default CSSParser;\n","import { StoreonStore } from \"storeon\";\nimport { LOCALES } from \"../constants\";\nimport { Locale, storageAvailable } from \"../utils\";\n\nexport interface LocaleState {\n  locale: Locale;\n}\n\nexport interface LocaleEvents {\n  \"locale/change\": Locale;\n}\n\nfunction normalizeLocale(locale: string): Locale {\n  const prefix = locale.slice(0, 2).toLowerCase() as Locale;\n  if (LOCALES.includes(prefix)) {\n    return prefix;\n  } else {\n    return Locale.ENGLISH;\n  }\n}\n\nfunction loadLocale(): string {\n  if (storageAvailable()) {\n    const storedLocale = localStorage.getItem(\"locale\");\n    if (storedLocale !== null) {\n      return storedLocale;\n    }\n  }\n\n  if (typeof navigator.language === \"string\") {\n    return navigator.language;\n  }\n\n  return Locale.ENGLISH;\n}\n\nfunction storeLocale(locale: string): void {\n  if (storageAvailable()) {\n    localStorage.setItem(\"locale\", locale);\n  }\n}\n\nexport function locale(store: StoreonStore<LocaleState, LocaleEvents>): void {\n  store.on(\"@init\", () => ({ locale: normalizeLocale(loadLocale()) }));\n\n  store.on(\"locale/change\", (state, locale) => {\n    storeLocale(locale);\n    return { ...state, locale };\n  });\n}\n","import { StoreonStore } from \"storeon\";\nimport { storageAvailable } from \"../utils\";\n\nexport interface ViewState {\n  grid: boolean;\n  positionX: number;\n  positionY: number;\n  zoom: number;\n}\n\nexport interface ViewEvents {\n  \"view/moveLeft\": undefined;\n  \"view/moveRight\": undefined;\n  \"view/moveUp\": undefined;\n  \"view/moveDown\": undefined;\n\n  \"view/zoomIn\": undefined;\n  \"view/zoomOut\": undefined;\n  \"view/zoomReset\": undefined;\n\n  \"view/grid\": boolean;\n  \"view/positionX\": number;\n  \"view/positionY\": number;\n  \"view/zoom\": number;\n}\n\nfunction loadView(): Partial<ViewState> {\n  if (storageAvailable()) {\n    const item = localStorage.getItem(\"view\");\n    if (item !== null) return JSON.parse(item);\n  }\n\n  return {};\n}\n\nfunction storeView(state: ViewState): ViewState {\n  if (storageAvailable()) {\n    localStorage.setItem(\n      \"view\",\n      JSON.stringify({\n        grid: state.grid,\n        positionX: state.positionX,\n        positionY: state.positionY,\n        zoom: state.zoom,\n      }),\n    );\n  }\n  return state;\n}\n\nexport function view(store: StoreonStore<ViewState, ViewEvents>) {\n  const MOVE_BY = 50;\n  const ZOOM_LEVELS = [0.25, 0.5, 0.75, 1.0, 1.25, 1.5, 2, 3];\n\n  store.on(\n    \"@init\",\n    (): ViewState => {\n      const { grid = false, positionX = 0, positionY = 0, zoom = 1 } = loadView();\n      return { grid, positionX, positionY, zoom };\n    },\n  );\n\n  store.on(\"view/moveLeft\", (prevState) => {\n    store.dispatch(\"view/positionX\", prevState.positionX + MOVE_BY);\n  });\n\n  store.on(\"view/moveRight\", (prevState) => {\n    store.dispatch(\"view/positionX\", prevState.positionX - MOVE_BY);\n  });\n\n  store.on(\"view/moveUp\", (prevState) => {\n    store.dispatch(\"view/positionY\", prevState.positionY + MOVE_BY);\n  });\n\n  store.on(\"view/moveDown\", (prevState) => {\n    store.dispatch(\"view/positionY\", prevState.positionY - MOVE_BY);\n  });\n\n  store.on(\"view/zoomIn\", ({ zoom }) => {\n    const index = ZOOM_LEVELS.indexOf(zoom);\n    if (index + 1 < ZOOM_LEVELS.length) {\n      store.dispatch(\"view/zoom\", ZOOM_LEVELS[index + 1]);\n    }\n  });\n\n  store.on(\"view/zoomOut\", ({ zoom }) => {\n    const index = ZOOM_LEVELS.indexOf(zoom);\n    if (index > 0) {\n      store.dispatch(\"view/zoom\", ZOOM_LEVELS[index - 1]);\n    }\n  });\n\n  store.on(\"view/zoomReset\", () => {\n    store.dispatch(\"view/zoom\", 1);\n  });\n\n  store.on(\"view/grid\", (prevState, grid) => {\n    return storeView({ ...prevState, grid });\n  });\n\n  store.on(\"view/positionX\", (prevState, positionX) => {\n    return storeView({ ...prevState, positionX });\n  });\n\n  store.on(\"view/positionY\", (prevState, positionY) => {\n    return storeView({ ...prevState, positionY });\n  });\n\n  store.on(\"view/zoom\", (prevState, zoom) => {\n    return storeView({ ...prevState, zoom });\n  });\n}\n","import React, { ReactNode } from \"react\";\nimport { createStoreon } from \"storeon\";\nimport { StoreContext, useStoreon } from \"storeon/react\";\nimport { file, FileEvents, FileState } from \"./file\";\nimport { locale, LocaleEvents, LocaleState } from \"./locale\";\nimport { view, ViewEvents, ViewState } from \"./view\";\n\ntype State = FileState & LocaleState & ViewState;\n\ntype Events = FileEvents & LocaleEvents & ViewEvents;\n\nexport function useStore(...keys: (keyof State)[]) {\n  return useStoreon<State, Events>(...keys);\n}\n\ninterface Props {\n  children: ReactNode;\n}\n\nconst store = createStoreon<State, Events>([file, locale, view]);\n\nexport function Store({ children }: Props) {\n  return React.createElement(StoreContext.Provider, { value: store }, children);\n}\n","import { StoreonStore } from \"storeon\";\nimport { parser, Style } from \"../css\";\nimport { Diagram, Element } from \"../model\";\nimport { serializer } from \"../serializer\";\n\nexport interface FileState {\n  title: string;\n  model: Diagram;\n  style: Style;\n  xml: string;\n  css: string;\n}\n\nexport interface FileEvents {\n  \"file/load\": { title: string; css: string; xml: string };\n  \"file/xml\": string;\n  \"file/css\": string;\n  \"file/title\": string;\n  \"file/model\": Element;\n  \"file/add\": Element;\n  \"file/delete\": Element;\n}\n\nexport function file(store: StoreonStore<FileState, FileEvents>) {\n  store.on(\"@init\", () => ({\n    title: \"\",\n    xml: \"\",\n    css: \"\",\n    model: new Diagram(),\n    style: new Style(),\n  }));\n\n  store.on(\"file/load\", (state, { xml, css, title }) => {\n    store.dispatch(\"file/xml\", xml);\n    store.dispatch(\"file/css\", css);\n    store.dispatch(\"file/title\", title);\n  });\n\n  store.on(\"file/add\", (state, element) => {\n    state.model.addChild(element);\n    store.dispatch(\"file/model\", state.model);\n  });\n\n  store.on(\"file/delete\", (state, element) => {\n    state.model.deleteChild(element);\n    store.dispatch(\"file/model\", state.model);\n  });\n\n  store.on(\"file/xml\", (state, xml) => {\n    const model = serializer.deserialize(xml);\n    return { ...state, xml, model };\n  });\n\n  store.on(\"file/css\", (state, css) => {\n    const style = parser.parseFromString(css);\n    return { ...state, css, style };\n  });\n\n  store.on(\"file/title\", (state, title) => ({ ...state, title }));\n\n  store.on(\"file/model\", (state, element) => {\n    serializer.updateElement(element);\n    const xml = serializer.serialize(state.model);\n    return { ...state, xml };\n  });\n}\n","import { ReactNode } from \"react\";\n\ninterface Props {\n  children?: ReactNode;\n}\n\nfunction ContainerFluid({ children }: Props) {\n  return <div className=\"container-fluid\">{children}</div>;\n}\n\nexport default ContainerFluid;\n","function DropdownDivider() {\n  return (\n    <li>\n      <hr className=\"dropdown-divider\" />\n    </li>\n  );\n}\n\nexport default DropdownDivider;\n","import { useIntl } from \"react-intl\";\n\ninterface Props {\n  shortcut: string;\n}\n\nfunction Shortcut({ shortcut }: Props) {\n  const intl = useIntl();\n  const parts = new Map([\n    [\"Alt\", intl.formatMessage({ id: \"shortcut.alt\", defaultMessage: \"Alt\" })],\n    [\"ArrowLeft\", intl.formatMessage({ id: \"shortcut.arrowLeft\", defaultMessage: \"Left\" })],\n    [\"ArrowRight\", intl.formatMessage({ id: \"shortcut.arrowRight\", defaultMessage: \"Right\" })],\n    [\"ArrowUp\", intl.formatMessage({ id: \"shortcut.arrowUp\", defaultMessage: \"Up\" })],\n    [\"ArrowDown\", intl.formatMessage({ id: \"shortcut.arrowDown\", defaultMessage: \"Down\" })],\n    [\"Ctrl\", intl.formatMessage({ id: \"shortcut.ctrl\", defaultMessage: \"Ctrl\" })],\n    [\"Delete\", intl.formatMessage({ id: \"shortcut.delete\", defaultMessage: \"Delete\" })],\n    [\"Minus\", intl.formatMessage({ id: \"shortcut.minus\", defaultMessage: \"Minus\" })],\n    [\"Plus\", intl.formatMessage({ id: \"shortcut.plus\", defaultMessage: \"Plus\" })],\n    [\"Shift\", intl.formatMessage({ id: \"shortcut.shift\", defaultMessage: \"Shift\" })],\n  ]);\n\n  const text = shortcut\n    .split(\"-\")\n    .map((part) => parts.get(part) ?? part)\n    .join(\" \");\n\n  return <span className=\"text-muted float-end\">{text}</span>;\n}\n\nexport default Shortcut;\n","import classNames from \"classnames\";\nimport { MouseEvent, ReactNode } from \"react\";\nimport { useShortcut } from \"../../hooks\";\nimport Shortcut from \"./Shortcut\";\n\ninterface Props {\n  onClick?: () => void;\n  shortcut?: string;\n  active?: boolean;\n  children?: ReactNode;\n}\n\nfunction DropdownItem({ onClick, shortcut, active, children }: Props) {\n  function handleClick(event: MouseEvent) {\n    event.preventDefault();\n    onClick?.();\n  }\n\n  useShortcut(shortcut, () => {\n    onClick?.();\n  });\n\n  return (\n    <li>\n      <button\n        onClick={handleClick}\n        className={classNames(\"btn btn-link dropdown-item\", { active })}\n      >\n        {children}\n        {shortcut && <Shortcut shortcut={shortcut} />}\n      </button>\n    </li>\n  );\n}\n\nexport default DropdownItem;\n","import classNames from \"classnames\";\nimport { ReactNode } from \"react\";\n\ninterface Props {\n  placement?: string;\n  labelledBy: string;\n  children?: ReactNode;\n}\n\nfunction DropdownMenu({ placement = \"start\", labelledBy, children }: Props) {\n  return (\n    <ul\n      className={classNames(\"dropdown-menu\", `dropdown-menu-${placement}`)}\n      aria-labelledby={labelledBy}\n    >\n      {children}\n    </ul>\n  );\n}\n\nexport default DropdownMenu;\n","import { Dropdown } from \"bootstrap\";\nimport classNames from \"classnames\";\nimport { ReactNode, useRef } from \"react\";\n\ninterface Props {\n  id?: string;\n  className?: string;\n  children?: ReactNode;\n}\n\nfunction DropdownToggle({ id, className, children }: Props) {\n  const dropdown = useRef<Dropdown | null>(null);\n\n  function handleRef(element: HTMLButtonElement | null): void {\n    if (element === null) {\n      dropdown.current?.dispose();\n      dropdown.current = null;\n    } else {\n      dropdown.current = new Dropdown(element);\n    }\n  }\n\n  return (\n    <button\n      id={id}\n      ref={handleRef}\n      aria-expanded=\"false\"\n      data-bs-toggle=\"dropdown\"\n      className={classNames(\"btn\", \"btn-link\", \"dropdown-toggle\", className)}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default DropdownToggle;\n","import CodeMirror from \"codemirror\";\nimport { MutableRefObject, useEffect, useRef } from \"react\";\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/addon/hint/show-hint\";\nimport \"codemirror/addon/hint/xml-hint\";\nimport \"codemirror/addon/comment/comment\";\nimport \"codemirror/addon/edit/matchtags\";\nimport \"codemirror/mode/xml/xml\";\nimport \"codemirror/mode/css/css\";\nimport \"codemirror/theme/nord.css\";\nimport \"codemirror/addon/hint/show-hint.css\";\nimport \"./Editor.css\";\n\ninterface Props {\n  language: \"css\" | \"xml\";\n  value: string;\n  schema?: any;\n  onChange?: (value: string) => void;\n}\n\nfunction completeAfter(cm: CodeMirror.Editor, pred?: () => boolean) {\n  if (pred?.())\n    setTimeout(() => {\n      if (!cm.state.completionActive) cm.showHint({ completeSingle: false });\n    }, 100);\n  return CodeMirror.Pass;\n}\n\nfunction completeIfAfterLt(cm: CodeMirror.Editor) {\n  return completeAfter(cm, () => {\n    const cur = cm.getCursor();\n    return cm.getRange(CodeMirror.Pos(cur.line, cur.ch - 1), cur) === \"<\";\n  });\n}\n\nfunction completeIfInTag(cm: CodeMirror.Editor) {\n  return completeAfter(cm, () => {\n    const tok = cm.getTokenAt(cm.getCursor());\n    if (\n      tok.type === \"string\" &&\n      (!/['\"]/.test(tok.string.charAt(tok.string.length - 1)) || tok.string.length === 1)\n    )\n      return false;\n    const inner = CodeMirror.innerMode(cm.getMode(), tok.state).state;\n    return inner.tagName;\n  });\n}\n\nfunction Editor({ language, value, schema, onChange }: Props) {\n  const onChangeRef = useRef(onChange);\n  const ref = useRef<HTMLTextAreaElement>(null);\n  const editor = useRef<CodeMirror.Editor>(null) as MutableRefObject<CodeMirror.Editor>;\n\n  useEffect(() => {\n    onChangeRef.current = onChange;\n  }, [onChange]);\n\n  useEffect(() => {\n    const mode = language === \"xml\" ? \"xml\" : \"text/x-scss\";\n    const hintOptions = { schemaInfo: schema } as any;\n    const codeMirror = CodeMirror.fromTextArea(ref.current!, {\n      mode,\n      lineNumbers: true,\n      theme: \"nord\",\n      matchTags: true,\n      autocorrect: true,\n      tabSize: 2,\n      extraKeys: {\n        \"'<'\": completeAfter,\n        \"'/'\": completeIfAfterLt,\n        \"' '\": completeIfInTag,\n        \"'='\": completeIfInTag,\n        \"Ctrl-Space\": \"autocomplete\",\n        \"Ctrl-/\": \"toggleComment\",\n      },\n      hintOptions,\n    });\n    editor.current = codeMirror;\n\n    return () => {\n      codeMirror.toTextArea();\n    };\n  }, [language, schema]);\n\n  useEffect(() => {\n    if (editor.current!.getValue() !== value) {\n      editor.current!.setValue(value);\n    }\n\n    function handleKeyDown(event: KeyboardEvent) {\n      if (event.key.includes(\"Arrow\")) {\n        event.stopPropagation();\n      }\n    }\n\n    function handleChange() {\n      const newValue = editor.current!.getValue();\n      if (newValue !== value) {\n        onChangeRef.current?.(newValue);\n      }\n    }\n\n    editor.current!.getWrapperElement().addEventListener(\"keydown\", handleKeyDown);\n    editor.current!.on(\"change\", handleChange);\n    return () => {\n      editor.current!.getWrapperElement().removeEventListener(\"keydown\", handleKeyDown);\n      editor.current!.off(\"change\", handleChange);\n    };\n  }, [value]);\n\n  return <textarea ref={ref} defaultValue={value} />;\n}\n\nexport default Editor;\n","import { ReactNode } from \"react\";\n\ninterface Props {\n  href: string;\n  className?: string;\n  children?: ReactNode;\n}\n\nfunction ExternalLink({ href, className, children }: Props) {\n  return (\n    <a href={href} className={className} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </a>\n  );\n}\n\nexport default ExternalLink;\n","import classNames from \"classnames\";\nimport \"./Flag.css\";\n\ninterface Props {\n  country: string;\n}\n\nfunction Flag({ country }: Props) {\n  return <span className={classNames(\"Flag me-2\", country)} />;\n}\n\nexport default Flag;\n","import iconUrl from \"bootstrap-icons/bootstrap-icons.svg\";\nimport { Color } from \"../../css\";\nimport \"./Icon.css\";\n\ninterface Props {\n  name: string;\n  color?: Color;\n  size?: number;\n}\n\nfunction Icon({ name, color = Color.DARK, size = 20 }: Props) {\n  return (\n    <svg className=\"Icon me-2\" width={size} height={size} fill={color.toHexString()}>\n      <use xlinkHref={`${iconUrl}#${name}`} />\n    </svg>\n  );\n}\n\nexport default Icon;\n","export default __webpack_public_path__ + \"static/media/logo.4da087a9.png\";","import { ReactNode } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport ContainerFluid from \"./ContainerFluid\";\nimport logo from \"./logo.png\";\n\ninterface Props {\n  children?: ReactNode;\n}\n\nfunction MenuBar({ children }: Props) {\n  return (\n    <nav className=\"navbar navbar-expand-lg navbar-dark bg-dark\" style={{ gridArea: \"menu\" }}>\n      <ContainerFluid>\n        <span className=\"navbar-brand\">\n          <img alt=\"Logo\" src={logo} height={32} width={32} className=\"d-inline-block align-top\" />{\" \"}\n          <FormattedMessage id=\"title\" defaultMessage=\"UML Editor\" />\n        </span>\n        <ul className=\"navbar-nav me-auto d-flex flex-grow-1\">{children}</ul>\n      </ContainerFluid>\n    </nav>\n  );\n}\n\nexport default MenuBar;\n","import classNames from \"classnames\";\nimport { ReactNode } from \"react\";\n\ninterface Props {\n  className?: string;\n  children?: ReactNode;\n}\n\nfunction NavItem({ className, children }: Props) {\n  return <li className={classNames(\"nav-item\", className)}>{children}</li>;\n}\n\nexport default NavItem;\n","import classNames from \"classnames\";\nimport { ReactNode } from \"react\";\nimport { useId } from \"../../hooks\";\nimport DropdownMenu from \"./DropdownMenu\";\nimport DropdownToggle from \"./DropdownToggle\";\nimport NavItem from \"./NavItem\";\n\ninterface Props {\n  active?: boolean;\n  placement?: string;\n  title: ReactNode;\n  children?: ReactNode;\n}\n\nfunction Menu({ active = false, placement, title, children }: Props) {\n  const id = useId(\"Menu\");\n\n  return (\n    <NavItem className=\"dropdown\">\n      <DropdownToggle id={id} className={classNames(\"nav-link\", { active })}>\n        {title}\n      </DropdownToggle>\n      <DropdownMenu placement={placement} labelledBy={id}>\n        {children}\n      </DropdownMenu>\n    </NavItem>\n  );\n}\n\nexport default Menu;\n","import { Dispatch } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Element, Relationship } from \"../../model\";\nimport { File } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  file: File;\n  onDeleteElement: Dispatch<Element>;\n}\n\nfunction DeleteElement({ file, onDeleteElement }: Props) {\n  function handleClick(): void {\n    for (const element of file.model) {\n      if (element.isSelected()) {\n        onDeleteElement(element);\n      } else if (element instanceof Relationship) {\n        if (element.to.isSelected() || element.from.isSelected()) {\n          onDeleteElement(element);\n        }\n      }\n    }\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Delete\">\n      <Icon name=\"file-x\" /> <FormattedMessage id=\"edit.delete\" defaultMessage=\"Delete\" />\n    </DropdownItem>\n  );\n}\n\nexport default DeleteElement;\n","import { Dispatch } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { Element } from \"../../model\";\nimport { File } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  file: File;\n  onAddElement: Dispatch<Element>;\n}\n\nfunction DuplicateElement({ file, onAddElement }: Props) {\n  function handleClick(): void {\n    const elementsToDuplicate = new Set<Element>();\n    for (const element of file.model) {\n      if (element.isSelected()) {\n        elementsToDuplicate.add(element);\n        element.setSelected(false);\n      }\n    }\n\n    for (const element of elementsToDuplicate) {\n      const clone = element.clone();\n      clone.setSelected(true);\n      for (const child of element.getChildren()) {\n        const childClone = child.clone();\n        clone.addChild(childClone);\n      }\n      onAddElement(clone);\n    }\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-D\">\n      <Icon name=\"files\" /> <FormattedMessage id=\"edit.duplicate\" defaultMessage=\"Duplicate\" />\n    </DropdownItem>\n  );\n}\n\nexport default DuplicateElement;\n","import { Dispatch } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { INITIAL_CSS, INITIAL_XML } from \"../../constants\";\nimport { SerializableFile } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onFileChange: Dispatch<SerializableFile>;\n}\n\nfunction FileNew({ onFileChange }: Props) {\n  const intl = useIntl();\n\n  function handleClick() {\n    const untitled = intl.formatMessage({ id: \"untitled\", defaultMessage: \"Untitled\" });\n    const message = intl.formatMessage({\n      id: \"file.new.message\",\n      defaultMessage: \"Choose a title for the new document\",\n    });\n    const title = window.prompt(message, untitled);\n    if (title !== null) {\n      onFileChange({\n        title,\n        css: INITIAL_CSS,\n        xml: INITIAL_XML,\n      });\n    }\n  }\n\n  return (\n    <DropdownItem onClick={handleClick}>\n      <Icon name=\"file-earmark-plus\" /> <FormattedMessage id=\"file.new\" defaultMessage=\"New ...\" />\n    </DropdownItem>\n  );\n}\n\nexport default FileNew;\n","import { Dispatch } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { fileSerializer } from \"../../serializer\";\nimport { SerializableFile, uploadFile } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onFileChange: Dispatch<SerializableFile>;\n}\n\nfunction FileOpen({ onFileChange }: Props) {\n  function handleClick() {\n    uploadFile(\".uml\").then((content) => {\n      const file = fileSerializer.loadFromString(content);\n      onFileChange(file);\n    });\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-O\">\n      <Icon name=\"folder\" /> <FormattedMessage id=\"file.open\" defaultMessage=\"Open ...\" />\n    </DropdownItem>\n  );\n}\n\nexport default FileOpen;\n","import { Dispatch } from \"react\";\nimport { FormattedMessage, useIntl } from \"react-intl\";\nimport { File } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  file: File;\n  onTitleChange: Dispatch<string>;\n}\n\nfunction FileRename({ file, onTitleChange }: Props) {\n  const intl = useIntl();\n\n  function handleClick(): void {\n    const message = intl.formatMessage({\n      id: \"file.rename.message\",\n      defaultMessage: \"New document title\",\n    });\n    const newTitle = window.prompt(message, file.title);\n    if (newTitle !== null) {\n      onTitleChange(newTitle);\n    }\n  }\n\n  return (\n    <DropdownItem onClick={handleClick}>\n      <Icon name=\"pencil\" />{\" \"}\n      <FormattedMessage\n        id=\"file.rename\"\n        defaultMessage='Rename \"{title}\" ...'\n        values={{ title: file.title }}\n      />\n    </DropdownItem>\n  );\n}\n\nexport default FileRename;\n","import { FormattedMessage } from \"react-intl\";\nimport { fileSerializer } from \"../../serializer\";\nimport { downloadFile, File, sanitizeFilename } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  file: File;\n}\n\nfunction FileSave({ file }: Props) {\n  function handleClick() {\n    const content = btoa(fileSerializer.saveToString(file));\n    const url = new URL(`data:text/x-uml;base64,${content}`);\n\n    downloadFile(`${sanitizeFilename(file.title)}.uml`, url.toString());\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-S\">\n      <Icon name=\"cloud-download\" /> <FormattedMessage id=\"file.save\" defaultMessage=\"Save ...\" />\n    </DropdownItem>\n  );\n}\n\nexport default FileSave;\n","import { Dispatch } from \"react\";\nimport { useIntl } from \"react-intl\";\nimport { Locale } from \"../../utils\";\nimport { DropdownItem, Flag } from \"../blocks\";\n\ninterface Props {\n  locale: Locale;\n  name: string;\n  country?: string;\n  onChange: Dispatch<Locale>;\n}\n\nfunction LocaleItem({ locale, name, country = locale, onChange }: Props) {\n  const intl = useIntl();\n\n  return (\n    <DropdownItem active={intl.locale === locale} onClick={() => onChange(locale)}>\n      <Flag country={country} /> {name}\n    </DropdownItem>\n  );\n}\n\nexport default LocaleItem;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onMove: DispatchWithoutAction;\n}\n\nfunction MoveDown({ onMove }: Props) {\n  function handleClick() {\n    onMove();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"ArrowDown\">\n      <Icon name=\"arrow-down-square\" />{\" \"}\n      <FormattedMessage id=\"view.moveDown\" defaultMessage=\"Move Down\" />\n    </DropdownItem>\n  );\n}\n\nexport default MoveDown;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onMove: DispatchWithoutAction;\n}\n\nfunction MoveLeft({ onMove }: Props) {\n  function handleClick() {\n    onMove();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"ArrowLeft\">\n      <Icon name=\"arrow-left-square\" />{\" \"}\n      <FormattedMessage id=\"view.moveLeft\" defaultMessage=\"Move Left\" />\n    </DropdownItem>\n  );\n}\n\nexport default MoveLeft;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onMove: DispatchWithoutAction;\n}\n\nfunction MoveRight({ onMove }: Props) {\n  function handleClick() {\n    onMove();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"ArrowRight\">\n      <Icon name=\"arrow-right-square\" />{\" \"}\n      <FormattedMessage id=\"view.moveRight\" defaultMessage=\"Move Right\" />\n    </DropdownItem>\n  );\n}\n\nexport default MoveRight;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onMove: DispatchWithoutAction;\n}\n\nfunction MoveUp({ onMove }: Props) {\n  function handleClick() {\n    onMove();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"ArrowUp\">\n      <Icon name=\"arrow-up-square\" /> <FormattedMessage id=\"view.moveUp\" defaultMessage=\"Move Up\" />\n    </DropdownItem>\n  );\n}\n\nexport default MoveUp;\n","import { Rectangle, Shape } from \"../model\";\nimport Canvas from \"./Canvas\";\n\nclass ShapeRenderer {\n  private readonly canvas: Canvas;\n\n  constructor(canvas: Canvas) {\n    this.canvas = canvas;\n  }\n\n  renderShape(shape: Shape, rectangle: Rectangle): void {\n    switch (shape) {\n      case Shape.RECTANGLE:\n        this.drawRectangleShape(rectangle);\n        return;\n      case Shape.ELLIPSE:\n        this.drawEllipseShape(rectangle);\n        return;\n      case Shape.FOLDER:\n        this.drawFolderShape(rectangle);\n        return;\n      case Shape.NOTE:\n        this.drawNoteShape(rectangle);\n        return;\n      case Shape.BOX:\n        this.drawBoxShape(rectangle);\n        return;\n      case Shape.FILE:\n        this.drawFileShape(rectangle);\n        return;\n      case Shape.COMPONENT:\n        this.drawComponentShape(rectangle);\n        return;\n    }\n  }\n\n  private drawRectangleShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    this.canvas.rect(x, y, width, height);\n  }\n\n  private drawEllipseShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    this.canvas.ellipse(x, y, width, height);\n  }\n\n  private drawFolderShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    const FOLDER_WIDTH = 80;\n    const FOLDER_HEIGHT = 20;\n    this.canvas.rect(x, y - FOLDER_HEIGHT, FOLDER_WIDTH, FOLDER_HEIGHT);\n    this.canvas.rect(x, y, width, height);\n  }\n\n  private drawNoteShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    const NOTE_SIZE = 30;\n    this.canvas.moveTo(x, y);\n    this.canvas.lineTo(x, y + height);\n    this.canvas.lineTo(x + width - NOTE_SIZE, y + height);\n    this.canvas.lineTo(x + width, y + height - NOTE_SIZE);\n    this.canvas.lineTo(x + width, y);\n    this.canvas.closePath();\n\n    this.canvas.moveTo(x + width - NOTE_SIZE, y + height);\n    this.canvas.lineTo(x + width, y + height - NOTE_SIZE);\n    this.canvas.lineTo(x + width - NOTE_SIZE, y + height - NOTE_SIZE);\n    this.canvas.closePath();\n  }\n\n  private drawBoxShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    const BOX_DEPTH = 20;\n    this.canvas.rect(x, y, width, height);\n\n    this.canvas.moveTo(x, y);\n    this.canvas.lineTo(x + width, y);\n    this.canvas.lineTo(x + width + BOX_DEPTH, y - BOX_DEPTH);\n    this.canvas.lineTo(x + BOX_DEPTH, y - BOX_DEPTH);\n    this.canvas.closePath();\n\n    this.canvas.moveTo(x + width, y);\n    this.canvas.lineTo(x + width, y + height);\n    this.canvas.lineTo(x + width + BOX_DEPTH, y + height - BOX_DEPTH);\n    this.canvas.lineTo(x + width + BOX_DEPTH, y - BOX_DEPTH);\n    this.canvas.closePath();\n  }\n\n  private drawFileShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    const FILE_SIZE = 30;\n    this.canvas.moveTo(x + FILE_SIZE, y);\n    this.canvas.lineTo(x, y + FILE_SIZE);\n    this.canvas.lineTo(x, y + height);\n    this.canvas.lineTo(x + width, y + height);\n    this.canvas.lineTo(x + width, y);\n    this.canvas.closePath();\n\n    this.canvas.moveTo(x + FILE_SIZE, y);\n    this.canvas.lineTo(x, y + FILE_SIZE);\n    this.canvas.lineTo(x + FILE_SIZE, y + FILE_SIZE);\n    this.canvas.closePath();\n  }\n\n  private drawComponentShape(rectangle: Rectangle) {\n    const { x, y, width, height } = rectangle;\n    const COMPONENT_WIDTH = 40;\n    const COMPONENT_HEIGHT = 20;\n    const COMPONENT_Y = (height - COMPONENT_HEIGHT * 3) / 2;\n\n    this.canvas.moveTo(x, y);\n    this.canvas.lineTo(x, y + COMPONENT_Y);\n    this.canvas.lineTo(x + COMPONENT_WIDTH / 2, y + COMPONENT_Y);\n    this.canvas.lineTo(x + COMPONENT_WIDTH / 2, y + COMPONENT_Y + COMPONENT_HEIGHT);\n    this.canvas.lineTo(x, y + COMPONENT_Y + COMPONENT_HEIGHT);\n    this.canvas.lineTo(x, y + COMPONENT_Y + COMPONENT_HEIGHT * 2);\n    this.canvas.lineTo(x + COMPONENT_WIDTH / 2, y + COMPONENT_Y + COMPONENT_HEIGHT * 2);\n    this.canvas.lineTo(x + COMPONENT_WIDTH / 2, y + COMPONENT_Y + COMPONENT_HEIGHT * 3);\n    this.canvas.lineTo(x, y + COMPONENT_Y + COMPONENT_HEIGHT * 3);\n    this.canvas.lineTo(x, y + height);\n    this.canvas.lineTo(x + width, y + height);\n    this.canvas.lineTo(x + width, y);\n    this.canvas.closePath();\n\n    this.canvas.rect(x + COMPONENT_WIDTH / -2, y + COMPONENT_Y, COMPONENT_WIDTH, COMPONENT_HEIGHT);\n    this.canvas.rect(\n      x + COMPONENT_WIDTH / -2,\n      y + COMPONENT_Y + 2 * COMPONENT_HEIGHT,\n      COMPONENT_WIDTH,\n      COMPONENT_HEIGHT,\n    );\n  }\n}\n\nexport default ShapeRenderer;\n","import { PADDING } from \"../constants\";\nimport { Color } from \"../css\";\nimport { Classifier, ClassifierRenderer, Renderer } from \"../model\";\nimport Canvas from \"./Canvas\";\nimport RenderContext from \"./RenderContext\";\nimport ShapeRenderer from \"./ShapeRenderer\";\n\nclass CanvasClassifierRenderer implements ClassifierRenderer {\n  private readonly renderer: Renderer;\n  private readonly context: RenderContext;\n  private readonly canvas: Canvas;\n  private readonly shapeRenderer: ShapeRenderer;\n\n  constructor(renderer: Renderer, context: RenderContext, canvas: Canvas) {\n    this.renderer = renderer;\n    this.context = context;\n    this.canvas = canvas;\n    this.shapeRenderer = new ShapeRenderer(canvas);\n  }\n\n  renderClassifier(classifier: Classifier): void {\n    this.context.push(\n      classifier.getTagName(),\n      classifier.getWidth() - 2 * PADDING,\n      classifier.getHeight() - 2 * PADDING,\n    );\n\n    this.canvas.save();\n    this.applyStyle(classifier);\n    this.drawShape(classifier);\n    this.canvas.fill();\n    this.canvas.stroke();\n    this.canvas.clip();\n\n    this.canvas.translate(classifier.getLeft() + PADDING, classifier.getTop() + PADDING);\n    for (const child of classifier.getChildren()) {\n      child.render(this.renderer);\n    }\n\n    this.canvas.restore();\n\n    this.context.pop();\n  }\n\n  isPointInClassifier(classifier: Classifier, x: number, y: number): boolean {\n    this.canvas.save();\n    this.drawShape(classifier);\n    const transform = this.canvas.getTransform();\n    const domPoint = transform.transformPoint({ x, y });\n    const result = this.canvas.isPointInPath(domPoint.x, domPoint.y);\n    this.canvas.restore();\n\n    return result;\n  }\n\n  private applyStyle(classifier: Classifier): void {\n    const properties = this.context.getStyleProperties();\n    this.canvas.lineWidth = properties.getFloat(\"line-width\", 1.5);\n    this.canvas.strokeColor = properties.getColor(\"stroke\", Color.DARK);\n    let fill = properties.getColor(\"fill\", Color.WHITE);\n    if (classifier.isHovered()) {\n      fill = fill.mix(Color.INFO, 0.25);\n    }\n    this.canvas.fillColor = fill;\n  }\n\n  private drawShape(classifier: Classifier): void {\n    this.canvas.beginPath();\n    this.shapeRenderer.renderShape(classifier.shape, classifier.getRectangle());\n  }\n}\n\nexport default CanvasClassifierRenderer;\n","import { Relationship, Renderer } from \"../model\";\n\nfunction bresenhamAlgorithm(\n  canvas: Renderer,\n  relationship: Relationship,\n): [number, number, number, number] {\n  const cl1 = relationship.from;\n  const cl2 = relationship.to;\n  const x1 = cl1.getAnchorX(relationship.fromAnchor);\n  const y1 = cl1.getAnchorY(relationship.fromAnchor);\n  const x2 = cl2.getAnchorX(relationship.toAnchor);\n  const y2 = cl2.getAnchorY(relationship.toAnchor);\n\n  // Calculate distances\n  const dx = Math.abs(x2 - x1);\n  const dy = Math.abs(y2 - y1);\n\n  // Calculate steps\n  const sx = x2 > x1 ? 1 : -1;\n  const sy = y2 > y1 ? 1 : -1;\n\n  let p1Hit = true;\n  let p2Hit = false;\n  let lx1: number | undefined;\n  let lx2: number | undefined;\n  let ly1: number | undefined;\n  let ly2: number | undefined;\n  let ox: number | undefined, oy: number | undefined;\n\n  for (let x = x1, y = y1, e = dx - dy; x !== x2 || y !== y2; ) {\n    if (p1Hit && !canvas.isPointInClassifier(cl1, x, y)) {\n      lx1 = x;\n      ly1 = y;\n      p1Hit = false;\n    }\n    if (!p2Hit && canvas.isPointInClassifier(cl2, x, y)) {\n      lx2 = ox || x;\n      ly2 = oy || y;\n      p2Hit = true;\n    }\n    if (!p1Hit && p2Hit) break;\n\n    // Update x and y\n    ox = x;\n    oy = y;\n    const e2 = 2 * e;\n    if (e2 > -dy) {\n      e -= dy;\n      x += sx;\n    }\n    if (e2 < dx) {\n      e += dx;\n      y += sy;\n    }\n  }\n\n  if (lx1 === undefined || ly1 === undefined || lx2 === undefined || ly2 === undefined) {\n    return [x1, y1, x2, y2];\n  }\n\n  return [lx1, ly1, lx2, ly2];\n}\n\nexport default bresenhamAlgorithm;\n","import { Color } from \"../css\";\nimport { LinePattern, Relationship, RelationshipRenderer, Renderer, Tip } from \"../model\";\nimport bresenhamAlgorithm from \"./bresenhamAlgorithm\";\nimport Canvas from \"./Canvas\";\n\nclass CanvasRelationshipRenderer implements RelationshipRenderer {\n  private readonly renderer: Renderer;\n  private readonly canvas: Canvas;\n\n  constructor(renderer: Renderer, canvas: Canvas) {\n    this.renderer = renderer;\n    this.canvas = canvas;\n  }\n\n  renderRelationship(relationship: Relationship): void {\n    const [x1, y1, x2, y2] = bresenhamAlgorithm(this.renderer, relationship);\n    const angle = Math.atan2(y2 - y1, x2 - x1);\n\n    this.canvas.save();\n    this.canvas.beginPath();\n    this.canvas.moveTo(x1, y1);\n    this.canvas.lineTo(x2, y2);\n    this.applyRelationshipStyle(relationship);\n    this.canvas.stroke();\n    this.drawFromTip(relationship, angle, x1, y1);\n    this.drawToTip(relationship, angle, x2, y2);\n    this.canvas.restore();\n  }\n\n  private applyRelationshipStyle(relationship: Relationship): void {\n    this.canvas.lineWidth = 1.5;\n    this.canvas.strokeColor = Color.DARK;\n    this.canvas.fillColor = Color.WHITE;\n    switch (relationship.linePattern) {\n      case LinePattern.SOLID:\n        this.canvas.setLineDash([]);\n        break;\n      case LinePattern.DOTS:\n        this.canvas.setLineDash([2, 2]);\n        break;\n      case LinePattern.SMALL_DASHES:\n        this.canvas.setLineDash([5, 5]);\n        break;\n      case LinePattern.LARGE_DASHES:\n        this.canvas.setLineDash([10, 10]);\n        break;\n      case LinePattern.TIGHT_DASHES:\n        this.canvas.setLineDash([15, 5]);\n        break;\n    }\n  }\n\n  private drawFromTip(relationship: Relationship, angle: number, x: number, y: number): void {\n    this.drawTip(relationship.fromTip, x, y, angle + Math.PI);\n  }\n\n  private drawToTip(relationship: Relationship, angle: number, x: number, y: number): void {\n    this.drawTip(relationship.toTip, x, y, angle);\n  }\n\n  private drawTip(tip: Tip, x: number, y: number, angle: number) {\n    if (tip !== Tip.NONE) {\n      this.canvas.setLineDash([]);\n      this.canvas.save();\n      this.canvas.translate(x, y);\n      this.canvas.rotate(angle);\n      this.drawTipPath(tip);\n      this.canvas.restore();\n    }\n  }\n\n  private drawTipPath(tip: Tip): void {\n    switch (tip) {\n      case Tip.ARROW:\n        this.drawArrow();\n        break;\n      case Tip.TRIANGLE:\n        this.drawTriangle();\n        break;\n      case Tip.FILLED_TRIANGLE:\n        this.canvas.fillColor = this.canvas.strokeColor;\n        this.drawTriangle();\n        break;\n      case Tip.DIAMOND:\n        this.drawDiamond();\n        break;\n      case Tip.FILLED_DIAMOND:\n        this.canvas.fillColor = this.canvas.strokeColor;\n        this.drawDiamond();\n        break;\n      case Tip.CIRCLE:\n        this.drawCircle();\n        break;\n      case Tip.FILLED_CIRCLE:\n        this.canvas.fillColor = this.canvas.strokeColor;\n        this.drawCircle();\n        break;\n    }\n  }\n\n  private drawArrow() {\n    this.canvas.beginPath();\n    this.canvas.moveTo(0, 0);\n    this.canvas.lineTo(-20, 8);\n    this.canvas.moveTo(0, 0);\n    this.canvas.lineTo(-20, -8);\n    this.canvas.closePath();\n    this.canvas.stroke();\n  }\n\n  private drawTriangle(): void {\n    this.canvas.beginPath();\n    this.canvas.moveTo(0, 0);\n    this.canvas.lineTo(-20, 10);\n    this.canvas.lineTo(-20, -10);\n    this.canvas.closePath();\n    this.canvas.fill();\n    this.canvas.stroke();\n  }\n\n  private drawDiamond(): void {\n    this.canvas.beginPath();\n    this.canvas.moveTo(0, 0);\n    this.canvas.lineTo(-15, 8);\n    this.canvas.lineTo(-30, 0);\n    this.canvas.lineTo(-15, -8);\n    this.canvas.closePath();\n    this.canvas.fill();\n    this.canvas.stroke();\n  }\n\n  private drawCircle(): void {\n    this.canvas.beginPath();\n    this.canvas.ellipse(-20, -10, 20, 20);\n    this.canvas.closePath();\n    this.canvas.fill();\n    this.canvas.stroke();\n  }\n}\n\nexport default CanvasRelationshipRenderer;\n","import { Anchor } from \"../model\";\n\nclass Handle {\n  readonly x: number;\n  readonly y: number;\n  readonly anchor: Anchor;\n\n  constructor(x: number, y: number, anchor: Anchor) {\n    this.x = x;\n    this.y = y;\n    this.anchor = anchor;\n  }\n}\n\nexport default Handle;\n","import { Color } from \"../css\";\nimport Canvas from \"./Canvas\";\n\nclass HTML5Canvas implements Canvas {\n  private readonly ctx: CanvasRenderingContext2D;\n\n  constructor(ctx: CanvasRenderingContext2D) {\n    this.ctx = ctx;\n  }\n\n  get fillColor(): Color {\n    return Color.fromHexString(String(this.ctx.fillStyle));\n  }\n\n  set fillColor(color: Color) {\n    this.ctx.fillStyle = color.toHexString();\n  }\n\n  get strokeColor(): Color {\n    return Color.fromHexString(String(this.ctx.strokeStyle));\n  }\n\n  set strokeColor(color: Color) {\n    this.ctx.strokeStyle = color.toHexString();\n  }\n\n  get lineWidth(): number {\n    return this.ctx.lineWidth;\n  }\n\n  set lineWidth(width: number) {\n    this.ctx.lineWidth = width;\n  }\n\n  get fontStyle(): string {\n    return this.getFontAttribute(0);\n  }\n\n  set fontStyle(fontStyle: string) {\n    this.updateFontAttribute(0, fontStyle);\n  }\n\n  get fontWeight(): string {\n    return this.getFontAttribute(1);\n  }\n\n  set fontWeight(fontWeight: string) {\n    this.updateFontAttribute(1, fontWeight);\n  }\n\n  get fontSize(): string {\n    return this.getFontAttribute(2);\n  }\n\n  set fontSize(fontSize: string) {\n    this.updateFontAttribute(2, fontSize);\n  }\n\n  get fontFamily(): string {\n    return this.getFontAttribute(3);\n  }\n\n  set fontFamily(fontFamily: string) {\n    this.updateFontAttribute(3, fontFamily);\n  }\n\n  setLineDash(dash: number[]): void {\n    this.ctx.setLineDash(dash);\n  }\n\n  save(): void {\n    this.ctx.save();\n  }\n\n  restore(): void {\n    this.ctx.restore();\n  }\n\n  translate(x: number, y: number): void {\n    this.ctx.translate(x, y);\n  }\n\n  rotate(angle: number): void {\n    this.ctx.rotate(angle);\n  }\n\n  beginPath(): void {\n    this.ctx.beginPath();\n  }\n\n  rect(x: number, y: number, width: number, height: number): void {\n    this.ctx.rect(x, y, width, height);\n  }\n\n  ellipse(x: number, y: number, width: number, height: number): void {\n    const radiusX = width / 2;\n    const radiusY = height / 2;\n    this.ctx.ellipse(x + radiusX, y + radiusY, radiusX, radiusY, 0, 0, Math.PI * 2);\n  }\n\n  moveTo(x: number, y: number): void {\n    this.ctx.moveTo(x, y);\n  }\n\n  lineTo(x: number, y: number): void {\n    this.ctx.lineTo(x, y);\n  }\n\n  isPointInPath(x: number, y: number): boolean {\n    return this.ctx.isPointInPath(x, y);\n  }\n\n  closePath(): void {\n    this.ctx.closePath();\n  }\n\n  getTransform(): DOMMatrix {\n    return this.ctx.getTransform();\n  }\n\n  fill(): void {\n    this.ctx.fill();\n  }\n\n  stroke(): void {\n    this.ctx.stroke();\n  }\n\n  clip(): void {\n    this.ctx.clip();\n  }\n\n  fillText(text: string, anchor: \"start\" | \"middle\" | \"end\", x: number, y: number): void {\n    const metrics = this.ctx.measureText(text);\n    const anchorY = y + metrics.fontBoundingBoxAscent;\n    let anchorX = x;\n    if (anchor === \"middle\") {\n      anchorX = anchorX + metrics.width / 2;\n    } else if (anchor === \"end\") {\n      anchorX = anchorX + metrics.width;\n    }\n    this.ctx.fillText(text, anchorX, anchorY);\n  }\n\n  private getFontAttribute(index: number): string {\n    return this.ctx.font.split(\" \", 4)[index];\n  }\n\n  private updateFontAttribute(index: number, value: string): void {\n    const attrs = this.ctx.font.split(\" \", 4);\n    attrs[index] = value;\n    this.ctx.font = attrs.join(\" \");\n  }\n}\n\nexport default HTML5Canvas;\n","import { PropertyMap, Style } from \"../css\";\n\nclass RenderContext {\n  private readonly width: number[];\n  private readonly height: number[];\n  private readonly context: string[];\n  private readonly style: Style;\n\n  constructor(canvasWidth: number, canvasHeight: number, style: Style) {\n    this.width = [canvasWidth];\n    this.height = [canvasHeight];\n    this.context = [];\n    this.style = style;\n  }\n\n  push(name: string, width?: number, height?: number): void {\n    this.context.unshift(name);\n    this.width.unshift(width ?? this.getWidth());\n    this.height.unshift(height ?? this.getHeight());\n  }\n\n  pop(): void {\n    this.context.shift();\n    this.width.shift();\n    this.height.shift();\n  }\n\n  getName(): string {\n    return this.context[0];\n  }\n\n  getWidth(): number {\n    return this.width[0];\n  }\n\n  getHeight(): number {\n    return this.height[0];\n  }\n\n  getStyleProperties(): PropertyMap {\n    return this.style.getProperties([...this.context].reverse());\n  }\n}\n\nexport default RenderContext;\n","import { GRID, HANDLE_RADIUS, PADDING } from \"../constants\";\nimport { Color, Style } from \"../css\";\nimport {\n  Anchor,\n  Classifier,\n  Diagram,\n  Relationship,\n  Renderer,\n  Separator,\n  Stereotype,\n  Text,\n  Title,\n} from \"../model\";\nimport CanvasClassifierRenderer from \"./CanvasClassifierRenderer\";\nimport CanvasOptions from \"./CanvasOptions\";\nimport CanvasRelationshipRenderer from \"./CanvasRelationshipRenderer\";\nimport Handle from \"./Handle\";\nimport HTML5Canvas from \"./HTML5Canvas\";\nimport RenderContext from \"./RenderContext\";\n\nclass CanvasRenderer implements Renderer {\n  private readonly context: RenderContext;\n  private readonly canvas: CanvasRenderingContext2D;\n  private readonly classifierRenderer: CanvasClassifierRenderer;\n  private readonly relationshipRenderer: CanvasRelationshipRenderer;\n  private readonly grid: boolean;\n  private readonly translateX: number;\n  private readonly translateY: number;\n  private readonly zoom: number;\n\n  constructor(canvas: HTMLCanvasElement, style: Style, options: CanvasOptions) {\n    this.context = new RenderContext(canvas.width, canvas.height, style);\n    this.grid = options.grid;\n    this.translateX = options.translateX;\n    this.translateY = options.translateY;\n    this.zoom = options.zoom;\n    this.canvas = canvas.getContext(\"2d\")!;\n    const html5Canvas = new HTML5Canvas(this.canvas);\n    this.classifierRenderer = new CanvasClassifierRenderer(this, this.context, html5Canvas);\n    this.relationshipRenderer = new CanvasRelationshipRenderer(this, html5Canvas);\n  }\n\n  transformPoint(x: number, y: number): { x: number; y: number } {\n    return {\n      x: (x - this.translateX) / this.zoom,\n      y: (y - this.translateY) / this.zoom,\n    };\n  }\n\n  clear(): void {\n    this.canvas.clearRect(0, 0, this.context.getWidth(), this.context.getHeight());\n    if (this.grid) {\n      this.renderGrid();\n    }\n  }\n\n  private renderGrid(): void {\n    const left = -this.translateX;\n    const right = this.context.getWidth() - this.translateX;\n    const top = -this.translateY;\n    const bottom = this.context.getHeight() - this.translateY;\n\n    const zoomedGrid = GRID * this.zoom;\n\n    const minX = this.floorBy(left, zoomedGrid);\n    const maxX = this.ceilBy(right, zoomedGrid);\n    const minY = this.floorBy(top, zoomedGrid);\n    const maxY = this.ceilBy(bottom, zoomedGrid);\n\n    this.canvas.save();\n    this.canvas.translate(this.translateX, this.translateY);\n    this.canvas.beginPath();\n    this.canvas.strokeStyle = \"#00000033\";\n    for (let x = minX; x < maxX; x += zoomedGrid) {\n      this.canvas.moveTo(x, top);\n      this.canvas.lineTo(x, bottom);\n    }\n    for (let y = minY; y < maxY; y += zoomedGrid) {\n      this.canvas.moveTo(left, y);\n      this.canvas.lineTo(right, y);\n    }\n    this.canvas.stroke();\n    this.canvas.restore();\n  }\n\n  private floorBy(number: number, by: number): number {\n    return Math.floor(number / by) * by;\n  }\n\n  private ceilBy(number: number, by: number): number {\n    return Math.ceil(number / by) * by;\n  }\n\n  renderDiagram(diagram: Diagram): void {\n    this.canvas.save();\n    this.canvas.translate(this.translateX, this.translateY);\n    this.canvas.scale(this.zoom, this.zoom);\n    for (const child of diagram.getChildren()) {\n      child.render(this);\n    }\n    this.renderHandles(diagram);\n    this.canvas.restore();\n  }\n\n  renderClassifier(classifier: Classifier): void {\n    this.classifierRenderer.renderClassifier(classifier);\n  }\n\n  isPointInClassifier(classifier: Classifier, x: number, y: number): boolean {\n    return this.classifierRenderer.isPointInClassifier(classifier, x, y);\n  }\n\n  renderRelationship(relationship: Relationship): void {\n    this.relationshipRenderer.renderRelationship(relationship);\n  }\n\n  renderText(text: Text) {\n    this.context.push(\"Text\");\n    this.drawText(text.text, \"14pt\", \"left\");\n    this.canvas.translate(0, 20);\n    this.context.pop();\n  }\n\n  renderTitle(title: Title): void {\n    this.context.push(\"Title\");\n    this.drawText(title.text, \"14pt\", \"center\");\n    this.canvas.translate(0, 20);\n    this.context.pop();\n  }\n\n  renderSeparator(separator: Separator): void {\n    this.canvas.save();\n    this.canvas.beginPath();\n    this.canvas.moveTo(-PADDING, PADDING);\n    this.canvas.lineTo(this.context.getWidth() + PADDING, PADDING);\n    this.canvas.lineWidth = 1.5;\n    this.canvas.strokeStyle = \"#212529\";\n    this.canvas.stroke();\n    this.canvas.restore();\n    this.canvas.translate(0, 2 * PADDING);\n  }\n\n  renderStereotype(stereotype: Stereotype): void {\n    const contextName = this.context.getName();\n    this.context.push(\"Stereotype\");\n    this.drawText(`${contextName}`, \"12pt\", \"center\");\n    this.canvas.translate(0, 20);\n    this.context.pop();\n  }\n\n  private drawText(text: string, size: string, align: \"left\" | \"center\") {\n    const properties = this.context.getStyleProperties();\n    const weight = properties.getString(\"font-weight\", \"normal\");\n    const style = properties.getString(\"font-style\", \"normal\");\n    const family = properties.getString(\"font-family\", \"Arial, Helvetica, system-ui, sans-serif\");\n\n    this.canvas.save();\n    this.canvas.beginPath();\n    this.canvas.font = `${style} ${weight} ${size} ${family}`;\n    this.canvas.fillStyle = properties.getColor(\"color\", Color.DARK).toHexString();\n    const metrics = this.canvas.measureText(text);\n    const x = align === \"center\" ? (this.context.getWidth() - metrics.width) / 2 : 0;\n    this.canvas.fillText(text, x, metrics.fontBoundingBoxAscent);\n    this.canvas.restore();\n  }\n\n  private renderHandles(diagram: Diagram): void {\n    this.canvas.save();\n    this.canvas.fillStyle = \"white\";\n    this.canvas.strokeStyle = \"black\";\n    this.canvas.lineWidth = 1;\n\n    for (const { x, y } of this.getHandles(diagram)) {\n      this.renderHandleAtPoint(x, y);\n    }\n\n    this.canvas.restore();\n  }\n\n  private *getHandles(diagram: Diagram): Generator<Handle> {\n    for (const child of diagram.getChildren()) {\n      if (child instanceof Classifier && child.isSelected()) {\n        yield* this.getClassifierHandles(child);\n      }\n    }\n  }\n\n  private renderHandleAtPoint(x: number, y: number): void {\n    this.canvas.beginPath();\n    this.canvas.rect(x - HANDLE_RADIUS, y - HANDLE_RADIUS, HANDLE_RADIUS * 2, HANDLE_RADIUS * 2);\n    this.canvas.fill();\n    this.canvas.stroke();\n  }\n\n  findHandleForPoint(diagram: Diagram, x: number, y: number): Handle | undefined {\n    for (const handle of this.getHandles(diagram)) {\n      if (this.isPointInHandle(handle, x, y)) {\n        return handle;\n      }\n    }\n    return undefined;\n  }\n\n  private isPointInHandle(handle: Handle, x: number, y: number): boolean {\n    return Math.abs(x - handle.x) <= HANDLE_RADIUS && Math.abs(y - handle.y) <= HANDLE_RADIUS;\n  }\n\n  private *getClassifierHandles(classifier: Classifier): Generator<Handle> {\n    const x1 = classifier.getLeft();\n    const x2 = classifier.getRight();\n    const y1 = classifier.getTop();\n    const y2 = classifier.getBottom();\n\n    yield new Handle(x1, y1, Anchor.NW);\n    yield new Handle(classifier.getCenterX(), y1, Anchor.N);\n    yield new Handle(x2, y1, Anchor.NE);\n    yield new Handle(x1, classifier.getCenterY(), Anchor.W);\n    yield new Handle(x2, classifier.getCenterY(), Anchor.E);\n    yield new Handle(x1, y2, Anchor.SW);\n    yield new Handle(classifier.getCenterX(), y2, Anchor.S);\n    yield new Handle(x2, y2, Anchor.SE);\n  }\n}\n\nexport default CanvasRenderer;\n","import { Color } from \"../css\";\nimport Canvas from \"./Canvas\";\n\nclass SVGCanvas implements Canvas {\n  fillColor = Color.WHITE;\n  strokeColor = Color.DARK;\n  lineWidth = 1;\n  fontFamily = \"system-ui\";\n  fontSize = \"1rem\";\n  fontStyle = \"normal\";\n  fontWeight = \"normal\";\n  private readonly document: Document;\n  private readonly stack: SVGElement[];\n  private readonly paths: SVGElement[] = [];\n  private readonly saved: SVGElement[] = [];\n  private readonly matrix: DOMMatrix[] = [new DOMMatrix()];\n  private path?: SVGPathElement;\n  private dash: number[] = [];\n\n  constructor(container: SVGElement) {\n    this.document = container.ownerDocument;\n    this.stack = [container];\n  }\n\n  setLineDash(dash: number[]): void {\n    this.dash = dash;\n  }\n\n  save(): void {\n    this.saved.push(this.getContainer());\n    this.matrix.push(new DOMMatrix(this.currentMatrix().toString()));\n  }\n\n  private currentMatrix(): DOMMatrix {\n    return this.matrix[this.matrix.length - 1];\n  }\n\n  restore(): void {\n    const saved = this.saved.pop()!;\n    this.stack.splice(this.stack.indexOf(saved) + 1);\n    this.matrix.pop();\n  }\n\n  translate(x: number, y: number): void {\n    const svg = this.createSVG(\"g\");\n    svg.setAttribute(\"transform\", `translate(${x},${y})`);\n    this.getContainer().append(svg);\n\n    this.stack.push(svg);\n    this.currentMatrix().translate(x, y);\n  }\n\n  rotate(angle: number): void {\n    const svg = this.createSVG(\"g\");\n    svg.setAttribute(\"transform\", `rotate(${this.radiansToDegrees(angle)})`);\n    this.getContainer().append(svg);\n\n    this.stack.push(svg);\n    this.currentMatrix().rotate(angle);\n  }\n\n  beginPath(): void {\n    this.paths.splice(0);\n  }\n\n  rect(x: number, y: number, width: number, height: number): void {\n    const rect = this.createSVG(\"rect\");\n    rect.setAttribute(\"x\", String(x));\n    rect.setAttribute(\"y\", String(y));\n    rect.setAttribute(\"width\", String(width));\n    rect.setAttribute(\"height\", String(height));\n    this.paths.push(rect);\n  }\n\n  ellipse(x: number, y: number, width: number, height: number): void {\n    const ellipse = this.createSVG(\"ellipse\");\n    const radiusX = width / 2;\n    const radiusY = height / 2;\n    ellipse.setAttribute(\"cx\", String(x + radiusX));\n    ellipse.setAttribute(\"cy\", String(y + radiusY));\n    ellipse.setAttribute(\"rx\", String(radiusX));\n    ellipse.setAttribute(\"ry\", String(radiusY));\n    this.paths.push(ellipse);\n  }\n\n  moveTo(x: number, y: number): void {\n    this.path = this.createSVG(\"path\");\n    this.path.setAttribute(\"d\", `M${x},${y}`);\n    this.paths.push(this.path);\n  }\n\n  lineTo(x: number, y: number): void {\n    const data = this.path!.getAttribute(\"d\");\n    this.path!.setAttribute(\"d\", `${data} L${x},${y}`);\n  }\n\n  closePath(): void {\n    const data = this.path!.getAttribute(\"d\");\n    this.path!.setAttribute(\"d\", `${data} Z`);\n  }\n\n  getTransform(): DOMMatrix {\n    return this.currentMatrix();\n  }\n\n  isPointInPath(x: number, y: number): boolean {\n    return false;\n  }\n\n  fill(): void {\n    this.appendPaths();\n    for (const path of this.paths) {\n      path.setAttribute(\"fill\", this.fillColor.toHexString());\n    }\n  }\n\n  stroke(): void {\n    this.appendPaths();\n    for (const path of this.paths) {\n      path.setAttribute(\"stroke\", this.strokeColor.toHexString());\n      path.setAttribute(\"stroke-width\", String(this.lineWidth));\n      path.setAttribute(\"stroke-dasharray\", this.dash.join(\" \"));\n    }\n  }\n\n  clip(): void {}\n\n  fillText(text: string, anchor: \"start\" | \"middle\" | \"end\", x: number, y: number): void {\n    const textEl = this.createSVG(\"text\");\n    textEl.setAttribute(\"x\", String(x));\n    textEl.setAttribute(\"y\", String(y + 10));\n    textEl.setAttribute(\"text-anchor\", anchor);\n    textEl.setAttribute(\"font-family\", this.fontFamily);\n    textEl.setAttribute(\"font-size\", this.fontSize);\n    textEl.setAttribute(\"font-style\", this.fontStyle);\n    textEl.setAttribute(\"font-weight\", this.fontWeight);\n    textEl.appendChild(this.document.createTextNode(this.encodeUTF8(text)));\n    this.paths.push(textEl);\n    this.fill();\n  }\n\n  private encodeUTF8(text: string): string {\n    const textEncoder = new TextEncoder();\n    const encoded = textEncoder.encode(text);\n    return String.fromCharCode(...encoded);\n  }\n\n  private appendPaths(): void {\n    this.getContainer().append(...this.paths);\n  }\n\n  private getContainer(): SVGElement {\n    return this.stack[this.stack.length - 1];\n  }\n\n  private createSVG<K extends keyof SVGElementTagNameMap>(element: K): SVGElementTagNameMap[K] {\n    return this.document.createElementNS(\"http://www.w3.org/2000/svg\", element);\n  }\n\n  private radiansToDegrees(angle: number): number {\n    return (180 * angle) / Math.PI;\n  }\n}\n\nexport default SVGCanvas;\n","import { PADDING } from \"../constants\";\nimport { Color, Style } from \"../css\";\nimport {\n  Classifier,\n  ClassifierRenderer,\n  Diagram,\n  Relationship,\n  RelationshipRenderer,\n  Renderer,\n  Separator,\n  Stereotype,\n  Text,\n  Title,\n} from \"../model\";\nimport CanvasClassifierRenderer from \"./CanvasClassifierRenderer\";\nimport CanvasRelationshipRenderer from \"./CanvasRelationshipRenderer\";\nimport RenderContext from \"./RenderContext\";\nimport SVGCanvas from \"./SVGCanvas\";\n\nclass SVGRenderer implements Renderer {\n  private readonly context: RenderContext;\n  private readonly canvas: SVGCanvas;\n  private readonly classifierRenderer: ClassifierRenderer;\n  private readonly relationshipRenderer: RelationshipRenderer;\n\n  constructor(svg: SVGSVGElement, style: Style) {\n    this.context = new RenderContext(svg.width.baseVal.value, svg.height.baseVal.value, style);\n    this.canvas = new SVGCanvas(svg);\n    this.classifierRenderer = new CanvasClassifierRenderer(this, this.context, this.canvas);\n    this.relationshipRenderer = new CanvasRelationshipRenderer(this, this.canvas);\n  }\n\n  renderDiagram(diagram: Diagram): void {\n    for (const child of diagram.getChildren()) {\n      child.render(this);\n    }\n  }\n\n  renderClassifier(classifier: Classifier): void {\n    this.classifierRenderer.renderClassifier(classifier);\n  }\n\n  isPointInClassifier(classifier: Classifier, x: number, y: number): boolean {\n    return this.classifierRenderer.isPointInClassifier(classifier, x, y);\n  }\n\n  renderRelationship(relationship: Relationship): void {\n    this.relationshipRenderer.renderRelationship(relationship);\n  }\n\n  renderText(text: Text) {\n    this.context.push(\"Text\");\n    this.drawText(text.text, \"14pt\", \"start\");\n    this.canvas.translate(0, 20);\n    this.context.pop();\n  }\n\n  renderTitle(title: Title): void {\n    this.context.push(\"Title\");\n    this.drawText(title.text, \"14pt\", \"middle\");\n    this.canvas.translate(0, 20);\n    this.context.pop();\n  }\n\n  renderStereotype(stereotype: Stereotype): void {\n    const contextName = this.context.getName();\n    this.context.push(\"Stereotype\");\n    this.drawText(`${contextName}`, \"12pt\", \"middle\");\n    this.canvas.translate(0, 20);\n    this.context.pop();\n  }\n\n  renderSeparator(separator: Separator): void {\n    this.canvas.beginPath();\n    this.canvas.moveTo(-PADDING, PADDING);\n    this.canvas.lineTo(this.context.getWidth() + PADDING, PADDING);\n    this.canvas.lineWidth = 1.5;\n    this.canvas.strokeColor = Color.DARK;\n    this.canvas.stroke();\n    this.canvas.translate(0, 2 * PADDING);\n  }\n\n  private drawText(text: string, size: string, align: \"start\" | \"middle\") {\n    const properties = this.context.getStyleProperties();\n    this.canvas.fontWeight = properties.getString(\"font-weight\", \"normal\");\n    this.canvas.fontStyle = properties.getString(\"font-style\", \"normal\");\n    this.canvas.fontSize = properties.getString(\"font-size\", size);\n    this.canvas.fontFamily = properties.getString(\n      \"font-family\",\n      \"Arial, Helvetica, system-ui, sans-serif\",\n    );\n    this.canvas.save();\n    this.canvas.beginPath();\n    this.canvas.fillColor = properties.getColor(\"color\", Color.DARK);\n    const x = align === \"middle\" ? this.context.getWidth() / 2 : 0;\n    this.canvas.fillText(text, align, x, 4);\n    this.canvas.restore();\n  }\n}\n\nexport default SVGRenderer;\n","import { FormattedMessage } from \"react-intl\";\nimport { MARGIN } from \"../../constants\";\nimport { CanvasRenderer } from \"../../renderer\";\nimport { downloadFile, File, sanitizeFilename } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  file: File;\n}\n\nfunction PNGExport({ file }: Props) {\n  function handleClick() {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = file.model.getWidth() + 2 * MARGIN;\n    canvas.height = file.model.getHeight() + 2 * MARGIN;\n\n    const renderer = new CanvasRenderer(canvas, file.style, {\n      grid: false,\n      translateX: MARGIN - file.model.getLeft(),\n      translateY: MARGIN - file.model.getTop(),\n      zoom: 1,\n    });\n    renderer.renderDiagram(file.model);\n\n    const dataURL = canvas.toDataURL(\"image/png\");\n    downloadFile(`${sanitizeFilename(file.title)}.png`, dataURL);\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-E\">\n      <Icon name=\"image\" /> <FormattedMessage id=\"export.png\" defaultMessage=\"As PNG ...\" />\n    </DropdownItem>\n  );\n}\n\nexport default PNGExport;\n","import { FormattedMessage } from \"react-intl\";\nimport { MARGIN } from \"../../constants\";\nimport { SVGRenderer } from \"../../renderer\";\nimport { downloadFile, File, sanitizeFilename } from \"../../utils\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  file: File;\n}\n\nfunction SVGExport({ file }: Props) {\n  function handleClick() {\n    const viewBox = [\n      file.model.getLeft() - MARGIN,\n      file.model.getTop() - MARGIN,\n      file.model.getWidth() + 2 * MARGIN,\n      file.model.getHeight() + 2 * MARGIN,\n    ].join(\" \");\n    const root = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    root.setAttribute(\"width\", String(file.model.getWidth() + 2 * MARGIN));\n    root.setAttribute(\"height\", String(file.model.getHeight() + 2 * MARGIN));\n    root.setAttribute(\"viewBox\", viewBox);\n\n    const renderer = new SVGRenderer(root, file.style);\n    renderer.renderDiagram(file.model);\n\n    const xmlSerializer = new XMLSerializer();\n    const svg = xmlSerializer.serializeToString(root);\n    const dataURL = new URL(`data:image/svg+xml;base64,${btoa(svg)}`).toString();\n    downloadFile(`${sanitizeFilename(file.title)}.svg`, dataURL);\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-Shift-E\">\n      <Icon name=\"code-slash\" /> <FormattedMessage id=\"export.svg\" defaultMessage=\"As SVG ...\" />\n    </DropdownItem>\n  );\n}\n\nexport default SVGExport;\n","import { Dispatch } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  grid: boolean;\n  onChange: Dispatch<boolean>;\n}\n\nfunction ToggleGrid({ grid, onChange }: Props) {\n  const icon = grid ? \"grid-3x3-gap-fill\" : \"grid-3x3-gap\";\n\n  function handleClick() {\n    onChange(!grid);\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Alt-G\">\n      <Icon name={icon} /> <FormattedMessage id=\"view.grid\" defaultMessage=\"Toggle Grid\" />\n    </DropdownItem>\n  );\n}\n\nexport default ToggleGrid;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onZoom: DispatchWithoutAction;\n}\n\nfunction ZoomIn({ onZoom }: Props) {\n  function handleClick() {\n    onZoom();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-Plus\">\n      <Icon name=\"zoom-in\" /> <FormattedMessage id=\"view.zoomIn\" defaultMessage=\"Zoom In\" />\n    </DropdownItem>\n  );\n}\n\nexport default ZoomIn;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onZoom: DispatchWithoutAction;\n}\n\nfunction ZoomOut({ onZoom }: Props) {\n  function handleClick() {\n    onZoom();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-Minus\">\n      <Icon name=\"zoom-out\" /> <FormattedMessage id=\"view.zoomOut\" defaultMessage=\"Zoom Out\" />\n    </DropdownItem>\n  );\n}\n\nexport default ZoomOut;\n","import { DispatchWithoutAction } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { DropdownItem, Icon } from \"../blocks\";\n\ninterface Props {\n  onZoom: DispatchWithoutAction;\n}\n\nfunction ZoomReset({ onZoom }: Props) {\n  function handleClick() {\n    onZoom();\n  }\n\n  return (\n    <DropdownItem onClick={handleClick} shortcut=\"Ctrl-0\">\n      <Icon name=\"search\" /> <FormattedMessage id=\"view.zoomReset\" defaultMessage=\"Zoom Reset\" />\n    </DropdownItem>\n  );\n}\n\nexport default ZoomReset;\n","import { FormattedMessage, useIntl } from \"react-intl\";\nimport { Element } from \"../../model\";\nimport { useStore } from \"../../modules\";\nimport { Locale, SerializableFile } from \"../../utils\";\nimport { DropdownDivider, ExternalLink, Icon, Menu, MenuBar, NavItem } from \"../blocks\";\nimport DeleteElement from \"./DeleteElement\";\nimport DuplicateElement from \"./DuplicateElement\";\nimport FileNew from \"./FileNew\";\nimport FileOpen from \"./FileOpen\";\nimport FileRename from \"./FileRename\";\nimport FileSave from \"./FileSave\";\nimport LocaleItem from \"./LocaleItem\";\nimport MoveDown from \"./MoveDown\";\nimport MoveLeft from \"./MoveLeft\";\nimport MoveRight from \"./MoveRight\";\nimport MoveUp from \"./MoveUp\";\nimport PNGExport from \"./PNGExport\";\nimport SVGExport from \"./SVGExport\";\nimport ToggleGrid from \"./ToggleGrid\";\nimport ZoomIn from \"./ZoomIn\";\nimport ZoomOut from \"./ZoomOut\";\nimport ZoomReset from \"./ZoomReset\";\n\nfunction AppMenu() {\n  const file = useStore(\"title\", \"xml\", \"css\", \"model\", \"style\");\n  const { grid, dispatch } = useStore(\"grid\");\n  const intl = useIntl();\n\n  function handleFileChange(file: SerializableFile) {\n    dispatch(\"file/load\", file);\n  }\n\n  function handleAddElement(element: Element) {\n    dispatch(\"file/add\", element);\n  }\n\n  function handleDeleteElement(element: Element) {\n    dispatch(\"file/delete\", element);\n  }\n\n  function handleGridChange(grid: boolean) {\n    dispatch(\"view/grid\", grid);\n  }\n\n  function handleLocaleChange(locale: Locale) {\n    dispatch(\"locale/change\", locale);\n  }\n\n  return (\n    <MenuBar>\n      <Menu title={intl.formatMessage({ id: \"file\", defaultMessage: \"File\" })}>\n        <FileNew onFileChange={handleFileChange} />\n        <DropdownDivider />\n        <FileOpen onFileChange={handleFileChange} />\n        <FileSave file={file} />\n        <DropdownDivider />\n        <FileRename file={file} onTitleChange={(title) => handleFileChange({ ...file, title })} />\n      </Menu>\n\n      <Menu title={intl.formatMessage({ id: \"edit\", defaultMessage: \"Edit\" })}>\n        <DuplicateElement file={file} onAddElement={handleAddElement} />\n        <DeleteElement file={file} onDeleteElement={handleDeleteElement} />\n      </Menu>\n\n      <Menu title={intl.formatMessage({ id: \"view\", defaultMessage: \"View\" })}>\n        <MoveLeft onMove={() => dispatch(\"view/moveLeft\")} />\n        <MoveRight onMove={() => dispatch(\"view/moveRight\")} />\n        <MoveUp onMove={() => dispatch(\"view/moveUp\")} />\n        <MoveDown onMove={() => dispatch(\"view/moveDown\")} />\n        <DropdownDivider />\n        <ZoomReset onZoom={() => dispatch(\"view/zoomReset\")} />\n        <ZoomIn onZoom={() => dispatch(\"view/zoomIn\")} />\n        <ZoomOut onZoom={() => dispatch(\"view/zoomOut\")} />\n        <DropdownDivider />\n        <ToggleGrid grid={grid} onChange={handleGridChange} />\n      </Menu>\n\n      <Menu title={intl.formatMessage({ id: \"export\", defaultMessage: \"Export\" })}>\n        <PNGExport file={file} />\n        <SVGExport file={file} />\n      </Menu>\n\n      <div className=\"flex-grow-1\" />\n\n      <NavItem>\n        <ExternalLink className=\"nav-link\" href=\"https://github.com/ksm2/uml-editor\">\n          <Icon name=\"github\" />\n          <FormattedMessage id=\"github\" defaultMessage=\"GitHub\" />\n        </ExternalLink>\n      </NavItem>\n      <Menu\n        placement=\"end\"\n        title={\n          <>\n            <Icon name=\"globe\" />\n            <FormattedMessage id=\"lang\" defaultMessage=\"Language\" />\n          </>\n        }\n      >\n        <LocaleItem locale={Locale.GERMAN} name=\"Deutsch\" onChange={handleLocaleChange} />\n        <LocaleItem\n          locale={Locale.ENGLISH}\n          name=\"English\"\n          onChange={handleLocaleChange}\n          country=\"uk\"\n        />\n      </Menu>\n    </MenuBar>\n  );\n}\n\nexport default AppMenu;\n","import { MouseEvent, MutableRefObject, useEffect, useRef } from \"react\";\nimport { GRID } from \"../../constants\";\nimport { Style } from \"../../css\";\nimport { Anchor, Classifier, Element, Rectangle } from \"../../model\";\nimport { useStore } from \"../../modules\";\nimport { ViewState } from \"../../modules/view\";\nimport { CanvasRenderer, Handle } from \"../../renderer\";\nimport { Coordinates, getMouseCoordinates, roundCoordsBy, subtractCoords } from \"../../utils\";\n\nfunction createRenderer(canvas: HTMLCanvasElement, style: Style, view: ViewState): CanvasRenderer {\n  return new CanvasRenderer(canvas, style, {\n    grid: view.grid,\n    translateX: view.positionX + canvas.width / 2,\n    translateY: view.positionY + canvas.height / 2,\n    zoom: view.zoom,\n  });\n}\n\nfunction Canvas() {\n  const view = useStore(\"grid\", \"positionX\", \"positionY\", \"zoom\");\n  const { model, style, dispatch } = useStore(\"model\", \"style\");\n  const div = useRef<HTMLDivElement>(null);\n  const canvas = useRef<HTMLCanvasElement>(null);\n  const mouseDownCoords = useRef<Coordinates>(null) as MutableRefObject<Coordinates | null>;\n  const mouseDownRectangle = useRef<Rectangle>(null) as MutableRefObject<Rectangle | null>;\n  const mouseDownObject = useRef<Handle | Element>(null) as MutableRefObject<\n    Handle | Element | null\n  >;\n\n  useEffect(() => {\n    function onResize() {\n      if (div.current === null) {\n        return;\n      }\n\n      const rect = div.current.getBoundingClientRect();\n      canvas.current!.width = Math.trunc(rect.width);\n      canvas.current!.height = Math.trunc(rect.height);\n\n      const renderer = createRenderer(canvas.current!, style, view);\n      renderer.clear();\n      renderer.renderDiagram(model);\n    }\n\n    window.addEventListener(\"resize\", onResize);\n    onResize();\n    return () => {\n      window.removeEventListener(\"resize\", onResize);\n    };\n  });\n\n  function setCursor(cursor: string): void {\n    canvas.current!.style.cursor = cursor;\n  }\n\n  function handleHandleUpdate(target: Classifier, handle: Handle, deltaX: number, deltaY: number) {\n    if (handle.anchor === Anchor.W || handle.anchor === Anchor.NW || handle.anchor === Anchor.SW) {\n      target.setWidth(mouseDownRectangle.current!.width - deltaX);\n      target.setLeft(mouseDownRectangle.current!.x + deltaX);\n      dispatch(\"file/model\", target);\n    }\n    if (handle.anchor === Anchor.E || handle.anchor === Anchor.NE || handle.anchor === Anchor.SE) {\n      target.setWidth(mouseDownRectangle.current!.width + deltaX);\n      target.setLeft(mouseDownRectangle.current!.x);\n      dispatch(\"file/model\", target);\n    }\n    if (handle.anchor === Anchor.N || handle.anchor === Anchor.NW || handle.anchor === Anchor.NE) {\n      target.setHeight(mouseDownRectangle.current!.height - deltaY);\n      target.setTop(mouseDownRectangle.current!.y + deltaY);\n      dispatch(\"file/model\", target);\n    }\n    if (handle.anchor === Anchor.S || handle.anchor === Anchor.SW || handle.anchor === Anchor.SE) {\n      target.setHeight(mouseDownRectangle.current!.height + deltaY);\n      target.setTop(mouseDownRectangle.current!.y);\n      dispatch(\"file/model\", target);\n    }\n  }\n\n  function handleLeftMouseButtonMove(x: number, y: number) {\n    const target = model.find((el) => el.isSelected());\n    if (target instanceof Classifier) {\n      const { x: deltaX, y: deltaY } = roundCoordsBy(\n        subtractCoords({ x, y }, mouseDownCoords.current!),\n        GRID,\n      );\n      if (mouseDownObject.current === target) {\n        target.setLeft(mouseDownRectangle.current!.x + deltaX);\n        target.setTop(mouseDownRectangle.current!.y + deltaY);\n        dispatch(\"file/model\", target);\n        return;\n      }\n      if (mouseDownObject.current instanceof Handle) {\n        handleHandleUpdate(target, mouseDownObject.current, deltaX, deltaY);\n      }\n    }\n  }\n\n  function handleMouseMove(event: MouseEvent<HTMLCanvasElement>) {\n    const renderer = createRenderer(canvas.current!, style, view);\n    const { x, y } = getMouseCoordinates(renderer, event);\n\n    if (event.buttons & 1) {\n      handleLeftMouseButtonMove(x, y);\n      renderer.clear();\n      renderer.renderDiagram(model);\n      return;\n    }\n\n    for (const element of model) {\n      element.setHovered(false);\n    }\n\n    const handle = renderer.findHandleForPoint(model, x, y);\n    if (handle !== undefined) {\n      setCursor(`${Anchor[handle.anchor].toLowerCase()}-resize`);\n    } else {\n      setCursor(\"default\");\n\n      for (const classifier of model) {\n        if (classifier instanceof Classifier) {\n          const isInClassifier = renderer.isPointInClassifier(classifier, x, y);\n          if (isInClassifier) {\n            classifier.setHovered(true);\n            break;\n          }\n        }\n      }\n    }\n\n    renderer.clear();\n    renderer.renderDiagram(model);\n  }\n\n  function renderMouseDown(renderer: CanvasRenderer, x: number, y: number) {\n    const selectedElement = model.find((el) => el.isSelected());\n    const handle = renderer.findHandleForPoint(model, x, y);\n    if (handle !== undefined && selectedElement instanceof Classifier) {\n      mouseDownRectangle.current = selectedElement.getRectangle();\n      mouseDownCoords.current = { x, y };\n      mouseDownObject.current = handle;\n      return;\n    }\n\n    selectedElement?.setSelected(false);\n    for (const classifier of model) {\n      if (classifier instanceof Classifier) {\n        const isInClassifier = renderer.isPointInClassifier(classifier, x, y);\n        if (isInClassifier) {\n          classifier.setSelected(true);\n          mouseDownRectangle.current = classifier.getRectangle();\n          mouseDownCoords.current = { x, y };\n          mouseDownObject.current = classifier;\n          return;\n        }\n      }\n    }\n  }\n\n  function handleMouseDown(event: MouseEvent<HTMLCanvasElement>) {\n    const renderer = createRenderer(canvas.current!, style, view);\n    const { x, y } = getMouseCoordinates(renderer, event);\n\n    renderMouseDown(renderer, x, y);\n    renderer.clear();\n    renderer.renderDiagram(model);\n  }\n\n  function handleMouseUp() {\n    mouseDownRectangle.current = null;\n    mouseDownCoords.current = null;\n    mouseDownObject.current = null;\n  }\n\n  return (\n    <div\n      ref={div}\n      className=\"Canvas\"\n      style={{ backgroundColor: \"hsl(220 9% 92% / 1)\", gridArea: \"canvas\" }}\n    >\n      <canvas\n        ref={canvas}\n        onMouseMove={handleMouseMove}\n        onMouseDown={handleMouseDown}\n        onMouseUp={handleMouseUp}\n      />\n    </div>\n  );\n}\n\nexport default Canvas;\n","import { useStore } from \"../../modules\";\nimport { Editor } from \"../blocks\";\n\nfunction CSSEditor() {\n  const { css, dispatch } = useStore(\"css\");\n\n  return (\n    <div className=\"CSSEditor\" style={{ gridArea: \"css\", position: \"relative\" }}>\n      <Editor language=\"css\" value={css} onChange={(css) => dispatch(\"file/css\", css)} />\n    </div>\n  );\n}\n\nexport default CSSEditor;\n","import { MessageFormatElement } from \"intl-messageformat-parser\";\nimport React, { ReactNode } from \"react\";\nimport { IntlProvider } from \"react-intl\";\nimport DE_MESSAGES from \"../../i18n/de.json\";\nimport EN_MESSAGES from \"../../i18n/en.json\";\nimport { useStore } from \"../../modules\";\nimport { Locale } from \"../../utils\";\n\ninterface Props {\n  children?: ReactNode;\n}\n\nfunction messagesForLocale(locale: Locale): Record<string, MessageFormatElement[]> {\n  switch (locale) {\n    case Locale.GERMAN:\n      return DE_MESSAGES;\n    default:\n      return EN_MESSAGES;\n  }\n}\n\nfunction LocaleSwitch({ children }: Props) {\n  const { locale } = useStore(\"locale\");\n  return (\n    <IntlProvider\n      messages={messagesForLocale(locale)}\n      locale={locale}\n      defaultLocale={Locale.ENGLISH}\n    >\n      {children}\n    </IntlProvider>\n  );\n}\n\nexport default LocaleSwitch;\n","import { Anchor, LinePattern, Shape, Tip } from \"../../model\";\n\nconst anchorSchema = Object.keys(Anchor)\n  .filter((it) => it.match(/^\\D+$/))\n  .map((it) => it.toLowerCase());\n\nconst shapeSchema = Object.keys(Shape)\n  .filter((it) => it.match(/^\\D+$/))\n  .map((it) => it.toLowerCase());\n\nconst tipSchema = Object.keys(Tip)\n  .filter((it) => it.match(/^\\D+$/))\n  .map((it) => it.toLowerCase());\n\nconst linePatternSchema = Object.keys(LinePattern)\n  .filter((it) => it.match(/^\\D+$/))\n  .map((it) => it.toLowerCase());\n\nconst classifierSchema = {\n  children: [\"Title\", \"Separator\", \"Method\", \"Stereotype\"],\n  attrs: {\n    x: null,\n    y: null,\n    width: null,\n    height: null,\n    anchor: anchorSchema,\n    shape: shapeSchema,\n  },\n};\n\nconst relationshipSchema = {\n  attrs: {\n    from: null,\n    fromTip: tipSchema,\n    to: null,\n    toTip: tipSchema,\n    linePattern: linePatternSchema,\n  },\n};\n\nconst classifiers = {\n  Class: classifierSchema,\n  Classifier: classifierSchema,\n  Component: classifierSchema,\n  DataType: classifierSchema,\n  Enumeration: classifierSchema,\n  Interface: classifierSchema,\n  Note: classifierSchema,\n  Object: classifierSchema,\n  Package: classifierSchema,\n  Primitive: classifierSchema,\n};\n\nconst relationships = {\n  Aggregation: relationshipSchema,\n  Anchor: relationshipSchema,\n  Association: relationshipSchema,\n  Composition: relationshipSchema,\n  Dependency: relationshipSchema,\n  DirectedAssociation: relationshipSchema,\n  Generalization: relationshipSchema,\n  Implementation: relationshipSchema,\n  Relationship: relationshipSchema,\n};\n\nconst schema = {\n  \"!top\": [\"Diagram\"],\n  \"!attrs\": {\n    id: null,\n    class: null,\n  },\n  Diagram: {\n    children: [...Object.keys(classifiers), ...Object.keys(relationships)],\n  },\n  ...classifiers,\n  ...relationships,\n};\n\nexport default schema;\n","import { useStore } from \"../../modules\";\nimport { Editor } from \"../blocks\";\nimport { xmlSchema } from \"../schemas\";\n\nfunction XMLEditor() {\n  const { xml, dispatch } = useStore(\"xml\");\n\n  return (\n    <div className=\"XMLEditor\" style={{ gridArea: \"xml\", position: \"relative\" }}>\n      <Editor\n        language=\"xml\"\n        value={xml}\n        schema={xmlSchema}\n        onChange={(xml) => dispatch(\"file/xml\", xml)}\n      />\n    </div>\n  );\n}\n\nexport default XMLEditor;\n","import React, { useEffect } from \"react\";\nimport { useIntl } from \"react-intl\";\nimport { INITIAL_CSS, INITIAL_XML } from \"../constants\";\nimport { decode, encode } from \"../encoding\";\nimport { useDocumentTitle } from \"../hooks\";\nimport { useStore } from \"../modules\";\nimport \"./App.css\";\nimport { AppMenu, Canvas, CSSEditor, XMLEditor } from \"./widgets\";\n\nfunction App() {\n  const { title, css, xml, dispatch } = useStore(\"title\", \"xml\", \"css\");\n  const intl = useIntl();\n  const untitledMsg = intl.formatMessage({ id: \"untitled\", defaultMessage: \"Untitled\" });\n  const titleMsg = intl.formatMessage({ id: \"title\", defaultMessage: \"UML Editor\" });\n\n  useDocumentTitle(`${title} - ${titleMsg}`);\n\n  useEffect(() => {\n    if (window.location.hash.startsWith(\"#/?doc=\")) {\n      const hash = window.location.hash.slice(\"#/?doc=\".length);\n      const file = decode(hash);\n      if (file.xml && file.css) {\n        dispatch(\"file/load\", file);\n        return;\n      }\n    }\n\n    dispatch(\"file/load\", { xml: INITIAL_XML, css: INITIAL_CSS, title: untitledMsg });\n  }, [untitledMsg, dispatch]);\n\n  useEffect(() => {\n    const hash = encode({ title, xml, css });\n    window.location.hash = `/?doc=${hash}`;\n  }, [title, xml, css]);\n\n  return (\n    <div className=\"App bg-secondary\">\n      <AppMenu />\n      <XMLEditor />\n      <CSSEditor />\n      <Canvas />\n    </div>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from \"web-vitals\";\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import \"bootstrap/dist/css/bootstrap.min.css\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\nimport { LocaleSwitch } from \"./components/widgets\";\nimport \"./index.css\";\nimport { Store } from \"./modules\";\nimport reportWebVitals from \"./reportWebVitals\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Store>\n      <LocaleSwitch>\n        <App />\n      </LocaleSwitch>\n    </Store>\n  </React.StrictMode>,\n  document.getElementById(\"root\"),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}